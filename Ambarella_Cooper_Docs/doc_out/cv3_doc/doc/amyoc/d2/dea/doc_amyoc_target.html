<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Build System: Target Build Guidance</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Build System"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-ambarella.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Ambarella.png"/></td>
  <td id="projectalign">
   <div id="projectname">Build System<span id="projectnumber">&#160;Cooper_1.6.0 (CV72 &amp; CV3) @ 2024.07.10 14:12:44</span>
   </div>
   <div id="projectbrief">placeholder</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.html','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d2/dea/doc_amyoc_target.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Target Build Guidance </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="doc_amyoc_guide_build_normal_image"></a>
1 Firmware Image</h1>
<h2><a class="anchor" id="doc_guide_build_image_cv2x"></a>
1.1 CV2x Image Build</h2>
<p >The following steps are using CV22 Walnut EVK as an example, users can replace cv22_walnut with other CV2x boardname, such as cv25m_pinenut, cv2_chestnut.</p>
<dl class="section user"><dt>Build the cross-toolchain (optional)</dt><dd></dd></dl>
<div class="fragment"><div class="line">ambarella$ sudo apt install texinfo gawk</div>
<div class="line">ambarella$ <a class="code hl_variableRef" target="_blank" href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> build/env/amba-build.env cv22_walnut</div>
<div class="line">ambarella$ make -C build/toolchain</div>
<div class="line">ambarella$ export ENV_BUILD_TOOL=`pwd`/out/toolchain/cortex-a53-toolchain-gcc12.2.0-linux5.15/bin/aarch64-linux-gnu-</div>
<div class="ttc" id="avin__init_8c_html_a07a87b2e6ed927503e2f95f119c9fc23"><div class="ttname"><a href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a></div><div class="ttdeci">int source</div></div>
</div><!-- fragment --><dl class="section user"><dt>Amba build at the top folder (using CV22 Walnut EVK as an example)</dt><dd></dd></dl>
<div class="fragment"><div class="line">ambarella$ <a class="code hl_variableRef" target="_blank" href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> build/env/amba-build.env cv22_walnut</div>
<div class="line">ambarella$ make ipcam_config</div>
<div class="line">ambarella$ make</div>
</div><!-- fragment --><dl class="section user"><dt>Amba build at the board folder (ambarella/boards/cv22_walnut)</dt><dd></dd></dl>
<div class="fragment"><div class="line">ambarella/boards/cv22_walnut$ make ipcam_config</div>
<div class="line">ambarella/boards/cv22_walnut$ make</div>
</div><!-- fragment --><dl class="section user"><dt>Yocto build (using CV22 Walnut EVK as an example)</dt><dd></dd></dl>
<div class="fragment"><div class="line">ambarella$ <a class="code hl_variableRef" target="_blank" href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> build/env/yocto-build.env cv22_walnut</div>
<div class="line">ambarella/out/yocto_out/cv22_walnut$ make ipcam_config</div>
<div class="line">ambarella/out/yocto_out/cv22_walnut$ make</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd><ul>
<li>Environment configuration files for both Amba and Yocto build can be loaded in any SDK subdirectory: source <code>xxx/build/env/xxxx-build.env</code>.</li>
<li>Users can load environment configuration files, then select the board by index</li>
<li>The <code>ipcam_config</code> will be loaded by default if the configuration file is not specified and <code>.config</code> file does not exist in the compiling stage.</li>
</ul>
</dd></dl>
<h2><a class="anchor" id="doc_guide_build_image_cv5x"></a>
1.2 CV5x Image Build</h2>
<p >The following steps are using CV5 Timn EVK as an example, users can replace cv5_timn with other CV5x boardname, such as cv52_crco.</p>
<dl class="section user"><dt>Build the cross-toolchain (optional)</dt><dd></dd></dl>
<div class="fragment"><div class="line">ambarella$ sudo apt install texinfo gawk</div>
<div class="line">ambarella$ <a class="code hl_variableRef" target="_blank" href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> build/env/amba-build.env cv5_timn</div>
<div class="line">ambarella$ make -C build/toolchain</div>
<div class="line">ambarella$ export ENV_BUILD_TOOL=`pwd`/out/toolchain/cortex-a53-toolchain-gcc12.2.0-linux5.15/bin/aarch64-linux-gnu-</div>
</div><!-- fragment --><dl class="section user"><dt>Amba build at the top folder (using CV5 Timn EVK as an example)</dt><dd></dd></dl>
<div class="fragment"><div class="line">ambarella$ <a class="code hl_variableRef" target="_blank" href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> build/env/amba-build.env cv5_timn</div>
<div class="line">ambarella$ make ipcam_config</div>
<div class="line">ambarella$ make</div>
</div><!-- fragment --><dl class="section user"><dt>Amba build at the board folder (ambarella/boards/cv5_timn)</dt><dd></dd></dl>
<div class="fragment"><div class="line">ambarella/boards/cv5_timn$ make ipcam_config</div>
<div class="line">ambarella/boards/cv5_timn$ make</div>
</div><!-- fragment --><dl class="section user"><dt>Yocto build (using CV5 Timn EVK as an example)</dt><dd></dd></dl>
<div class="fragment"><div class="line">ambarella$ <a class="code hl_variableRef" target="_blank" href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> build/env/yocto-build.env cv5_timn</div>
<div class="line">ambarella/out/yocto_out/cv5_timn$ make ipcam_config</div>
<div class="line">ambarella/out/yocto_out/cv5_timn$ make</div>
</div><!-- fragment --><h2><a class="anchor" id="doc_guide_build_image_cv3"></a>
1.3 CV3 Image Build</h2>
<p >The following steps are using CV3 Dk_mini EVK as an example, users can replace cv3_dk_mini with other CV3 boardname, such as cv3ad685bub, cv2hpcie.</p>
<dl class="section user"><dt>Build the cross-toolchain (optional)</dt><dd></dd></dl>
<div class="fragment"><div class="line">ambarella$ sudo apt install texinfo gawk</div>
<div class="line">ambarella$ <a class="code hl_variableRef" target="_blank" href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> build/env/amba-build.env cv3_dk_mini</div>
<div class="line">ambarella$ make -C build/toolchain</div>
<div class="line">ambarella$ export ENV_BUILD_TOOL=`pwd`/out/toolchain/cortex-a53-toolchain-gcc12.2.0-linux5.15/bin/aarch64-linux-gnu-</div>
</div><!-- fragment --><dl class="section user"><dt>Amba build at the top folder (using CV3 Dk_mini EVK as an example)</dt><dd></dd></dl>
<div class="fragment"><div class="line">ambarella$ <a class="code hl_variableRef" target="_blank" href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> build/env/amba-build.env cv3_dk_mini</div>
<div class="line">ambarella$ make ipcam_config</div>
<div class="line">ambarella$ make</div>
</div><!-- fragment --><dl class="section user"><dt>Amba build at the board folder (ambarella/boards/cv3_dk_mini)</dt><dd></dd></dl>
<div class="fragment"><div class="line">ambarella/boards/cv3_dk_mini$ make ipcam_config</div>
<div class="line">ambarella/boards/cv3_dk_mini$ make</div>
</div><!-- fragment --><dl class="section user"><dt>Yocto build (using CV3 Dk_Mini EVK as an example)</dt><dd></dd></dl>
<div class="fragment"><div class="line">ambarella$ <a class="code hl_variableRef" target="_blank" href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> build/env/yocto-build.env cv3_dk_mini</div>
<div class="line">ambarella/out/yocto_out/cv3_dk_mini$ make ipcam_config</div>
<div class="line">ambarella/out/yocto_out/cv3_dk_mini$ make</div>
</div><!-- fragment --><h2><a class="anchor" id="doc_guide_build_image_cv72"></a>
1.4 CV72 Image Build</h2>
<p >The following steps are using CV72 Xiezhi EVK as an example, users can replace cv72_xiezhi with other CV72 boardname, such as cv72_gage.</p>
<dl class="section user"><dt>Build the cross-toolchain (optional)</dt><dd></dd></dl>
<div class="fragment"><div class="line">ambarella$ sudo apt install texinfo gawk</div>
<div class="line">ambarella$ <a class="code hl_variableRef" target="_blank" href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> build/env/amba-build.env cv72_xiezhi</div>
<div class="line">ambarella$ make -C build/toolchain</div>
<div class="line">ambarella$ export ENV_BUILD_TOOL=`pwd`/out/toolchain/cortex-a53-toolchain-gcc12.2.0-linux5.15/bin/aarch64-linux-gnu-</div>
</div><!-- fragment --><dl class="section user"><dt>Amba build at the top folder (using CV72 Xiezhi EVK as an example)</dt><dd></dd></dl>
<div class="fragment"><div class="line">ambarella$ <a class="code hl_variableRef" target="_blank" href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> build/env/amba-build.env cv72_xiezhi</div>
<div class="line">ambarella$ make auto_nand_config</div>
<div class="line">ambarella$ make</div>
</div><!-- fragment --><dl class="section user"><dt>Amba build at the board folder (ambarella/boards/cv72_xiezhi)</dt><dd></dd></dl>
<div class="fragment"><div class="line">ambarella/boards/cv72_xiezhi$ make auto_nand_config</div>
<div class="line">ambarella/boards/cv72_xiezhi$ make</div>
</div><!-- fragment --><dl class="section user"><dt>Yocto build (using CV72 Xiezhi EVK as an example)</dt><dd></dd></dl>
<div class="fragment"><div class="line">ambarella$ <a class="code hl_variableRef" target="_blank" href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> build/env/yocto-build.env cv72_xiezhi</div>
<div class="line">ambarella/out/yocto_out/cv72_xiezhi$ make auto_nand_config</div>
<div class="line">ambarella/out/yocto_out/cv72_xiezhi$ make</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="doc_amyoc_guide_parameter_config"></a>
2 General Make Commands</h1>
<dl class="section user"><dt>Commands to configure parameters</dt><dd></dd></dl>
<a class="anchor" id="yocto_command_parameters"></a>
<table class="doxtable">
<caption>Table 2-1. Commands to Configure Parameters.</caption>
<tr>
<th>Comamnds </th><th>Function </th></tr>
<tr>
<td>make menuconfig </td><td>Perform menuconfig for software packages (including AMBoot) </td></tr>
<tr>
<td>make xxx_config </td><td>Load specific software package config file </td></tr>
<tr>
<td>make xxx_saveconfig </td><td>Save current <code>.config</code> to config file xxx_config </td></tr>
<tr>
<td>make linux_menuconfig </td><td>Perform menuconfig for Linux kernel </td></tr>
<tr>
<td>make linux_defconfig </td><td>Apply default configuration for Linux kernel </td></tr>
</table>
<dl class="section user"><dt>Directory structure of configuration files</dt><dd></dd></dl>
<div class="fragment"><div class="line">ambarella/boards/cv22_walnut</div>
<div class="line">├── Makefile</div>
<div class="line">├── amba.kconf</div>
<div class="line">├── bsp</div>
<div class="line">└── config</div>
<div class="line">    ├── amba</div>
<div class="line">    │   ├── ipcam_config         <span class="comment">// Compilation configuration of Amba Build</span></div>
<div class="line">    │   └── amboot</div>
<div class="line">    │       └── amboot_config    <span class="comment">// Amboot configuration of Amba Build</span></div>
<div class="line">    ├── yocto</div>
<div class="line">    │   ├── ipcam_config         <span class="comment">// Compilation configuration of Yocto Build</span></div>
<div class="line">    │   └── amboot</div>
<div class="line">    │       └── amboot_config    <span class="comment">// Amboot configuration of Yocto Build</span></div>
<div class="line">    └── kernel</div>
<div class="line">        └── xxx_kernel_config    <span class="comment">// Compilation configuration of kernel</span></div>
</div><!-- fragment --><p >Example: configure <b>Max VIN Channel Number</b></p>
<dl class="section user"><dt>For Cooper Amba build:</dt><dd><div class="fragment"><div class="line">build$ make menuconfig</div>
<div class="line">  drv_modules  ---&gt;</div>
<div class="line">    <span class="keyword">private</span>  ---&gt;</div>
<div class="line">      -*- ambvideo-header (drv_modules/<span class="keyword">private</span>/video/dsp_v5)  ---&gt;</div>
<div class="line">        (4)   Max VIN Channel Number</div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt>For Cooper Yocto build:</dt><dd><div class="fragment"><div class="line">build$ make menuconfig</div>
<div class="line">  meta-ambabsp  ---&gt;</div>
<div class="line">    recipes-video  ---&gt;</div>
<div class="line">      -*- ambvideo-header (meta-ambabsp/recipes-video/ambvideo-header)  ---&gt;</div>
<div class="line">        (4)   Max VIN Channel Number</div>
</div><!-- fragment --></dd></dl>
<hr  />
<h1><a class="anchor" id="doc_amyoc_guide_populate_sdk"></a>
3 Populate SDK Commands</h1>
<p >Building the SDK installer for a standard SDK and populating the SDK image are the features supported by Yocto Poky. Users can refer to below note for more information about populating SDK.</p>
<p >Users must use Yocto Build to enable this function. Amba Build does not support this function.</p>
<p >The sample commands for each chip family are as follows.</p>
<dl class="section user"><dt>Populate SDK for CV2x (using CV22 Walnut EVK as an example)</dt><dd><div class="fragment"><div class="line">ambarella$ <a class="code hl_variableRef" target="_blank" href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> build/env/yocto-build.env cv22_walnut</div>
<div class="line">ambarella/out/yocto_out/cv22_walnut$ make ipcam_config</div>
<div class="line">ambarella/out/yocto_out/cv22_walnut$ bitbake ipcam-image -c populate_sdk</div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt>Populate SDK for CV5x (using CV5 Timn EVK as an example)</dt><dd><div class="fragment"><div class="line">ambarella$ <a class="code hl_variableRef" target="_blank" href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> build/env/yocto-build.env cv5_timn</div>
<div class="line">ambarella/out/yocto_out/cv5_timn$ make ipcam_config</div>
<div class="line">ambarella/out/yocto_out/cv5_timn$ bitbake ipcam-image -c populate_sdk</div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt>Populate SDK for CV3 (using CV3 Dk_mini EVK as an example)</dt><dd><div class="fragment"><div class="line">ambarella$ <a class="code hl_variableRef" target="_blank" href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> build/env/yocto-build.env cv3_dk_mini</div>
<div class="line">ambarella/out/yocto_out/cv3_dk_mini$ make ipcam_config</div>
<div class="line">ambarella/out/yocto_out/cv3_dk_mini$ bitbake ipcam-image -c populate_sdk</div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt>Populate SDK for CV72 (using CV72 Xiezhi EVK as an example)</dt><dd><div class="fragment"><div class="line">ambarella$ <a class="code hl_variableRef" target="_blank" href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> build/env/yocto-build.env cv72_xiezhi</div>
<div class="line">ambarella/out/yocto_out/cv72_xiezhi$ make auto_nand_config</div>
<div class="line">ambarella/out/yocto_out/cv72_xiezhi$ bitbake ipcam-image -c populate_sdk</div>
</div><!-- fragment --></dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Building the SDK installer for extensible SDK (<code>bitbake ipcam-image -c populate_sdk_ext</code>) is not supported here, as the recipes in Cooper SDK are using "EXTERNALSRC", which is not currently supported in sdk_ext by Yocto Poky.</li>
<li>For more information about populating SDK, users can refer to <code><a href="https://docs.yoctoproject.org/4.0.11/singleindex.html">https://docs.yoctoproject.org/4.0.11/singleindex.html</a>#sdk-generation</code>.</li>
</ul>
</dd></dl>
<hr  />
<h1><a class="anchor" id="doc_amyoc_guide_other_commands"></a>
4 Other Make Commands</h1>
<a class="anchor" id="yocto_other_command"></a>
<table class="doxtable">
<caption>Table 4-1. Other Make Commands.</caption>
<tr>
<th>Comamnds </th><th>Function </th></tr>
<tr>
<td>make deps </td><td>Generate the compilation chain. This operation must be performed when a new package is added or an old package is deleted </td></tr>
<tr>
<td>make clean (Yocto Build) </td><td>Clean rootfs </td></tr>
<tr>
<td>make clean (Amba Build) </td><td>Clean the compiling output, but maintain the system's compilation configuration </td></tr>
<tr>
<td>make distclean </td><td>Clean both the compling output and the system's compilation configuation </td></tr>
<tr>
<td>make $(package)_clean </td><td>Execute clean operations for the specified package </td></tr>
<tr>
<td>make $(package)-deps </td><td>Generate the dependency graph for the specified package </td></tr>
<tr>
<td>make all-deps </td><td>Generate the dependency graph for all software packages </td></tr>
<tr>
<td>make sdk_doc </td><td>Generate Doxgen documents and output them into <code>ambarella/out/doc_out/cv2x</code> </td></tr>
<tr>
<td>make makes </td><td>Update the Makefile template </td></tr>
<tr>
<td>make time_statistics (Amba Build) </td><td>Generate the statistics file for the compiling time of all packages </td></tr>
<tr>
<td>make $(package) </td><td>Compile the given package. The dependency packages will be compiled automatically </td></tr>
<tr>
<td>make $(package)_single (Amba Build) </td><td>Compile the given package and do not compile dependency packages </td></tr>
<tr>
<td>make $(package)_$(target) (Amba Build) </td><td>Compile the given target in the specified package; dependent packages will be compiled automatically </td></tr>
<tr>
<td>make $(package)_$(target)_single (Amba build) </td><td>Compile the given target in the specified package and do not compile dependent packages </td></tr>
<tr>
<td>bitbake $(package) -c $(task) (Yocto Build) </td><td>Compile the single task in the specified package </td></tr>
<tr>
<td>make $(package) c=$(target) f=$(makefile) (Yocto build) </td><td>Compile the single target in the specified package; the recipe should include <code>include ${THISDIR}/usertask.inc</code> </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>When a target of the package is specified in Amba build, it must be declared in <b>Other_Target_Names</b> of the DEPS-statement.</li>
<li>Targets of a single type exist with dependent packages.</li>
<li>Commands for building package targets in Yocto build cannot cover all cases. For more details, take reference from the Yocto official document.</li>
</ul>
</dd></dl>
<hr  />
 </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
