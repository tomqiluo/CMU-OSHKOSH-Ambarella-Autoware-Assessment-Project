<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Build System: Generate Dependency Chain</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Build System"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-ambarella.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Ambarella.png"/></td>
  <td id="projectalign">
   <div id="projectname">Build System<span id="projectnumber">&#160;Cooper_1.6.0 (CV72 &amp; CV3) @ 2024.07.10 14:12:44</span>
   </div>
   <div id="projectbrief">placeholder</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.html','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d7/df0/doc_amyoc_dep.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Generate Dependency Chain </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="doc_amyoc_guide_command_usage_of_amba_build"></a>
1 Amba Build Command Option</h1>
<ul>
<li><code>build/bin/amba/inc-amba-build.mk</code></li>
</ul>
<div class="fragment"><div class="line">deps:</div>
<div class="line">    @-mkdir -p $(OUT_PATH)</div>
<div class="line">    @python3 $(ENV_TOOL_DIR)/common/gen_build_chain.py -m $(OUT_PATH)/<span class="keyword">auto</span>.mk -k $(OUT_PATH)/Kconfig -t $(OUT_PATH)/Target -a $(OUT_PATH)/DEPS \</div>
<div class="line">     -d amba.mk -c amba.kconf -v amba.vdeps -s $(ENV_TOP_DIR) -i $(IGNORE_DIRS) -l 5 -w $(KEYWORDS) -p 1</div>
</div><!-- fragment --><p >Command items in <code>gen_build_chain.py</code>: </p><a class="anchor" id="yocto_gen-py_amba"></a>
<table class="doxtable">
<caption>Table 1-1. Command Items in gen_build_chain.py of Amba Build.</caption>
<tr>
<th>Items </th><th>Function </th></tr>
<tr>
<td>-m &lt;Makefile Path&gt; </td><td>Name of Makefile that was generated automatically in common compiling;<br  />
 A top Makefile can be used to include sub Makefiles that was generated automatically. Then the all target can call <b>make $(BUILD_JOBS) -s MAKEFLAGS=all_targets</b>;<br  />
 to compile all packages by starting multi-thread. The jobserver must be specified before a package can begin in multi-thread compilation </td></tr>
<tr>
<td>-k &lt;Kconfig Path&gt; </td><td>Specifies the file path of all projects in which Kconfig is stored </td></tr>
<tr>
<td>-t &lt;Target Path&gt; </td><td>Specifies the path of the file where the package name and source path list are stored </td></tr>
<tr>
<td>-a &lt;Depend Path&gt; </td><td>Specifies the path of the file where the package dependency list is stored </td></tr>
<tr>
<td>-d &lt;Search Depend Name&gt; </td><td>The name of the dependent file to be searched (containing the dependency rule statement). The dependency file can contain multiple dependencies </td></tr>
<tr>
<td>-c &lt;Search Kconfig Name&gt; </td><td>Name of configuration file for Kconfig that will be searched<br  />
 Find the configuration file in the same directory as the dependent file. In the search process, the configuration file with the same suffix as name of package will be searched first, and then will search for the configuration file if it cannot be found </td></tr>
<tr>
<td>-v &lt;Search Virtual Depend Name&gt; </td><td>The name of virtual dependent file to be searched (containing the statements of the virtual dependent rule) </td></tr>
<tr>
<td>-s &lt;Search Directories&gt; </td><td>Path for searching directories. Multiple directories are separated by commas </td></tr>
<tr>
<td>-i &lt;Ignore Directories&gt; </td><td>Directories to be ignored. Dependent files in these specified direcotries will not be searched. Multiple directories can be specified by commas </td></tr>
<tr>
<td>-g &lt;Go On Directories&gt; </td><td>Path for searching directories continuously. Multiple directories can be specified by commas;<br  />
 The current directory's subdirectory will not be searched when "&lt;Search Depend Name&gt;" has been found or "&lt;Go On Directories&gt;" is not specified </td></tr>
<tr>
<td>-l &lt;Max Layer Depth&gt; </td><td>Sets the maximum layer of menuconfig </td></tr>
<tr>
<td>-w &lt;Keyword Directories&gt; </td><td>Used for menuconfig. If the search path contains this directory, layer of this path is reduced by 1. Multiple directories can be specified by commas </td></tr>
<tr>
<td>-p &lt;prepend Flag&gt; </td><td>Used for menuconfig. If no prefix for CONFIG_="" is set when the users run conf / mconf, this flag must set to 1 when the script runs </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="doc_amyoc_guide_command_usage_of_yocto_build"></a>
2 Yocto Build Command Option</h1>
<ul>
<li><code>build/bin/yocto/inc-yocto-build.mk</code></li>
</ul>
<div class="fragment"><div class="line">deps: kconfig-native</div>
<div class="line">    @mkdir -p $(shell dirname $(KCONFIG))</div>
<div class="line">    @python3 $(ENV_TOOL_DIR)/common/gen_build_chain.py -k $(OUT_PATH)/Kconfig -t $(OUT_PATH)/Target \</div>
<div class="line">      -c amba.kconf -v amba.vdeps -i $(IGNORE_DIRS) -l 3 -w $(KEYWORDS) -p 1 -u $(USER_METAS)</div>
<div class="line"> </div>
<div class="line">CONF_APPEND_CMD = python3 $(ENV_TOOL_DIR)/common/gen_build_chain.py \</div>
<div class="line">                   -t $(OUT_PATH)/Target -c $(CONFIG_PATH) \</div>
<div class="line">                   -o $(IMAGE_PKG_PATH) -p $(PATCH_PKG_PATH) -i $(IGNORE_RECIPES) &amp;&amp; \</div>
<div class="line">...</div>
</div><!-- fragment --><p >Command items in gen_build_chain.py: </p><a class="anchor" id="yocto_gen-py_yoc"></a>
<table class="doxtable">
<caption>Table 2-1. Command Items in gen_build_chain.py of Yocto Build.</caption>
<tr>
<th>Items </th><th>Function </th></tr>
<tr>
<td>-k &lt;Kconfig Path&gt; </td><td>Specifies the file path of all projects in which Kconfig is stored. The normal build will also generate a target file in the same directory as Kconfig, in which all of a package's file paths, names, and dependencies are listed </td></tr>
<tr>
<td>-t &lt;Target Path&gt; </td><td>Specifies the path of the file where the package name and source path list are stored </td></tr>
<tr>
<td>-c &lt;Search Kconfig Name&gt; </td><td>Same of the configuration file for Kconfig that will be searched;<br  />
 To search the Kconfig configuration file, <b>$(RECIPE_NAME).bbconfig</b> in the current directory has priority to be found If it cannot be found, the search path will transfer to what is specified by EXTERNALSRC of the bbappend file In the search process, the configuration file with the same suffix as the name of the package will be searched first, and then will search for the configuration file if it cannot be found </td></tr>
<tr>
<td>-v &lt;Search Virtual Depend Name&gt; </td><td>The name of the virtual dependent file to be searched (containing the statements of the virtual dependent rule) </td></tr>
<tr>
<td>-i &lt;Ignore Directories&gt; </td><td>Directories to be ignored. Dependent files in these specified direcotries will not be searched. Multiple directories can be specified by commas </td></tr>
<tr>
<td>-l &lt;Max Layer Depth&gt; </td><td>Sets the maximum layer of menuconfig </td></tr>
<tr>
<td>-w &lt;Keyword Directories&gt; </td><td>Used for menuconfig. If the search path contains this directory, the layer of this path is reduced by 1. Multiple directories can be specified by commas </td></tr>
<tr>
<td>-p &lt;prepend Flag&gt; </td><td>Used for menuconfig. If no prefix of CONFIG_="" is set when the users run conf / mconf, this flag must be set to 1 when the script runs </td></tr>
<tr>
<td>-u &lt;User Metas&gt; </td><td>Specifies the user layer in Yocto Build. Multiple layers are separated by commas. Only user-level packages perform dependency analysis </td></tr>
<tr>
<td>-o &lt;Output Recipe Path&gt; </td><td>Specifies the path in which the package lists are stored </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="doc_amyoc_guide_real_dependency_amba"></a>
3 Amba Build Regular Dependency</h1>
<ul>
<li>Real dependency information format: <b>$::DEPS(Makefile_Name) Target_Name(Other_Target_Names): Depend_Names</b></li>
</ul>
<p > 
 <a href="../../real_dependency_amba_build.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../real_dependency_amba_build.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 3-1. Real Dependency Amba Build.</div></div>
<p > 
 </a>
 </p>
<ul>
<li>Dependency information format including sub-path: <b>#INCDEPS: Subdir_Names</b></li>
</ul>
<p > 
 <a href="../../dependency_information_format_include_subpath.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../dependency_information_format_include_subpath.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 3-2. Dependency Information Format.</div></div>
<p > 
 </a>
 </p>
<ul>
<li>Format description:<ul>
<li><b>Makefile_Name</b>: the name of the Makefile to be run by make (can be empty). The "make" command can specify the Makefile when it runs <b>make -f Makefile_Name</b><ul>
<li>Makefile must contain three targets: all, clean, and install</li>
<li>The name of the Makeifle can include path (/). Searching sub-packages in sub-directories is supported. For example: test1/ or test2/wrapper.mk</li>
<li>"#INCDEPS" can search dependent files in sub-directories continously. Recursive is supported. For instance: #INCDEPS: test1 test2</li>
</ul>
</li>
<li><b>Target_Name</b>: current package's name ID<ul>
<li>The keyword <em>ignore</em> is a special package name; it indicates that the package will be ignored It is used in searching operation to ignore the certain directory</li>
</ul>
</li>
<li><b>Other_Target_Names</b>: other targets of the current package. Multiple targets are separated by spaces<ul>
<li>Targets with names of all, install, and clean in Other_Target_Names will be ignored</li>
<li>The keyword <em>prepare</em> is a special real target which indicates that "make prepare" must be run before performing "make" operation It is generally used to load the default configuration to <code>.config</code> when <code>.config</code> does not exist</li>
<li>The keyword <em>psysroot</em> is a special real target which indicates that "make psysroot" must be run before performing "make" operation<ul>
<li>Then the package uses dependency sysroot under the OUT_PATH instead of <code>ENV_DEP_ROOT / ENV_DEP_ROOT</code> directory</li>
</ul>
</li>
<li>The keyword <em>release</em> is a special real target which indicates that rootfs uses "make install" to install<ul>
<li>If the release is not defined, rootfs will use "make install" to install</li>
</ul>
</li>
<li>Keyword of <em>union</em> is a special virtual target and multiple packages can share the same Makefile<ul>
<li>The target names of prepare, all, install, and clean are changed to Target_Name-prepare, Target_Name-all, Target_Name-install, and Target_Name-clean</li>
<li>Users can take reference from <code>ambarella/kernel/amba.mk</code> and <code>ambarella/kernel/linux-patch/amba.mk</code></li>
</ul>
</li>
<li>Keyword of <em>cache</em> is a special virtual target that indicates the package uses cache compilation</li>
<li>The keyword <em>jobserver</em> is a special virtual target which indicates that multi-thread compilation can be started by executing "export ENV_BUILD_JOBS=-j8" and adding <b>$(ENV_BUILD_JOBS)</b> to the make command<ul>
<li>Some packages's Makefile will not add the jobserver target when it includes the make command, such as the compilation of the external kernel module</li>
</ul>
</li>
</ul>
</li>
<li><b>Depend_Names</b>: dependent packages' name ID of the current package. Multiple dependencies are separated by spaces<ul>
<li>If circular dependence exists or dependency is not defined, the parsing operation will fail and error information will print on the screen:<ul>
<li>For circular dependency: "ERROR: circular deps!"</li>
<li>For no definition of dependency: "ERROR: deps (%s) are not found!"</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The package's name ID (Target_Name Depend_Names) is a combination of lower-case letters, numbers, and underscores; Other_Target_Names has no such requirement.</dd></dl>
<hr  />
<h1><a class="anchor" id="doc_amyoc_guide_real_dependency_yocto"></a>
4 Yocto Build Regular Dependency</h1>
<p >Yocto build dependencies are defined in recipe: </p><a class="anchor" id="yocto_recipe_class"></a>
<table class="doxtable">
<caption>Table 4-1. Yocto Build Dependencies.</caption>
<tr>
<th>Items </th><th>Function </th></tr>
<tr>
<td>DEPENDS: </td><td>Point dependent packages' name in the compiling stage;<br  />
 Dependent packages of the machine (<b>$(PACKAGE_NAME)-native</b>) may be required to be specified in Yocto, such as bash-native </td></tr>
<tr>
<td>RDEPENDS:${PN} </td><td>Point dependent packages' name in the running stage. Dependent packages with dynamic libraries should be added into this variable </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="doc_amyoc_guide_virtual_dependency"></a>
5 Virtual Dependency</h1>
<dl class="section user"><dt>Virtual dependency format: #VDEPS(Virtual_Type) Target_Name(Other_Infos): Depend_Names</dt><dd></dd></dl>
<p> 
 <a href="../../virtual_dependency_regex.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../virtual_dependency_regex.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 5-1. Virtual Dependency Regex.</div></div>
<p > 
 </a>
 </p>
<dl class="section user"><dt>Format description</dt><dd></dd></dl>
<ul>
<li><b>Virtual_Type</b>: required; indicates a virtual package's type. Four types are now supported:<ul>
<li><b>menuconfig</b>: indicates to generate a menuconfig virtual package. All packages in the current directory (including sub-directories) have strong dependencies on this package</li>
<li><b>config</b>: indicates to generate a config virtual package</li>
<li><b>menuchoice</b>: indicates to generate a virtual package of choice. All packages in the current directory (including sub-directories) become sub-items of choice</li>
<li><b>choice</b>: indicates to generate a virtual package of choice. Package lists are under Other_Infos become sub-item of choice</li>
</ul>
</li>
<li><b>Virtual_Name</b>: required; name of the virtual package</li>
<li><b>Other_infos</b>: required for choice type; optional for others<ul>
<li>For all types, a path item starting with '/' (optional) can appear; this indicates that it functions on the specified subdirectory, not on the current directory<ul>
<li>For config and choice, the path item can be specified with a virtual path, for example, "/virtual" (virtual can be any word), where the virtual project is displayed under the current directory (not the parent directory)</li>
</ul>
</li>
<li>For choice, package lists separated by spaces will become the choice's sub-item and the first package is the default-selected package</li>
<li>For menuchoice, default-selected package can be specified</li>
</ul>
</li>
<li><b>Depend_Names</b>: optional, list of dependent items. The usage is basically the same with DEPS-statement, such as setting unselect, choice, and menuchoice. Select and imply are not supported</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>A virtual dependency means that the package is not the actual package and will not be compiled. Virtual dependencies are only used to organize and manage actual packages. The rules for writing and using virtual packages are the same for normal and Yocto compilations.</dd></dl>
<hr  />
<h1><a class="anchor" id="doc_amyoc_guide_special_dependencies"></a>
6 Special Dependency</h1>
<h2><a class="anchor" id="sub_amyoc_guide_spec_dep_virt_pkg"></a>
6.1 Virtual Package</h2>
<ul>
<li>*depname: indicates that this dependent package is the virtual package with name depname. depname can also have the following special characters, which will continue to be parsed. For instance: *??depname</li>
</ul>
<h2><a class="anchor" id="sub_amyoc_guide_spec_dep_keyword"></a>
6.2 Keyword</h2>
<a class="anchor" id="yocto_recipe_keywords"></a>
<table class="doxtable">
<caption>Table 6-1. Special Dependency Keywords.</caption>
<tr>
<th>Keywords </th><th>Function </th></tr>
<tr>
<td>finally </td><td>Indicates that this package is the last to be compiled and is used to generate the file system and images. This keyword is only used in strong dependencies for normal compilation </td></tr>
<tr>
<td>unselect </td><td>Indicates that this package is not compiled (default n) </td></tr>
<tr>
<td>nokconfig </td><td>Indicates that this package does not contain Kconfig configuration. When there are multiple packages in the same directory, the Kconfig file for packages with Kconfig can be set to <b>$(package_name).kconf</b>, while packages without Kconfig must be set nokconfig </td></tr>
</table>
<h2><a class="anchor" id="sub_amyoc_guide_spec_dep_spec_charactor"></a>
6.3 Special Character</h2>
<a class="anchor" id="yocto_recipe_special_character"></a>
<table class="doxtable">
<caption>Table 6-2. Special Character.</caption>
<tr>
<th>Character </th><th>Function </th></tr>
<tr>
<td>!depname </td><td>Indicates that this package conflicts with the depname package and they cannot be turned on at the same time (depends on !depname) </td></tr>
<tr>
<td>&amp;depname </td><td>Indicates that this package selects depname package weakly (imply depname). When this package is choosen, depname can also be selected. It can be cancelled manually </td></tr>
<tr>
<td>&amp;&amp;depname </td><td>Indicates that this package selects depname package strongly (select depname). When this package is choosen, depname can also be selected. It can not be cancelled </td></tr>
<tr>
<td>?depname </td><td>Indicates that this package has weak dependency (do not install dynamic library) with depname. Weak dependency means that the package can be compiled successfully even if the dependent package is not selected or does not exist </td></tr>
<tr>
<td>??depname </td><td>Similar to ?depname, ??depname indicates that this package has weak dependency (dynamic libraries are to be installed) with depname </td></tr>
<tr>
<td>depa|depb </td><td>Indicates that this package has weak dependencies (do not install dynamic library) with depa, depb ... . The package will be compiled successfully when at least one dependent package is selected </td></tr>
<tr>
<td>depa||depb </td><td>Similar to depa|depb, this indicates that the package have weak dependency (dynamic libraries are to be installed) with depa, depb ... </td></tr>
<tr>
<td>&amp; | </td><td>&amp; can be combined with | and indicates that one package has weak dependency with all real packages;<br  />
 Suitable for strongly selecting and has weak dependency with one of the pre-compiled and source packages;<br  />
 If the last '|' is omitted, the characters between "||" and "&amp;" will be implicitly derived as <b>*build-$(package_name) prebuild-$(package_name) and package_name</b>;<br  />
 For example: &amp;&amp;||libtest will be implicitly derived as &amp;&amp;*build-libtest||prebuild-libtest||libtest<br  />
 For example: "&amp;&amp;*build-libtest||prebuild-libtest||libtest" indicates that the first existed package will be selected strongly and has weak dependency with the other real packages </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>&amp; can be used with ? and no combination order required. It indicates that the package is selected and has weak dependency. For example, "&amp;&amp;??depname": strongly selected and weak dependency; "??&amp;depname": weak dependency and weak selected</li>
<li>If the word before | or || was omitted, it will be implicitly derived using the pre-compiled package or the source package. For example, ||libtest will be derived to prebuild-libtest||libtest</li>
<li>For general compilations, there is no difference for "? ??" or "| ||"</li>
<li>For Yocto build, the weak dependency of "? |" only sets DEPENDS, but "?? ||" will set <b>DEPENDS</b> and <b>DEPENDS:${PN}</b> at the same time</li>
</ul>
</dd></dl>
<h2><a class="anchor" id="sub_amyoc_guide_spec_dep_env_var"></a>
6.4 Environment Variable</h2>
<p >Environment variable: </p><a class="anchor" id="yocto_recipe_environment_variable"></a>
<table class="doxtable">
<caption>Table 6-3. Environment Variable.</caption>
<tr>
<th>Variable </th><th>Function </th></tr>
<tr>
<td>ENVNAME=val1,val2 </td><td>Indicates that the value of the environment variable depended upon by this package is equal to val1 or val2 </td></tr>
<tr>
<td>ENVNAME!=val1,val2 </td><td>Indicates that the value of the environment variable depended upon by this package is not equal to val1 and val2 </td></tr>
</table>
<h2><a class="anchor" id="sub_amyoc_guide_spec_dep_yocto"></a>
6.5 Yocto Special Dependencies</h2>
<p >The special dependencies in Yocto are extended by Ambarella. In Amba build, special dependencies will set the element of Depend_Names in DEPS-statement. For Yocto Build, they are assigned to EXTRADEPS of Recipe files.</p>
<p >If a weak dependency exists in EXTRADEPS, "inherit weakdep" must be inherited. "*weakdep" class will parse config / .config that is used to output the root directory. Then, it set <b>DEPENDS</b> and <b>DEPENDS:${PN}</b> by checking whether or not this item is selected.</p>
<hr  />
<h1><a class="anchor" id="doc_amyoc_guide_amba_dep_graph"></a>
7 Amba Build Dependency Graph</h1>
<p >To make it easier for users to clearly find package dependencies, Ambarella has added a method to generate a dependency graph, the details of the method are shown below:</p>
<p ><b>gen_depends_image.sh</b> [para1]...[para4]</p><ul>
<li>para1: Package name</li>
<li>para2: Path to the folder where the graphs are stored</li>
<li>para3: List of package names<ul>
<li>Amba build: Path to the file where the package name and dependency list are stored (the path specified by -a in <code>gen_build_chain.py</code>)</li>
<li>Yocto build: Path to the file where package names and source paths are stored (the path specified by -t of <code>gen_build_chain.py</code>)</li>
</ul>
</li>
<li>para4: Configuration file path</li>
</ul>
<p ><b>Instructions for generating graphs</b>:</p><ul>
<li>Usage, make packagename-deps; output, <code>out_dir(top-level output directory)/config/depends</code></li>
<li><p class="startli">Amba Build graph details </p><a class="anchor" id="amyoc_amba_dep_line"></a>
<table class="doxtable">
<caption>Table 7-1. Table Line Details.</caption>
<tr>
<th>Line </th><th>Meaning </th></tr>
<tr>
<td>Solid lines </td><td>Strong dependencies </td></tr>
<tr>
<td>Dashed lines </td><td>Weak dependencies </td></tr>
<tr>
<td>Double line </td><td>Either prebuild and srcbuild, or patch and unpatch </td></tr>
<tr>
<td>Green line </td><td>The package is already selected in <code>.config</code> </td></tr>
<tr>
<td>Red line </td><td>The package is not selected in <code>.config</code> </td></tr>
</table>
<a class="anchor" id="amyoc_amba_dep_box"></a>
<table class="doxtable">
<caption>Table 7-2. Box Color Details.</caption>
<tr>
<th>Box </th><th>Meaning </th></tr>
<tr>
<td>Green box </td><td>The package in <code>.config</code> is already selected </td></tr>
<tr>
<td>Red box </td><td>The package is not selected in <code>.config</code> </td></tr>
</table>
</li>
</ul>
<h2><a class="anchor" id="sub_amyoc_graph_amba_dsp"></a>
7.1 DSP Unit Test</h2>
<p > 
 <a href="../../amba_iav-test.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../amba_iav-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-1. iav-test.</div></div>
<p > 
 </a>
  <br  />
</p>
<div class="image">
<object type="image/svg+xml" data="../../amba_smartrc3-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-2. smartrc3-test.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../amba_dewarp-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-3. dewarp-test.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../amba_smartfb-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-4. smartfb-test.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../amba_eis-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-5. eis-test.</div></div>
<p> <br  />
</p>
<h2><a class="anchor" id="sub_amyoc_graph_amba_cv"></a>
7.2 CV Unit Test</h2>
<p > 
 <a href="../../amba_cvflow-test.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../amba_cvflow-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-6. cvflow-test.</div></div>
<p > 
 </a>
  <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../amba_cv-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-7. cv-test.</div></div>
<p> <br  />
</p>
<h2><a class="anchor" id="sub_amyoc_graph_amba_eazyai"></a>
7.3 EazyAI</h2>
<p > 
 <a href="../../amba_eazyai-apps-test.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../amba_eazyai-apps-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-8. eazyai-apps-test.</div></div>
<p > 
 </a>
  <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../amba_libeazyai-arm-postprocess.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-9. libeazyai-arm-postprocess.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../amba_libeazyai.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-10. libeazyai.</div></div>
<p> <br  />
</p>
<p > 
 <a href="../../amba_eazyai-unit-test.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../amba_eazyai-unit-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-11. eazyai-unit-test.</div></div>
<p > 
 </a>
  <br  />
</p>
<h2><a class="anchor" id="sub_amyoc_graph_amba_3a"></a>
7.4 3A</h2>
<div class="image">
<object type="image/svg+xml" data="../../amba_idsp-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-12. idsp-test.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../amba_libimgflow.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-13. libimgflow.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../amba_libimgalgo.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-14. libimgalgo.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../amba_ipc-imx274-datas.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-15. ipc-imx274-datas.</div></div>
<p> <br  />
</p>
<h2><a class="anchor" id="sub_amyoc_graph_amba_kernel"></a>
7.5 Amba Private Kernel Drivers</h2>
<div class="image">
<object type="image/svg+xml" data="../../amba_kernel-module-ambvideo.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-16. kernel-module-ambvideo.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../amba_kernel-module-ambcavalry.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-17. kernel-module-ambcavalry.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../amba_kernel-module-max9296.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-18. kernel-module-max9296.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../amba_kernel-module-imx274.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-19. kernel-module-imx274.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../amba_kernel-module-imx274-mipi-brg.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-20. kernel-module-imx274-mipi-brg.</div></div>
<p> <br  />
</p>
<h2><a class="anchor" id="sub_amyoc_graph_amba_gstreamer"></a>
7.6 GStreamer</h2>
<p > 
 <a href="../../amba_libgstamba.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../amba_libgstamba.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-21. libgstamba.</div></div>
<p > 
 </a>
  <br  />
</p>
<p > 
 <a href="../../amba_libgstnnstreamer.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../amba_libgstnnstreamer.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-22. libgstnnstreamer.</div></div>
<p > 
 </a>
  <br  />
</p>
<p > 
 <a href="../../amba_gstd.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../amba_gstd.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-23. gstd.</div></div>
<p > 
 </a>
  <br  />
</p>
<p > 
 <a href="../../amba_gst-client.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../amba_gst-client.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-24. gst-client.</div></div>
<p > 
 </a>
  <br  />
</p>
<p > 
 <a href="../../amba_libgstd.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../amba_libgstd.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-25. libgstd.svg.</div></div>
<p > 
 </a>
  <br  />
</p>
<p > 
 <a href="../../amba_libgstc.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../amba_libgstc.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-26. libgstc.</div></div>
<p > 
 </a>
  <br  />
</p>
<h2><a class="anchor" id="sub_amyoc_graph_amba_prebuild"></a>
7.7 Prebuild SW Packages</h2>
<div class="image">
<object type="image/svg+xml" data="../../amba_prebuild-alsa-plugins.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-27. prebuild-alsa-plugins.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../amba_prebuild-alsa-utils.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-28. prebuild-alsa-utils.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../amba_prebuild-pulseaudio.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 7-29. prebuild-pulseaudio.</div></div>
<p> <br  />
</p>
<hr  />
<h1><a class="anchor" id="doc_amyoc_guide_yocto_dep_graph"></a>
8 Yocto Build Dependency Graph</h1>
<p ><b>Instructions for generating graphs</b>:</p><ul>
<li>Yocto Build graph details <a class="anchor" id="amyoc_yocto_dep_line"></a>
<table class="doxtable">
<caption>Table 8-1. Box Color Details.</caption>
<tr>
<th>Box </th><th>Meaning </th></tr>
<tr>
<td>Green box </td><td>The package in <code>.config</code> is already selected </td></tr>
<tr>
<td>Red box </td><td>The package is not selected in <code>.config</code> </td></tr>
<tr>
<td>Blue box </td><td>Package from communities such as Yocto </td></tr>
</table>
</li>
</ul>
<h2><a class="anchor" id="sub_amyoc_graph_yocto_dsp"></a>
8.1 DSP Unit Test</h2>
<div class="image">
<object type="image/svg+xml" data="../../yocto_iav-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-1. iav-test.</div></div>
<p> <br  />
</p>
<p > 
 <a href="../../yocto_smartrc3-test.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../yocto_smartrc3-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-2. smartrc3-test.</div></div>
<p > 
 </a>
  <br  />
</p>
<div class="image">
<object type="image/svg+xml" data="../../yocto_dewarp-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-3. dewarp-test.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../yocto_smartfb-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-4. smartfb-test.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../yocto_eis-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-5. eis-test.</div></div>
<p> <br  />
</p>
<h2><a class="anchor" id="sub_amyoc_graph_yocto_cv"></a>
8.2 CV Unit Test</h2>
<p > 
 <a href="../../yocto_cvflow-test.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../yocto_cvflow-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-6. cvflow-test.</div></div>
<p > 
 </a>
  <br  />
</p>
<div class="image">
<object type="image/svg+xml" data="../../yocto_cv-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-7. cv-test.</div></div>
<p> <br  />
</p>
<h2><a class="anchor" id="sub_amyoc_graph_yocto_eazyai"></a>
8.3 EazyAI</h2>
<p > 
 <a href="../../yocto_eazyai-apps-test.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../yocto_eazyai-apps-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-8. eazyai-apps-test.</div></div>
<p > 
 </a>
  <br  />
</p>
<p > 
 <a href="../../yocto_libeazyai-arm-postprocess.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../yocto_libeazyai-arm-postprocess.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-9. libeazyai-arm-postprocess.</div></div>
<p > 
 </a>
  <br  />
</p>
<p > 
 <a href="../../yocto_libeazyai.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../yocto_libeazyai.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-10. libeazyai.</div></div>
<p > 
 </a>
  <br  />
</p>
<p > 
 <a href="../../yocto_eazyai-unit-test.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../yocto_eazyai-unit-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-11. eazyai-unit-test.</div></div>
<p > 
 </a>
  <br  />
</p>
<h2><a class="anchor" id="sub_amyoc_graph_yocto_3a"></a>
8.4 3A</h2>
<div class="image">
<object type="image/svg+xml" data="../../yocto_idsp-test.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-12. idsp-test.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../yocto_libimgflow.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-13. libimgflow.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../yocto_libimgalgo.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-14. libimgalgo.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../yocto_ipc-imx274-datas.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-15. ipc-imx274-datas.</div></div>
<p> <br  />
</p>
<h2><a class="anchor" id="sub_amyoc_graph_yocto_amba"></a>
8.5 Amba Private Kernel Drivers</h2>
<div class="image">
<object type="image/svg+xml" data="../../yocto_kernel-module-ambvideo.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-16. kernel-module-ambvideo.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../yocto_kernel-module-ambcavalry.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-17. kernel-module-ambcavalry.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../yocto_kernel-module-max9296.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-18. kernel-module-max9296.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../yocto_kernel-module-imx274.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-19. kernel-module-imx274.</div></div>
<p> <br  />
 </p><div class="image">
<object type="image/svg+xml" data="../../yocto_kernel-module-imx274-mipi-brg.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-20. kernel-module-imx274-mipi-brg.</div></div>
<p> <br  />
</p>
<h2><a class="anchor" id="sub_amyoc_graph_yocto_prebuild"></a>
8.6 Prebuild SW Packages</h2>
<p > 
 <a href="../../yocto_prebuild-alsa-plugins.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../yocto_prebuild-alsa-plugins.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-21. prebuild-alsa-plugins.</div></div>
<p > 
 </a>
  <br  />
</p>
<p > 
 <a href="../../yocto_prebuild-alsa-utils.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../yocto_prebuild-alsa-utils.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-22. prebuild-alsa-utils.</div></div>
<p > 
 </a>
  <br  />
</p>
<p > 
 <a href="../../yocto_prebuild-pulseaudio.svg">
 </p>
<div class="image">
<object type="image/svg+xml" data="../../yocto_prebuild-pulseaudio.svg" style="pointer-events: none;"></object>
<div class="caption">
Figure 8-23. prebuild-pulseaudio.</div></div>
<p > 
 </a>
  <br  />
</p>
<hr  />
 </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
