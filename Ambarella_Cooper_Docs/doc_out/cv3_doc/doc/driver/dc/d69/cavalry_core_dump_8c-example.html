<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Driver: cavalry_core_dump.c</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Driver"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-ambarella.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Ambarella.png"/></td>
  <td id="projectalign">
   <div id="projectname">Driver<span id="projectnumber">&#160;Cooper_1.6.0 (CV72 &amp; CV3) @ 2024.07.10 14:12:44</span>
   </div>
   <div id="projectbrief">placeholder</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.html','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dc/d69/cavalry_core_dump_8c-example.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle"><div class="title">cavalry_core_dump.c</div></div>
</div><!--header-->
<div class="contents">
<p >This is a source code file of <a class="el" href="../../dc/d97/structcavalry__core__dump.html">cavalry_core_dump</a>.</p>
<div class="fragment"><div class="line"><span class="comment">/*******************************************************************************</span></div>
<div class="line"><span class="comment"> * cavalry_core_dump.c</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * History:</span></div>
<div class="line"><span class="comment"> *    2019/09/16  - [Zhikan Yang] created</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Copyright (c) 2019 Ambarella International LP</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This file and its contents ( &quot;Software&quot; ) are protected by intellectual</span></div>
<div class="line"><span class="comment"> * property rights including, without limitation, U.S. and/or foreign</span></div>
<div class="line"><span class="comment"> * copyrights. This Software is also the confidential and proprietary</span></div>
<div class="line"><span class="comment"> * information of Ambarella International LP and its licensors. You may not use, reproduce,</span></div>
<div class="line"><span class="comment"> * disclose, distribute, modify, or otherwise prepare derivative works of this</span></div>
<div class="line"><span class="comment"> * Software or any portion thereof except pursuant to a signed license agreement</span></div>
<div class="line"><span class="comment"> * or nondisclosure agreement with Ambarella International LP or its authorized affiliates.</span></div>
<div class="line"><span class="comment"> * In the absence of such an agreement, you agree to promptly notify and return</span></div>
<div class="line"><span class="comment"> * this Software to Ambarella International LP.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This file includes sample code and is only for internal testing and evaluation.  If you</span></div>
<div class="line"><span class="comment"> * distribute this sample code (whether in source, object, or binary code form), it will be</span></div>
<div class="line"><span class="comment"> * without any warranty or indemnity protection from Ambarella International LP or its affiliates.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * THIS SOFTWARE IS PROVIDED &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES,</span></div>
<div class="line"><span class="comment"> * INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,</span></div>
<div class="line"><span class="comment"> * MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span></div>
<div class="line"><span class="comment"> * IN NO EVENT SHALL AMBARELLA INTERNATIONAL LP OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,</span></div>
<div class="line"><span class="comment"> * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span></div>
<div class="line"><span class="comment"> * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</span></div>
<div class="line"><span class="comment"> * LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS</span></div>
<div class="line"><span class="comment"> * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span></div>
<div class="line"><span class="comment"> * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span></div>
<div class="line"><span class="comment"> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span></div>
<div class="line"><span class="comment"> * POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fcntl.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ctype.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;errno.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;getopt.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/ioctl.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/mman.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;signal.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d3/dbc/cavalry__ioctl_8h.html">cavalry_ioctl.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="codeRef" target="_blank" href="../../../library/de/db0/cavalry__mem_8h.html">cavalry_mem.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define FILENAME_LENGTH     (512)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define NO_ARG    0</span></div>
<div class="line"><span class="preprocessor">#define HAS_ARG  1</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum</span> {</div>
<div class="line">    DUMP_MODE = 0,</div>
<div class="line">    RUN_MODE = 1,</div>
<div class="line">    PARSER_MODE = 2,</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CAVALRY_CORE_DUMP_MAGIC (0xCACACED0)</span></div>
<div class="line"><span class="preprocessor">#define CAVALRY_CORE_DUMP_API (1)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* uint32 x 16 = 64 byte */</span></div>
<div class="line"><span class="keyword">struct </span>cavalry_core_dump_header {</div>
<div class="line">    uint32_t magic_num;</div>
<div class="line">    uint32_t api_version;</div>
<div class="line">    uint32_t chip_arch;</div>
<div class="line">    uint32_t hw_type;</div>
<div class="line">    uint32_t hw_id;</div>
<div class="line">    uint32_t reserved[11];</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> fd_cav = 0;</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> core_file[FILENAME_LENGTH] = {0};</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> write_core_file[FILENAME_LENGTH+64] = {0};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> mode = DUMP_MODE;</div>
<div class="line"><span class="keyword">static</span> uint32_t iter_num = 1;</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> live_flag = 1;</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>option <a id="a0" name="a0"></a>long_options[] = {</div>
<div class="line">    {<span class="stringliteral">&quot;dump&quot;</span>, <a id="a1" name="a1"></a><a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, <span class="charliteral">&#39;d&#39;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;run&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, <span class="charliteral">&#39;r&#39;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;parse&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, <span class="charliteral">&#39;p&#39;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;iter&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, <span class="charliteral">&#39;t&#39;</span>},</div>
<div class="line">    {0, 0, 0, 0}</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a id="a2" name="a2"></a>short_options = <span class="stringliteral">&quot;d:r:p:t:&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a id="_a3" name="_a3"></a><a class="code hl_structRef" target="_blank" href="../../../video/d2/d4b/structhint__s.html">hint_s</a> {</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a id="a4" name="a4"></a><a class="code hl_variableRef" target="_blank" href="../../../video/d2/d4b/structhint__s.html#aa56a50443afd9d2f7cf738fb7ffba168">arg</a>;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a id="a5" name="a5"></a><a class="code hl_variableRef" target="_blank" href="../../../video/d2/d4b/structhint__s.html#a2799cca21c05a4f99f4c8b3b178d0133">str</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code hl_structRef" target="_blank" href="../../../video/d2/d4b/structhint__s.html">hint_s</a> <a id="a6" name="a6"></a>hint[] = {</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tDump core to file path.&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tRun core dump.&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tParse the core dump bin to dvi and ports in current folder.&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tLoop times of run core dump, loop forever (0xffffffff) if set 0. Default is 1&quot;</span>},</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> <a id="a7" name="a7"></a>usage(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *itself = <span class="stringliteral">&quot;cavalry_core_dump&quot;</span>;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i = 0;</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;%s usage:\n&quot;</span>, itself);</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; <span class="keyword">sizeof</span>(long_options) / <span class="keyword">sizeof</span>(long_options[0]) - 1; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (isalpha(long_options[i].val))</div>
<div class="line">            printf(<span class="stringliteral">&quot;-%c &quot;</span>, long_options[i].val);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            printf(<span class="stringliteral">&quot;   &quot;</span>);</div>
<div class="line">        printf(<span class="stringliteral">&quot;--%s&quot;</span>, long_options[i].<a id="a8" name="a8"></a>name);</div>
<div class="line">        <span class="keywordflow">if</span> (hint[i].<a class="code hl_variableRef" target="_blank" href="../../../video/d2/d4b/structhint__s.html#aa56a50443afd9d2f7cf738fb7ffba168">arg</a>[0] != 0)</div>
<div class="line">            printf(<span class="stringliteral">&quot; [%s]&quot;</span>, hint[i].<a class="code hl_variableRef" target="_blank" href="../../../video/d2/d4b/structhint__s.html#aa56a50443afd9d2f7cf738fb7ffba168">arg</a>);</div>
<div class="line">        printf(<span class="stringliteral">&quot;\t%s\n&quot;</span>, hint[i].<a class="code hl_variableRef" target="_blank" href="../../../video/d2/d4b/structhint__s.html#a2799cca21c05a4f99f4c8b3b178d0133">str</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;\nExample:\n\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  # %s -d /tmp/dump.bin\n\n&quot;</span>, itself);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  # %s -r /tmp/dump.bin\n\n&quot;</span>, itself);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  # %s -r /tmp/dump.bin -t 0\n\n&quot;</span>, itself);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  # %s -p /tmp/dump.bin\n\n&quot;</span>, itself);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> init_param(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> ch = 0;</div>
<div class="line">    <span class="keywordtype">int</span> option_index = 0;</div>
<div class="line">    <span class="keywordtype">int</span> value = 0;</div>
<div class="line"> </div>
<div class="line">    opterr = 0;</div>
<div class="line">    <span class="keywordflow">while</span> ((ch = getopt_long(argc, argv, short_options, long_options, &amp;option_index)) != -1) {</div>
<div class="line">        <span class="keywordflow">switch</span> (ch) {</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:</div>
<div class="line">            value = strlen(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (value &gt;= FILENAME_LENGTH) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Filename [%s] is too long [%d] (&gt;%d).\n&quot;</span>, optarg, value,</div>
<div class="line">                    FILENAME_LENGTH);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            mode = DUMP_MODE;</div>
<div class="line">            snprintf(core_file, <span class="keyword">sizeof</span>(core_file), <span class="stringliteral">&quot;%s&quot;</span>, optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;r&#39;</span>:</div>
<div class="line">            value = strlen(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (value &gt;= FILENAME_LENGTH) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Filename [%s] is too long [%d] (&gt;%d).\n&quot;</span>, optarg, value,</div>
<div class="line">                    FILENAME_LENGTH);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            mode = RUN_MODE;</div>
<div class="line">            snprintf(core_file, <span class="keyword">sizeof</span>(core_file), <span class="stringliteral">&quot;%s&quot;</span>, optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>:</div>
<div class="line">            value = strlen(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (value &gt;= FILENAME_LENGTH) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Filename [%s] is too long [%d] (&gt;%d).\n&quot;</span>, optarg, value,</div>
<div class="line">                    FILENAME_LENGTH);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            mode = PARSER_MODE;</div>
<div class="line">            snprintf(core_file, <span class="keyword">sizeof</span>(core_file), <span class="stringliteral">&quot;%s&quot;</span>, optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>:</div>
<div class="line">            value = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (value == 0) {</div>
<div class="line">                iter_num = ~0;</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                iter_num = value;</div>
<div class="line">            }</div>
<div class="line">            printf(<span class="stringliteral">&quot;Iteration number [%u]\n&quot;</span>, iter_num);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            printf(<span class="stringliteral">&quot;unknown option found: %c\n&quot;</span>, ch);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> store_file(<span class="keyword">const</span> <span class="keywordtype">char</span> *file_name, uint8_t *virt_addr, uint32_t size)</div>
<div class="line">{</div>
<div class="line">    FILE *out = NULL;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        <span class="keywordflow">if</span> ((out = fopen(file_name, <span class="stringliteral">&quot;w+b&quot;</span>)) == NULL) {</div>
<div class="line">            perror(file_name);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* write payload */</span></div>
<div class="line">        <span class="keywordflow">if</span> (fwrite(virt_addr, 1, size, out) != size) {</div>
<div class="line">            perror(file_name);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">while</span> (0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (out) {</div>
<div class="line">        fclose(out);</div>
<div class="line">        out = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> store_file_with_header(<span class="keyword">const</span> <span class="keywordtype">char</span> *file_name, uint8_t *virt_addr, uint32_t size,</div>
<div class="line">    <span class="keywordtype">void</span> *header_virt, uint32_t header_size)</div>
<div class="line">{</div>
<div class="line">    FILE *out = NULL;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        <span class="keywordflow">if</span> ((out = fopen(file_name, <span class="stringliteral">&quot;w+b&quot;</span>)) == NULL) {</div>
<div class="line">            perror(file_name);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* write header */</span></div>
<div class="line">        <span class="keywordflow">if</span> (header_size) {</div>
<div class="line">            <span class="keywordflow">if</span> (fwrite(header_virt, 1, header_size, out) != header_size) {</div>
<div class="line">                perror(file_name);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* write payload */</span></div>
<div class="line">        <span class="keywordflow">if</span> (fwrite(virt_addr, 1, size, out) != size) {</div>
<div class="line">            perror(file_name);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">while</span> (0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (out) {</div>
<div class="line">        fclose(out);</div>
<div class="line">        out = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> load_file_with_header(<span class="keyword">const</span> <span class="keywordtype">char</span> *file_name, uint8_t *virt_addr, uint32_t size,</div>
<div class="line">    <span class="keywordtype">void</span> *header_virt, uint32_t header_size)</div>
<div class="line">{</div>
<div class="line">    FILE *in = NULL;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        <span class="keywordflow">if</span> ((in = fopen(file_name, <span class="stringliteral">&quot;rb&quot;</span>)) == NULL) {</div>
<div class="line">            perror(file_name);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (fseek(in, 0, SEEK_SET) &lt; 0) {</div>
<div class="line">            perror(<span class="stringliteral">&quot;fseek input file&quot;</span>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* read header */</span></div>
<div class="line">        <span class="keywordflow">if</span> (header_size) {</div>
<div class="line">            <span class="keywordflow">if</span> (fread(header_virt, 1, header_size, in) != header_size) {</div>
<div class="line">                perror(<span class="stringliteral">&quot;fread input file header&quot;</span>);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* read payload */</span></div>
<div class="line">        <span class="keywordflow">if</span> (fread(virt_addr, 1, size, in) != size) {</div>
<div class="line">            perror(<span class="stringliteral">&quot;fread input file&quot;</span>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">while</span> (0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (in) {</div>
<div class="line">        fclose(in);</div>
<div class="line">        in = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a id="a9" name="a9"></a><a class="code hl_functionRef" target="_blank" href="../../../library/db/db8/file__io_8h.html#afaf3af3799be8b7b8b626f21d3b70167">get_file_size</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *path)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>stat statbuff;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (stat(path, &amp;statbuff) &lt; 0) {</div>
<div class="line">        perror(path);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">return</span> statbuff.st_size;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *get_string_of_hw_type(uint32_t hw_type)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *str;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (hw_type) {</div>
<div class="line">    <span class="keywordflow">case</span> <a id="a10" name="a10"></a><a class="code hl_enumvalue" href="../../d6/d9f/group__cavalry-ioctl-helper.html#ggadd174e347f09635e745e274b41cbb9ecaef9efc930ed2ab63391603dff70363c7">CAVALRY_HW_TYPE_NVP</a>:</div>
<div class="line">        str = <span class="stringliteral">&quot;NVP&quot;</span>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <a id="a11" name="a11"></a><a class="code hl_enumvalue" href="../../d6/d9f/group__cavalry-ioctl-helper.html#ggadd174e347f09635e745e274b41cbb9eca99ac43062638dfdbdcd29b8676b7413e">CAVALRY_HW_TYPE_GVP</a>:</div>
<div class="line">        str = <span class="stringliteral">&quot;GVP&quot;</span>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <a id="a12" name="a12"></a><a class="code hl_enumvalue" href="../../d6/d9f/group__cavalry-ioctl-helper.html#ggadd174e347f09635e745e274b41cbb9eca2c19c02691219cab6f8a2c1fc682609f">CAVALRY_HW_TYPE_FEX</a>:</div>
<div class="line">        str = <span class="stringliteral">&quot;FEX&quot;</span>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <a id="a13" name="a13"></a><a class="code hl_enumvalue" href="../../d6/d9f/group__cavalry-ioctl-helper.html#ggadd174e347f09635e745e274b41cbb9eca22d1e6358fb44f3b161a3ec3f7789a84">CAVALRY_HW_TYPE_FMA</a>:</div>
<div class="line">        str = <span class="stringliteral">&quot;FMA&quot;</span>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">        str = <span class="stringliteral">&quot;Unknown_HW&quot;</span>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> str;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> show_core_header(<span class="keyword">struct</span> cavalry_core_dump_header *hdr)</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;Magic: 0x%x, API_Ver: %u, Chip: %u, HW Type: %u, HW ID: %u, Header Size: %lu\n&quot;</span>,</div>
<div class="line">        hdr-&gt;magic_num, hdr-&gt;api_version, hdr-&gt;chip_arch,</div>
<div class="line">        hdr-&gt;hw_type, hdr-&gt;hw_id, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> cavalry_core_dump_header));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> check_core_header(<span class="keyword">struct</span> cavalry_core_dump_header *hdr, uint32_t cv_chip_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (hdr-&gt;magic_num != CAVALRY_CORE_DUMP_MAGIC) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Cavalry core dump file Magic Number expect: 0x%x, but is 0x%x\n&quot;</span>,</div>
<div class="line">            CAVALRY_CORE_DUMP_MAGIC, hdr-&gt;magic_num);</div>
<div class="line">        rval = -1;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (hdr-&gt;api_version!= CAVALRY_CORE_DUMP_API) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Cavalry core dump file API Version expect: 0x%x, but is 0x%x\n&quot;</span>,</div>
<div class="line">            CAVALRY_CORE_DUMP_API, hdr-&gt;api_version);</div>
<div class="line">        rval = -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (hdr-&gt;chip_arch != cv_chip_id) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Cavalry core dump file Chip Arch expect: 0x%x, but is 0x%x\n&quot;</span>,</div>
<div class="line">            cv_chip_id, hdr-&gt;chip_arch);</div>
<div class="line">        rval = -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> clear_dag_desc_run_ctx(<span class="keyword">struct</span> <a id="_a14" name="_a14"></a><a class="code hl_struct" href="../../d7/d33/structcavalry__dag__desc.html">cavalry_dag_desc</a> *dag_desc)</div>
<div class="line">{</div>
<div class="line">    dag_desc-&gt;<a id="a15" name="a15"></a><a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#ab2011aacb9dc8bfc40a7b3c2235b9ff7">dep_cnt</a> = 0;</div>
<div class="line">    dag_desc-&gt;<a id="a16" name="a16"></a><a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#af96712cb89968223262e6e85ccb7541a">reverse_dep_dag_cnt</a> = 0;</div>
<div class="line">    memset((<span class="keywordtype">void</span> *)dag_desc-&gt;<a id="a17" name="a17"></a><a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#af162597d0b1ecf023a0f7c7815a13e38">reverse_dep_dag_id</a>, 0, <span class="keyword">sizeof</span>(dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#af162597d0b1ecf023a0f7c7815a13e38">reverse_dep_dag_id</a>));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> sigstop()</div>
<div class="line">{</div>
<div class="line">    live_flag = 0;</div>
<div class="line">    printf(<span class="stringliteral">&quot;sigstop msg\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a id="a18" name="a18"></a><a class="code hl_functionRef" target="_blank" href="../../../video/db/d1a/test__vout__cfg_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a id="_a19" name="_a19"></a><a class="code hl_struct" href="../../dc/d97/structcavalry__core__dump.html">cavalry_core_dump</a> core_dump;</div>
<div class="line">    uint8_t array[<a id="a20" name="a20"></a><a class="code hl_define" href="../../d6/d9f/group__cavalry-ioctl-helper.html#ga949511b53337ce20c0c1998d894421d6">RUN_DAG_SIZE</a>(1)];</div>
<div class="line">    <span class="keyword">struct </span><a id="_a21" name="_a21"></a><a class="code hl_structRef" target="_blank" href="../../../library/da/d07/structcavalry__run__dags.html">cavalry_run_dags</a> *run_dags = (<span class="keyword">struct </span><a class="code hl_structRef" target="_blank" href="../../../library/da/d07/structcavalry__run__dags.html">cavalry_run_dags</a> *)array;</div>
<div class="line">    <span class="keyword">struct </span><a class="code hl_struct" href="../../d7/d33/structcavalry__dag__desc.html">cavalry_dag_desc</a> *dag_desc = NULL;</div>
<div class="line">    <span class="keyword">struct </span><a id="_a22" name="_a22"></a><a class="code hl_struct" href="../../df/d99/structcavalry__poke__desc.html">cavalry_poke_desc</a> *poke_list = NULL;</div>
<div class="line">    <span class="keyword">struct </span>cavalry_core_dump_header core_hdr = {0};</div>
<div class="line">    <span class="keywordtype">char</span> fname[FILENAME_LENGTH];</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *hw_type_str = NULL;</div>
<div class="line">    <span class="keywordtype">void</span> *virt = NULL;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> phys_addr = 0;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> size = 0, dump_size = 0;</div>
<div class="line">    uint32_t i = 0, d = 0, hw_id = 0, cv_chip_id = 0;</div>
<div class="line">    uint32_t cnt = 0;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    signal(SIGINT, sigstop);</div>
<div class="line">    signal(SIGQUIT, sigstop);</div>
<div class="line">    signal(SIGTERM, sigstop);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (argc &lt; 2) {</div>
<div class="line">        usage();</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (init_param(argc, argv) &lt; 0) {</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    fd_cav = open(<a id="a23" name="a23"></a><a class="code hl_define" href="../../d6/d9f/group__cavalry-ioctl-helper.html#ga6fa217129c0f69ef5ab1f0099e3895ed">CAVALRY_DEV_NODE</a>, O_RDWR, 0);</div>
<div class="line">    <span class="keywordflow">if</span> (fd_cav &lt; 0) {</div>
<div class="line">        perror(<a class="code hl_define" href="../../d6/d9f/group__cavalry-ioctl-helper.html#ga6fa217129c0f69ef5ab1f0099e3895ed">CAVALRY_DEV_NODE</a>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    memset(&amp;core_dump, 0, <span class="keyword">sizeof</span>(core_dump));</div>
<div class="line">    <a id="a24" name="a24"></a><a class="code hl_functionRef" target="_blank" href="../../../library/d3/dbf/group__cavalry__mem-api-details.html#ga201938043385c5764ad3e2f4df21343d">cavalry_mem_init</a>(fd_cav, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ioctl(fd_cav, <a id="a25" name="a25"></a><a class="code hl_define" href="../../d9/d15/group__cavalry-ioctl-api.html#gab03741d7b26887f1b5ecb1757b3bd8d6">CAVALRY_GET_CV_CHIP_ID</a>, &amp;cv_chip_id) &lt; 0) {</div>
<div class="line">        perror(<span class="stringliteral">&quot;CAVALRY_GET_CV_CHIP_ID&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (mode == DUMP_MODE) {</div>
<div class="line">        <span class="keywordflow">if</span> (ioctl(fd_cav, <a id="a26" name="a26"></a><a class="code hl_define" href="../../d9/d15/group__cavalry-ioctl-api.html#gaababfc9a784bcbb82a6f7475ec86cefe">CAVALRY_QUERY_VP_CORE_DUMP</a>, &amp;core_dump) &lt; 0) {</div>
<div class="line">            perror(<span class="stringliteral">&quot;CAVALRY_QUERY_VP_CORE_DUMP&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; <a id="a27" name="a27"></a><a class="code hl_define" href="../../d6/d9f/group__cavalry-ioctl-helper.html#ga13b43786f64c722fb4d18eed105acd2b">CV_HW_TOTAL_NUM</a>; i++) {</div>
<div class="line">            hw_type_str = get_string_of_hw_type(core_dump.hw_core[i].hw_type);</div>
<div class="line">            hw_id = core_dump.hw_core[i].hw_id;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (core_dump.hw_core[i].is_hw_hang) {</div>
<div class="line">                virt = mmap(NULL, core_dump.hw_core[i].core_dump_size,</div>
<div class="line">                    PROT_WRITE, MAP_SHARED, fd_cav,</div>
<div class="line">                    core_dump.hw_core[i].core_dump_daddr);</div>
<div class="line">                dump_size = core_dump.hw_core[i].core_dump_size;</div>
<div class="line">                <span class="keywordflow">if</span> (virt == MAP_FAILED) {</div>
<div class="line">                    perror(<span class="stringliteral">&quot;mmap cavalry core dump mem err&quot;</span>);</div>
<div class="line">                    rval = -1;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                snprintf(write_core_file, <span class="keyword">sizeof</span>(write_core_file), <span class="stringliteral">&quot;%s_%s_%u.cavalry_core_dump&quot;</span>,</div>
<div class="line">                    core_file, hw_type_str, hw_id);</div>
<div class="line"> </div>
<div class="line">                core_hdr.magic_num = CAVALRY_CORE_DUMP_MAGIC;</div>
<div class="line">                core_hdr.api_version = CAVALRY_CORE_DUMP_API;</div>
<div class="line">                core_hdr.chip_arch = cv_chip_id;</div>
<div class="line">                core_hdr.hw_type = core_dump.hw_core[i].hw_type;</div>
<div class="line">                core_hdr.hw_id = hw_id;</div>
<div class="line">                store_file_with_header(write_core_file, virt, dump_size,</div>
<div class="line">                    (<span class="keywordtype">void</span> *)&amp;core_hdr, <span class="keyword">sizeof</span>(core_hdr));</div>
<div class="line">                munmap(virt, dump_size);</div>
<div class="line">                virt = NULL;</div>
<div class="line">                printf(<span class="stringliteral">&quot;HW %s:%u hang detected.\n&quot;</span>, hw_type_str, hw_id);</div>
<div class="line">                printf(<span class="stringliteral">&quot;HW %s:%u Core dump saved to file: %s.\n&quot;</span>,</div>
<div class="line">                    hw_type_str, hw_id, write_core_file);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                printf(<span class="stringliteral">&quot;HW %s:%u seems still alive.\n&quot;</span>, hw_type_str, hw_id);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (mode == RUN_MODE) {</div>
<div class="line">        <span class="keywordflow">do</span> {</div>
<div class="line">            size = <a class="code hl_functionRef" target="_blank" href="../../../library/db/db8/file__io_8h.html#afaf3af3799be8b7b8b626f21d3b70167">get_file_size</a>(core_file);</div>
<div class="line">            <span class="keywordflow">if</span> (!size) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Get file: %s size err\n&quot;</span>, core_file);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            rval = <a id="a28" name="a28"></a><a class="code hl_functionRef" target="_blank" href="../../../library/d3/dbf/group__cavalry__mem-api-details.html#ga78fe436b7764d49520410be725783432">cavalry_mem_alloc</a>(&amp;size, &amp;phys_addr, (<span class="keywordtype">void</span> **)(&amp;virt), 0);</div>
<div class="line">            <span class="keywordflow">if</span> (rval) {</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            memset(virt, 0, size);</div>
<div class="line">            dump_size = size - <span class="keyword">sizeof</span>(core_hdr);</div>
<div class="line">            load_file_with_header(core_file, virt, dump_size,</div>
<div class="line">                (<span class="keywordtype">void</span> *)&amp;core_hdr, <span class="keyword">sizeof</span>(core_hdr));</div>
<div class="line">            rval = check_core_header(&amp;core_hdr, cv_chip_id);</div>
<div class="line">            <span class="keywordflow">if</span> (rval) {</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            show_core_header(&amp;core_hdr);</div>
<div class="line">            run_dags = (<span class="keyword">struct </span><a class="code hl_structRef" target="_blank" href="../../../library/da/d07/structcavalry__run__dags.html">cavalry_run_dags</a> *)array;</div>
<div class="line">            memset((<span class="keywordtype">void</span> *)run_dags, 0, <span class="keyword">sizeof</span>(array));</div>
<div class="line"> </div>
<div class="line">            run_dags-&gt;dag_cnt = 1;</div>
<div class="line">            run_dags-&gt;hw_type = core_hdr.hw_type;</div>
<div class="line">            run_dags-&gt;affinity = <a id="a29" name="a29"></a><a class="code hl_define" href="../../d6/d9f/group__cavalry-ioctl-helper.html#gaad98570cceeaddddf328be529e4cdc00">CAVALRY_ANY_AFFINITY_MASK</a>;</div>
<div class="line">            memcpy((<span class="keywordtype">void</span> *)&amp;run_dags-&gt;dag_desc[0], virt, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="../../d7/d33/structcavalry__dag__desc.html">cavalry_dag_desc</a>));</div>
<div class="line"> </div>
<div class="line">            dag_desc = &amp;run_dags-&gt;dag_desc[0];</div>
<div class="line">            dag_desc-&gt;<a id="a30" name="a30"></a><a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#aa772396c4d572073fe4aa66a73f33d15">dvi_dram_addr</a> += phys_addr;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (i = 0; i &lt; dag_desc-&gt;<a id="a31" name="a31"></a><a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a5df4f9b1025ee2ada9c68fcd123f3bd6">port_cnt</a>; i++) {</div>
<div class="line">                dag_desc-&gt;<a id="a32" name="a32"></a><a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a8ba93fea81957ea8afce613ba94e7fd9">port_desc</a>[i].<a id="a33" name="a33"></a><a class="code hl_variable" href="../../d0/d20/structcavalry__port__desc.html#a1f62df1ad541f677e1475a4a607331b8">port_dram_addr</a> += phys_addr;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (dag_desc-&gt;<a id="a34" name="a34"></a><a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#afddbab4770b2c740c2dc5cc89e564d72">extra_poke_list_cnt</a>) {</div>
<div class="line">                dag_desc-&gt;<a id="a35" name="a35"></a><a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#af8e19fa0743d9df0785e79e4a82e8809">extra_poke_list_daddr</a> += phys_addr;</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">/* need memset zero for dag depedency when dag_cnt = 1 */</span></div>
<div class="line">            clear_dag_desc_run_ctx(dag_desc);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">while</span> (live_flag &amp;&amp; (cnt &lt; iter_num)) {</div>
<div class="line">                <span class="keywordflow">if</span> (ioctl(fd_cav, <a id="a36" name="a36"></a><a class="code hl_define" href="../../d9/d15/group__cavalry-ioctl-api.html#gab53efca72df9fd879305b8b6e48aeedf">CAVALRY_RUN_DAGS</a>, run_dags) &lt; 0) {</div>
<div class="line">                    perror(<span class="stringliteral">&quot;CAVALRY_RUN_DAGS&quot;</span>);</div>
<div class="line">                    rval = -1;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                cnt++;</div>
<div class="line">            }</div>
<div class="line">        }<span class="keywordflow">while</span> (0);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (virt) {</div>
<div class="line">            <a id="a37" name="a37"></a><a class="code hl_functionRef" target="_blank" href="../../../library/d3/dbf/group__cavalry__mem-api-details.html#gae80d26c23fcc3eb0f578f32647f90a7a">cavalry_mem_free</a>(size, phys_addr, (<span class="keywordtype">void</span> *)virt);</div>
<div class="line">            virt = NULL;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (mode == PARSER_MODE) {</div>
<div class="line">        <span class="keywordflow">do</span> {</div>
<div class="line">            size = <a class="code hl_functionRef" target="_blank" href="../../../library/db/db8/file__io_8h.html#afaf3af3799be8b7b8b626f21d3b70167">get_file_size</a>(core_file);</div>
<div class="line">            <span class="keywordflow">if</span> (!size) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Get file: %s size err\n&quot;</span>, core_file);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            virt = malloc(size);</div>
<div class="line">            <span class="keywordflow">if</span> (!virt) {</div>
<div class="line">                perror(<span class="stringliteral">&quot;malloc&quot;</span>);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            dump_size = size - <span class="keyword">sizeof</span>(core_hdr);</div>
<div class="line">            load_file_with_header(core_file, virt, dump_size,</div>
<div class="line">                (<span class="keywordtype">void</span> *)&amp;core_hdr, <span class="keyword">sizeof</span>(core_hdr));</div>
<div class="line">            rval = check_core_header(&amp;core_hdr, cv_chip_id);</div>
<div class="line">            <span class="keywordflow">if</span> (rval) {</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            show_core_header(&amp;core_hdr);</div>
<div class="line">            dag_desc = (<span class="keyword">struct </span><a class="code hl_struct" href="../../d7/d33/structcavalry__dag__desc.html">cavalry_dag_desc</a> *)virt;</div>
<div class="line"> </div>
<div class="line">            store_file(<span class="stringliteral">&quot;dag.dvi&quot;</span>,dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#aa772396c4d572073fe4aa66a73f33d15">dvi_dram_addr</a> + virt, dag_desc-&gt;<a id="a38" name="a38"></a><a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a5f64cfe6c326f51d206b92999a3aacb9">dvi_img_size</a>);</div>
<div class="line">            store_file(<span class="stringliteral">&quot;dag.bin&quot;</span>,dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#aa772396c4d572073fe4aa66a73f33d15">dvi_dram_addr</a> + virt + dag_desc-&gt;<a id="a39" name="a39"></a><a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a4e4d62779ae65e151e3acf94df442183">dvi_dag_vaddr</a> - dag_desc-&gt;<a id="a40" name="a40"></a><a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a87cad5ae236c2c9383abbe4348f398a1">dvi_img_vaddr</a>,</div>
<div class="line">                dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a5f64cfe6c326f51d206b92999a3aacb9">dvi_img_size</a> - (dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a4e4d62779ae65e151e3acf94df442183">dvi_dag_vaddr</a> - dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a87cad5ae236c2c9383abbe4348f398a1">dvi_img_vaddr</a>));</div>
<div class="line">            printf(<span class="stringliteral">&quot;[DAG desc] dag_loop_cnt: %u, dvi_dram_addr: 0x%lx, dvi_img_vaddr: 0x%x, dvi_img_size: %u, &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;dvi_dag_vaddr: 0x%x, dep_cnt: %u, port_cnt: %u, poke_cnt: %u, &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;extra_poke_list_cnt: %u, extra_poke_list_daddr: 0x%lx\n&quot;</span>,</div>
<div class="line">                dag_desc-&gt;<a id="a41" name="a41"></a><a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a063ea53ebe1f0af2371072c8ea87dca9">dag_loop_cnt</a>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#aa772396c4d572073fe4aa66a73f33d15">dvi_dram_addr</a>,</div>
<div class="line">                dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a87cad5ae236c2c9383abbe4348f398a1">dvi_img_vaddr</a>, dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a5f64cfe6c326f51d206b92999a3aacb9">dvi_img_size</a>, dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a4e4d62779ae65e151e3acf94df442183">dvi_dag_vaddr</a>,</div>
<div class="line">                dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#ab2011aacb9dc8bfc40a7b3c2235b9ff7">dep_cnt</a>, dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a5df4f9b1025ee2ada9c68fcd123f3bd6">port_cnt</a>, dag_desc-&gt;<a id="a42" name="a42"></a><a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#ad775ca9eb561dae6a774bbfe5ebcc58c">poke_cnt</a>,</div>
<div class="line">                dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#afddbab4770b2c740c2dc5cc89e564d72">extra_poke_list_cnt</a>, dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#af8e19fa0743d9df0785e79e4a82e8809">extra_poke_list_daddr</a>);</div>
<div class="line"> </div>
<div class="line">            printf(<span class="stringliteral">&quot;  Reverse_dep_dag cnt: %u, IDs: &quot;</span>, dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#af96712cb89968223262e6e85ccb7541a">reverse_dep_dag_cnt</a>);</div>
<div class="line">            <span class="keywordflow">for</span> (d = 0; d &lt; dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#af96712cb89968223262e6e85ccb7541a">reverse_dep_dag_cnt</a>; d++) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;%u, &quot;</span>, dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#af162597d0b1ecf023a0f7c7815a13e38">reverse_dep_dag_id</a>[d]);</div>
<div class="line">            }</div>
<div class="line">            printf(<span class="stringliteral">&quot; \n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (i = 0; i &lt; dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a5df4f9b1025ee2ada9c68fcd123f3bd6">port_cnt</a>; i++) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;  port [%u] port_dram_addr: 0x%lx, boffset: %u, dram_size: %lu, &quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;increment: %u\n&quot;</span>, i,</div>
<div class="line">                    (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a8ba93fea81957ea8afce613ba94e7fd9">port_desc</a>[i].<a class="code hl_variable" href="../../d0/d20/structcavalry__port__desc.html#a1f62df1ad541f677e1475a4a607331b8">port_dram_addr</a>,</div>
<div class="line">                    dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a8ba93fea81957ea8afce613ba94e7fd9">port_desc</a>[i].<a id="a43" name="a43"></a><a class="code hl_variable" href="../../d0/d20/structcavalry__port__desc.html#a6a8d1eee268c56ec3efe53a3f0947342">port_boffset_in_dag</a>,</div>
<div class="line">                    dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a8ba93fea81957ea8afce613ba94e7fd9">port_desc</a>[i].<a id="a44" name="a44"></a><a class="code hl_variable" href="../../d0/d20/structcavalry__port__desc.html#a2cdc0d4d97d575c44f08bf686c29025b">port_dram_size</a>,</div>
<div class="line">                    dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a8ba93fea81957ea8afce613ba94e7fd9">port_desc</a>[i].<a id="a45" name="a45"></a><a class="code hl_variable" href="../../d0/d20/structcavalry__port__desc.html#a7eeffcce15fcfd826f87e38f8e9c2354">port_daddr_increment</a>);</div>
<div class="line">                snprintf(fname, <span class="keyword">sizeof</span>(fname), <span class="stringliteral">&quot;port_%u.bin&quot;</span>, i);</div>
<div class="line">                store_file(fname, dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a8ba93fea81957ea8afce613ba94e7fd9">port_desc</a>[i].<a class="code hl_variable" href="../../d0/d20/structcavalry__port__desc.html#a1f62df1ad541f677e1475a4a607331b8">port_dram_addr</a> + virt,</div>
<div class="line">                    dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a8ba93fea81957ea8afce613ba94e7fd9">port_desc</a>[i].<a class="code hl_variable" href="../../d0/d20/structcavalry__port__desc.html#a2cdc0d4d97d575c44f08bf686c29025b">port_dram_size</a>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (i = 0; i &lt; dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#ad775ca9eb561dae6a774bbfe5ebcc58c">poke_cnt</a>; i++) {</div>
<div class="line">                poke_list = &amp;dag_desc-&gt;<a id="a46" name="a46"></a><a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a3125e3d03beccc33f4826e6cc6d715ab">poke_desc</a>[i];</div>
<div class="line">                printf(<span class="stringliteral">&quot;  poke [%u] poke_val: %u, poke_vaddr: 0x%x, poke_bsize: %u\n&quot;</span>,</div>
<div class="line">                    i, poke_list-&gt;<a id="a47" name="a47"></a><a class="code hl_variable" href="../../df/d99/structcavalry__poke__desc.html#a19bb2e1c333e1f3709295e0a7bbac014">poke_val</a>, poke_list-&gt;<a id="a48" name="a48"></a><a class="code hl_variable" href="../../df/d99/structcavalry__poke__desc.html#abc5e9da15d60da562e794a2c917a8b12">poke_vaddr</a>, poke_list-&gt;<a id="a49" name="a49"></a><a class="code hl_variable" href="../../df/d99/structcavalry__poke__desc.html#ab0a5661e3f8a632597cee61ea2a94d24">poke_bsize</a>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#ad775ca9eb561dae6a774bbfe5ebcc58c">poke_cnt</a>) {</div>
<div class="line">                snprintf(fname, <span class="keyword">sizeof</span>(fname), <span class="stringliteral">&quot;poke.bin&quot;</span>);</div>
<div class="line">                store_file(fname, (uint8_t *)&amp;dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#a3125e3d03beccc33f4826e6cc6d715ab">poke_desc</a>[0],</div>
<div class="line">                    dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#ad775ca9eb561dae6a774bbfe5ebcc58c">poke_cnt</a> * <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="../../df/d99/structcavalry__poke__desc.html">cavalry_poke_desc</a>));</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (i = 0; i &lt; dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#afddbab4770b2c740c2dc5cc89e564d72">extra_poke_list_cnt</a>; i++) {</div>
<div class="line">                poke_list = virt + dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#af8e19fa0743d9df0785e79e4a82e8809">extra_poke_list_daddr</a> +</div>
<div class="line">                    i * <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code hl_struct" href="../../df/d99/structcavalry__poke__desc.html">cavalry_poke_desc</a>);</div>
<div class="line">                printf(<span class="stringliteral">&quot;  extra poke [%u] poke_val: %u, poke_vaddr: 0x%x, poke_bsize: %u\n&quot;</span>,</div>
<div class="line">                    i, poke_list-&gt;<a class="code hl_variable" href="../../df/d99/structcavalry__poke__desc.html#a19bb2e1c333e1f3709295e0a7bbac014">poke_val</a>, poke_list-&gt;<a class="code hl_variable" href="../../df/d99/structcavalry__poke__desc.html#abc5e9da15d60da562e794a2c917a8b12">poke_vaddr</a>, poke_list-&gt;<a class="code hl_variable" href="../../df/d99/structcavalry__poke__desc.html#ab0a5661e3f8a632597cee61ea2a94d24">poke_bsize</a>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#afddbab4770b2c740c2dc5cc89e564d72">extra_poke_list_cnt</a>) {</div>
<div class="line">                snprintf(fname, <span class="keyword">sizeof</span>(fname), <span class="stringliteral">&quot;extra_poke.bin&quot;</span>);</div>
<div class="line">                store_file(fname, dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#af8e19fa0743d9df0785e79e4a82e8809">extra_poke_list_daddr</a> + virt,</div>
<div class="line">                    dag_desc-&gt;<a class="code hl_variable" href="../../d7/d33/structcavalry__dag__desc.html#afddbab4770b2c740c2dc5cc89e564d72">extra_poke_list_cnt</a> * <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="../../df/d99/structcavalry__poke__desc.html">cavalry_poke_desc</a>));</div>
<div class="line">            }</div>
<div class="line">        } <span class="keywordflow">while</span> (0);</div>
<div class="line">        <span class="keywordflow">if</span> (virt) {</div>
<div class="line">            free(virt);</div>
<div class="line">            virt = NULL;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="ttc" id="acavalry__ioctl_8h_html"><div class="ttname"><a href="../../d3/dbc/cavalry__ioctl_8h.html">cavalry_ioctl.h</a></div><div class="ttdoc">This file defines cavalry driver ioctl api.</div></div>
<div class="ttc" id="acavalry__mem_8h_html"><div class="ttname"><a href="../../../library/de/db0/cavalry__mem_8h.html">cavalry_mem.h</a></div></div>
<div class="ttc" id="afile__io_8h_html_afaf3af3799be8b7b8b626f21d3b70167"><div class="ttname"><a href="../../../library/db/db8/file__io_8h.html#afaf3af3799be8b7b8b626f21d3b70167">get_file_size</a></div><div class="ttdeci">unsigned int get_file_size(const char *filename)</div></div>
<div class="ttc" id="agroup__cavalry-ioctl-api_html_gaababfc9a784bcbb82a6f7475ec86cefe"><div class="ttname"><a href="../../d9/d15/group__cavalry-ioctl-api.html#gaababfc9a784bcbb82a6f7475ec86cefe">CAVALRY_QUERY_VP_CORE_DUMP</a></div><div class="ttdeci">#define CAVALRY_QUERY_VP_CORE_DUMP</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:1395</div></div>
<div class="ttc" id="agroup__cavalry-ioctl-api_html_gab03741d7b26887f1b5ecb1757b3bd8d6"><div class="ttname"><a href="../../d9/d15/group__cavalry-ioctl-api.html#gab03741d7b26887f1b5ecb1757b3bd8d6">CAVALRY_GET_CV_CHIP_ID</a></div><div class="ttdeci">#define CAVALRY_GET_CV_CHIP_ID</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:1541</div></div>
<div class="ttc" id="agroup__cavalry-ioctl-api_html_gab53efca72df9fd879305b8b6e48aeedf"><div class="ttname"><a href="../../d9/d15/group__cavalry-ioctl-api.html#gab53efca72df9fd879305b8b6e48aeedf">CAVALRY_RUN_DAGS</a></div><div class="ttdeci">#define CAVALRY_RUN_DAGS</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:1279</div></div>
<div class="ttc" id="agroup__cavalry-ioctl-helper_html_ga13b43786f64c722fb4d18eed105acd2b"><div class="ttname"><a href="../../d6/d9f/group__cavalry-ioctl-helper.html#ga13b43786f64c722fb4d18eed105acd2b">CV_HW_TOTAL_NUM</a></div><div class="ttdeci">#define CV_HW_TOTAL_NUM</div><div class="ttdoc">define port pitch alignment size for different chips .</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:81</div></div>
<div class="ttc" id="agroup__cavalry-ioctl-helper_html_ga6fa217129c0f69ef5ab1f0099e3895ed"><div class="ttname"><a href="../../d6/d9f/group__cavalry-ioctl-helper.html#ga6fa217129c0f69ef5ab1f0099e3895ed">CAVALRY_DEV_NODE</a></div><div class="ttdeci">#define CAVALRY_DEV_NODE</div><div class="ttdoc">define the device node when call open().</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:45</div></div>
<div class="ttc" id="agroup__cavalry-ioctl-helper_html_ga949511b53337ce20c0c1998d894421d6"><div class="ttname"><a href="../../d6/d9f/group__cavalry-ioctl-helper.html#ga949511b53337ce20c0c1998d894421d6">RUN_DAG_SIZE</a></div><div class="ttdeci">#define RUN_DAG_SIZE(x)</div><div class="ttdoc">define struct cavalry_run_dags size according to dag number.</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:501</div></div>
<div class="ttc" id="agroup__cavalry-ioctl-helper_html_gaad98570cceeaddddf328be529e4cdc00"><div class="ttname"><a href="../../d6/d9f/group__cavalry-ioctl-helper.html#gaad98570cceeaddddf328be529e4cdc00">CAVALRY_ANY_AFFINITY_MASK</a></div><div class="ttdeci">#define CAVALRY_ANY_AFFINITY_MASK</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:87</div></div>
<div class="ttc" id="agroup__cavalry-ioctl-helper_html_ggadd174e347f09635e745e274b41cbb9eca22d1e6358fb44f3b161a3ec3f7789a84"><div class="ttname"><a href="../../d6/d9f/group__cavalry-ioctl-helper.html#ggadd174e347f09635e745e274b41cbb9eca22d1e6358fb44f3b161a3ec3f7789a84">CAVALRY_HW_TYPE_FMA</a></div><div class="ttdeci">@ CAVALRY_HW_TYPE_FMA</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:1211</div></div>
<div class="ttc" id="agroup__cavalry-ioctl-helper_html_ggadd174e347f09635e745e274b41cbb9eca2c19c02691219cab6f8a2c1fc682609f"><div class="ttname"><a href="../../d6/d9f/group__cavalry-ioctl-helper.html#ggadd174e347f09635e745e274b41cbb9eca2c19c02691219cab6f8a2c1fc682609f">CAVALRY_HW_TYPE_FEX</a></div><div class="ttdeci">@ CAVALRY_HW_TYPE_FEX</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:1210</div></div>
<div class="ttc" id="agroup__cavalry-ioctl-helper_html_ggadd174e347f09635e745e274b41cbb9eca99ac43062638dfdbdcd29b8676b7413e"><div class="ttname"><a href="../../d6/d9f/group__cavalry-ioctl-helper.html#ggadd174e347f09635e745e274b41cbb9eca99ac43062638dfdbdcd29b8676b7413e">CAVALRY_HW_TYPE_GVP</a></div><div class="ttdeci">@ CAVALRY_HW_TYPE_GVP</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:1209</div></div>
<div class="ttc" id="agroup__cavalry-ioctl-helper_html_ggadd174e347f09635e745e274b41cbb9ecaef9efc930ed2ab63391603dff70363c7"><div class="ttname"><a href="../../d6/d9f/group__cavalry-ioctl-helper.html#ggadd174e347f09635e745e274b41cbb9ecaef9efc930ed2ab63391603dff70363c7">CAVALRY_HW_TYPE_NVP</a></div><div class="ttdeci">@ CAVALRY_HW_TYPE_NVP</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:1208</div></div>
<div class="ttc" id="agroup__cavalry__mem-api-details_html_ga201938043385c5764ad3e2f4df21343d"><div class="ttname"><a href="../../../library/d3/dbf/group__cavalry__mem-api-details.html#ga201938043385c5764ad3e2f4df21343d">cavalry_mem_init</a></div><div class="ttdeci">AMBA_API int cavalry_mem_init(IN int fd_cav, IN uint8_t verbose)</div></div>
<div class="ttc" id="agroup__cavalry__mem-api-details_html_ga78fe436b7764d49520410be725783432"><div class="ttname"><a href="../../../library/d3/dbf/group__cavalry__mem-api-details.html#ga78fe436b7764d49520410be725783432">cavalry_mem_alloc</a></div><div class="ttdeci">AMBA_API int cavalry_mem_alloc(IN unsigned long *psize, OUT unsigned long *pphys, OUT void **pvirt, IN uint8_t cache_en)</div></div>
<div class="ttc" id="agroup__cavalry__mem-api-details_html_gae80d26c23fcc3eb0f578f32647f90a7a"><div class="ttname"><a href="../../../library/d3/dbf/group__cavalry__mem-api-details.html#gae80d26c23fcc3eb0f578f32647f90a7a">cavalry_mem_free</a></div><div class="ttdeci">AMBA_API int cavalry_mem_free(IN unsigned long size, IN unsigned long phys, IN void *virt)</div></div>
<div class="ttc" id="astructcavalry__core__dump_html"><div class="ttname"><a href="../../dc/d97/structcavalry__core__dump.html">cavalry_core_dump</a></div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:948</div></div>
<div class="ttc" id="astructcavalry__dag__desc_html"><div class="ttname"><a href="../../d7/d33/structcavalry__dag__desc.html">cavalry_dag_desc</a></div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:299</div></div>
<div class="ttc" id="astructcavalry__dag__desc_html_a063ea53ebe1f0af2371072c8ea87dca9"><div class="ttname"><a href="../../d7/d33/structcavalry__dag__desc.html#a063ea53ebe1f0af2371072c8ea87dca9">cavalry_dag_desc::dag_loop_cnt</a></div><div class="ttdeci">uint32_t dag_loop_cnt</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:300</div></div>
<div class="ttc" id="astructcavalry__dag__desc_html_a3125e3d03beccc33f4826e6cc6d715ab"><div class="ttname"><a href="../../d7/d33/structcavalry__dag__desc.html#a3125e3d03beccc33f4826e6cc6d715ab">cavalry_dag_desc::poke_desc</a></div><div class="ttdeci">struct cavalry_poke_desc poke_desc[MAX_POKE_CNT]</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:320</div></div>
<div class="ttc" id="astructcavalry__dag__desc_html_a4e4d62779ae65e151e3acf94df442183"><div class="ttname"><a href="../../d7/d33/structcavalry__dag__desc.html#a4e4d62779ae65e151e3acf94df442183">cavalry_dag_desc::dvi_dag_vaddr</a></div><div class="ttdeci">uint32_t dvi_dag_vaddr</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:308</div></div>
<div class="ttc" id="astructcavalry__dag__desc_html_a5df4f9b1025ee2ada9c68fcd123f3bd6"><div class="ttname"><a href="../../d7/d33/structcavalry__dag__desc.html#a5df4f9b1025ee2ada9c68fcd123f3bd6">cavalry_dag_desc::port_cnt</a></div><div class="ttdeci">uint32_t port_cnt</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:312</div></div>
<div class="ttc" id="astructcavalry__dag__desc_html_a5f64cfe6c326f51d206b92999a3aacb9"><div class="ttname"><a href="../../d7/d33/structcavalry__dag__desc.html#a5f64cfe6c326f51d206b92999a3aacb9">cavalry_dag_desc::dvi_img_size</a></div><div class="ttdeci">uint32_t dvi_img_size</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:307</div></div>
<div class="ttc" id="astructcavalry__dag__desc_html_a87cad5ae236c2c9383abbe4348f398a1"><div class="ttname"><a href="../../d7/d33/structcavalry__dag__desc.html#a87cad5ae236c2c9383abbe4348f398a1">cavalry_dag_desc::dvi_img_vaddr</a></div><div class="ttdeci">uint32_t dvi_img_vaddr</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:306</div></div>
<div class="ttc" id="astructcavalry__dag__desc_html_a8ba93fea81957ea8afce613ba94e7fd9"><div class="ttname"><a href="../../d7/d33/structcavalry__dag__desc.html#a8ba93fea81957ea8afce613ba94e7fd9">cavalry_dag_desc::port_desc</a></div><div class="ttdeci">struct cavalry_port_desc port_desc[MAX_PORT_CNT]</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:319</div></div>
<div class="ttc" id="astructcavalry__dag__desc_html_aa772396c4d572073fe4aa66a73f33d15"><div class="ttname"><a href="../../d7/d33/structcavalry__dag__desc.html#aa772396c4d572073fe4aa66a73f33d15">cavalry_dag_desc::dvi_dram_addr</a></div><div class="ttdeci">cv_daddr_t dvi_dram_addr</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:305</div></div>
<div class="ttc" id="astructcavalry__dag__desc_html_ab2011aacb9dc8bfc40a7b3c2235b9ff7"><div class="ttname"><a href="../../d7/d33/structcavalry__dag__desc.html#ab2011aacb9dc8bfc40a7b3c2235b9ff7">cavalry_dag_desc::dep_cnt</a></div><div class="ttdeci">uint32_t dep_cnt</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:303</div></div>
<div class="ttc" id="astructcavalry__dag__desc_html_ad775ca9eb561dae6a774bbfe5ebcc58c"><div class="ttname"><a href="../../d7/d33/structcavalry__dag__desc.html#ad775ca9eb561dae6a774bbfe5ebcc58c">cavalry_dag_desc::poke_cnt</a></div><div class="ttdeci">uint32_t poke_cnt</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:313</div></div>
<div class="ttc" id="astructcavalry__dag__desc_html_af162597d0b1ecf023a0f7c7815a13e38"><div class="ttname"><a href="../../d7/d33/structcavalry__dag__desc.html#af162597d0b1ecf023a0f7c7815a13e38">cavalry_dag_desc::reverse_dep_dag_id</a></div><div class="ttdeci">uint16_t reverse_dep_dag_id[MAX_DEP_CNT]</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:318</div></div>
<div class="ttc" id="astructcavalry__dag__desc_html_af8e19fa0743d9df0785e79e4a82e8809"><div class="ttname"><a href="../../d7/d33/structcavalry__dag__desc.html#af8e19fa0743d9df0785e79e4a82e8809">cavalry_dag_desc::extra_poke_list_daddr</a></div><div class="ttdeci">cv_daddr_t extra_poke_list_daddr</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:315</div></div>
<div class="ttc" id="astructcavalry__dag__desc_html_af96712cb89968223262e6e85ccb7541a"><div class="ttname"><a href="../../d7/d33/structcavalry__dag__desc.html#af96712cb89968223262e6e85ccb7541a">cavalry_dag_desc::reverse_dep_dag_cnt</a></div><div class="ttdeci">uint32_t reverse_dep_dag_cnt</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:311</div></div>
<div class="ttc" id="astructcavalry__dag__desc_html_afddbab4770b2c740c2dc5cc89e564d72"><div class="ttname"><a href="../../d7/d33/structcavalry__dag__desc.html#afddbab4770b2c740c2dc5cc89e564d72">cavalry_dag_desc::extra_poke_list_cnt</a></div><div class="ttdeci">uint32_t extra_poke_list_cnt</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:314</div></div>
<div class="ttc" id="astructcavalry__poke__desc_html"><div class="ttname"><a href="../../df/d99/structcavalry__poke__desc.html">cavalry_poke_desc</a></div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:292</div></div>
<div class="ttc" id="astructcavalry__poke__desc_html_a19bb2e1c333e1f3709295e0a7bbac014"><div class="ttname"><a href="../../df/d99/structcavalry__poke__desc.html#a19bb2e1c333e1f3709295e0a7bbac014">cavalry_poke_desc::poke_val</a></div><div class="ttdeci">uint32_t poke_val</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:293</div></div>
<div class="ttc" id="astructcavalry__poke__desc_html_ab0a5661e3f8a632597cee61ea2a94d24"><div class="ttname"><a href="../../df/d99/structcavalry__poke__desc.html#ab0a5661e3f8a632597cee61ea2a94d24">cavalry_poke_desc::poke_bsize</a></div><div class="ttdeci">uint32_t poke_bsize</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:295</div></div>
<div class="ttc" id="astructcavalry__poke__desc_html_abc5e9da15d60da562e794a2c917a8b12"><div class="ttname"><a href="../../df/d99/structcavalry__poke__desc.html#abc5e9da15d60da562e794a2c917a8b12">cavalry_poke_desc::poke_vaddr</a></div><div class="ttdeci">uint32_t poke_vaddr</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:294</div></div>
<div class="ttc" id="astructcavalry__port__desc_html_a1f62df1ad541f677e1475a4a607331b8"><div class="ttname"><a href="../../d0/d20/structcavalry__port__desc.html#a1f62df1ad541f677e1475a4a607331b8">cavalry_port_desc::port_dram_addr</a></div><div class="ttdeci">cv_daddr_t port_dram_addr</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:283</div></div>
<div class="ttc" id="astructcavalry__port__desc_html_a2cdc0d4d97d575c44f08bf686c29025b"><div class="ttname"><a href="../../d0/d20/structcavalry__port__desc.html#a2cdc0d4d97d575c44f08bf686c29025b">cavalry_port_desc::port_dram_size</a></div><div class="ttdeci">unsigned long port_dram_size</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:286</div></div>
<div class="ttc" id="astructcavalry__port__desc_html_a6a8d1eee268c56ec3efe53a3f0947342"><div class="ttname"><a href="../../d0/d20/structcavalry__port__desc.html#a6a8d1eee268c56ec3efe53a3f0947342">cavalry_port_desc::port_boffset_in_dag</a></div><div class="ttdeci">uint32_t port_boffset_in_dag</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:287</div></div>
<div class="ttc" id="astructcavalry__port__desc_html_a7eeffcce15fcfd826f87e38f8e9c2354"><div class="ttname"><a href="../../d0/d20/structcavalry__port__desc.html#a7eeffcce15fcfd826f87e38f8e9c2354">cavalry_port_desc::port_daddr_increment</a></div><div class="ttdeci">int32_t port_daddr_increment</div><div class="ttdef"><b>Definition:</b> cavalry_ioctl.h:288</div></div>
<div class="ttc" id="astructcavalry__run__dags_html"><div class="ttname"><a href="../../../library/da/d07/structcavalry__run__dags.html">cavalry_run_dags</a></div></div>
<div class="ttc" id="astructhint__s_html"><div class="ttname"><a href="../../../video/d2/d4b/structhint__s.html">hint_s</a></div></div>
<div class="ttc" id="astructhint__s_html_a2799cca21c05a4f99f4c8b3b178d0133"><div class="ttname"><a href="../../../video/d2/d4b/structhint__s.html#a2799cca21c05a4f99f4c8b3b178d0133">hint_s::str</a></div><div class="ttdeci">const char * str</div></div>
<div class="ttc" id="astructhint__s_html_aa56a50443afd9d2f7cf738fb7ffba168"><div class="ttname"><a href="../../../video/d2/d4b/structhint__s.html#aa56a50443afd9d2f7cf738fb7ffba168">hint_s::arg</a></div><div class="ttdeci">const char * arg</div></div>
<div class="ttc" id="atest__fb_8h_html_affec572f11fcba59ce0cd49cbcd0110f"><div class="ttname"><a href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a></div><div class="ttdeci">#define HAS_ARG</div></div>
<div class="ttc" id="atest__vout__cfg_8c_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="../../../video/db/d1a/test__vout__cfg_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
