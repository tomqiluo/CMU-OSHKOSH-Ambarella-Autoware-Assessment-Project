<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>System: BASE - Rootfs</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="System"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-ambarella.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Ambarella.png"/></td>
  <td id="projectalign">
   <div id="projectname">System<span id="projectnumber">&#160;Cooper_1.6.0 (CV72 &amp; CV3) @ 2024.07.10 14:12:44</span>
   </div>
   <div id="projectbrief">placeholder</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.html','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('df/d7f/page_sysdoc_rootfs_doc.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">BASE - Rootfs </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="rootfs_doc_history"></a>
0. Revision History</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Version   </th><th class="markdownTableHeadLeft">Updated Date   </th><th class="markdownTableHeadLeft">Modification    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">1.0.0   </td><td class="markdownTableBodyLeft">20240116   </td><td class="markdownTableBodyLeft">Initial Version   </td></tr>
</table>
<hr  />
 <h1><a class="anchor" id="si_rootfs_doc_intro"></a>
1. Rootfs Introduction</h1>
<p >The Ambarella software development kit (SDK) can support various root file systems (rootfs) types. The following table lists the rootfs types supported by different SDK builds. The user can choose the right one according to the actual needs. </p><a class="anchor" id="si_rootfs_table"></a>
<table class="doxtable">
<caption>Table 1-1. Supported Rootfs Types.</caption>
<tr>
<th rowspan="2" align="center">Rootfs Type </th><th colspan="2" align="center">Cooper SDK </th><th colspan="1" align="center">CV2x SDK 3.0 </th><th rowspan="2" align="center">Description  </th></tr>
<tr>
<th align="center">Amba Build </th><th align="center">Yocto Build </th><th align="center">Amba Build  </th></tr>
<tr>
<th align="center">UBIFS </th><td align="center">✔</td><td align="center">✔</td><td align="center">✔ </td><td>Unsorted block image file system (UBIFS)  </td></tr>
<tr>
<th align="center">SQUASHFS </th><td align="center">✔</td><td align="center">✔</td><td align="center">✔ </td><td>A compressed read-only file system  </td></tr>
<tr>
<th align="center">JFFS2 </th><td align="center">✔</td><td align="center">✔</td><td align="center">✔ </td><td>Journaling flash file system version 2  </td></tr>
<tr>
<th align="center">YAFFS </th><td align="center">✘</td><td align="center">✘</td><td align="center">✔ </td><td>Yet another flash file system  </td></tr>
<tr>
<th align="center">EXT2 </th><td align="center">✘</td><td align="center">✔</td><td align="center">✔ </td><td>Second extended file system  </td></tr>
<tr>
<th align="center">EXT3 </th><td align="center">✘</td><td align="center">✔</td><td align="center">✔ </td><td>Third extended file system  </td></tr>
<tr>
<th align="center">EXT4 </th><td align="center">✔</td><td align="center">✔</td><td align="center">✔ </td><td>Fourth extended file system  </td></tr>
<tr>
<th align="center">RAMDISK </th><td align="center">✔</td><td align="center">✘</td><td align="center">✔ </td><td>RAM file system generated based on EXT2  </td></tr>
<tr>
<th align="center">CPIO </th><td align="center">✘</td><td align="center">✘</td><td align="center">✔ </td><td>RAM file system generated by CPIO utility  </td></tr>
<tr>
<td colspan="5" align="center">✔: Supported ✘: Not supported yet  </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="si_rootfs_build"></a>
2. Rootfs Guidance</h1>
<p >This chapter contains the following sections. If other rootfs types are used, the procedures are similar.</p><ul>
<li>Section <a class="el" href="../../df/d7f/page_sysdoc_rootfs_doc.html#si_ubifs_guide">2.1 UBIFS Guidance</a></li>
<li>Section <a class="el" href="../../df/d7f/page_sysdoc_rootfs_doc.html#si_ramdisk_guide">2.2 RAMDisk Guidance</a></li>
</ul>
<h2><a class="anchor" id="si_ubifs_guide"></a>
2.1 UBIFS Guidance</h2>
<p >UBIFS is a filesystem that works on top of unsorted block images (UBI) volumes which make it have the following features relative to other flash filesystems:</p><ul>
<li>UBI / UBIFS scales to large flash sizes better than JFFS2</li>
<li>Good fault tolerance, via a number of features</li>
<li>Built-in on-the-fly compression</li>
<li>Good runtime performance<br  />
</li>
</ul>
<p >For legacy firmware layout, the user can enable the UBIFS by performing the following steps (Take CV22_walnut as an example):</p><ol type="1">
<li>Allocate the "rootfs" partition size. <div class="fragment"><div class="line">build$ vim ambarella/boards/cv22_walnut/bsp/bsp.h</div>
<div class="line">...</div>
<div class="line">#define AMBOOT_LNX_SIZE     (192  * 1024 * 1024)</div>
<div class="line">...</div>
</div><!-- fragment --></li>
<li>Modify the <code>bootargs</code> in device trees (DTS) file for mounting the UBIFS. <div class="fragment"><div class="line">build$ vim ambarella/boards/cv22_walnut/bsp/cv22_walnut.dts</div>
<div class="line">bootargs = <span class="stringliteral">&quot;console=ttyS0 ubi.mtd=lnx root=ubi0:rootfs rw rootfstype=ubifs&quot;</span>;</div>
</div><!-- fragment --> The user can also set the bootargs in menuconfig which will replace the one set in DTS file.<ul>
<li>For CV2x SDK 3.0 Amba Build: <div class="fragment"><div class="line">build$ make cv22_ipcam_config</div>
<div class="line">build$ make menuconfig</div>
<div class="line">Ambarella Bootloader Configuration  ---&gt;</div>
<div class="line">  AMBoot Options  ---&gt;</div>
<div class="line">    Common Boot Options  ---&gt;</div>
<div class="line">      (console=ttyS0 ubi.mtd=lnx root=ubi0:rootfs rw rootfstype=ubifs) Booting cmdline</div>
</div><!-- fragment --></li>
<li>For Cooper SDK Amba Build: <div class="fragment"><div class="line">build$ make ipcam_config</div>
<div class="line">build$ make menuconfig</div>
<div class="line">boot  ---&gt;</div>
<div class="line">  [*] amboot (boot/ambamk)  ---&gt;</div>
<div class="line">    Ambarella Bootloader Configuration  ---&gt;</div>
<div class="line">      AMBoot Options  ---&gt;</div>
<div class="line">        Common Boot Options  ---&gt;</div>
<div class="line">          (console=ttyS0 ubi.mtd=lnx root=ubi0:rootfs rw rootfstype=ubifs) Booting cmdline</div>
</div><!-- fragment --></li>
<li>For Cooper SDK Yocto Build: <div class="fragment"><div class="line">build$ make ipcam_config</div>
<div class="line">build$ make menuconfig</div>
<div class="line">meta-ambabsp  ---&gt;</div>
<div class="line">  recipes-bsp  ---&gt;</div>
<div class="line">    [*] amboot (meta-ambabsp/recipes-bsp/boot)  ---&gt;</div>
<div class="line">      Ambarella Bootloader Configuration  ---&gt;</div>
<div class="line">        AMBoot Options  ---&gt;</div>
<div class="line">          Common Boot Options  ---&gt;</div>
<div class="line">            (console=ttyS0 ubi.mtd=lnx root=ubi0:rootfs rw rootfstype=ubifs) Booting cmdline</div>
</div><!-- fragment --></li>
</ul>
</li>
<li>Select the UBIFS in menuconfig.<ul>
<li>For CV2x SDK 3.0 Amba Build: <div class="fragment"><div class="line">build$ make menuconfig</div>
<div class="line">Ambarella Bootloader Configuration  ---&gt;</div>
<div class="line">   Firmware Options  ---&gt;</div>
<div class="line">     Linux Partition  ---&gt;</div>
<div class="line">       ($(AMB_BOARD_OUT)/rootfs/ubifs) Linux FS image</div>
<div class="line">       ($(AMB_TOPDIR)/amboot/vif/ubifs.info) Linux FS Version File</div>
<div class="line">[*] Ambarella File System Configuration  ---&gt;</div>
<div class="line">  Linux Root File System (UBIFS)  ---&gt;</div>
<div class="line">    (X) UBIFS</div>
</div><!-- fragment --></li>
<li>For Cooper SDK Amba Build: <div class="fragment"><div class="line">build$ make menuconfig</div>
<div class="line">  boot  ---&gt;</div>
<div class="line">    [ ] ambfw (boot/ambamk)  ----</div>
<div class="line">    [*] amboot (boot/ambamk)  ---&gt;</div>
<div class="line">      Ambarella Bootloader Configuration  ---&gt;</div>
<div class="line">        Firmware Options  ---&gt;</div>
<div class="line">          Firmware Layout Style (Legacy Firmware Layout)  ---&gt;</div>
<div class="line">            (X) Legacy Firmware Layout</div>
<div class="line">          Linux Partition  ---&gt;</div>
<div class="line">            ($(ENV_IMG_ROOT)/rootfs.bin) Linux FS image</div>
<div class="line">            ($(AMBOOT_TOPDIR)/vif/ubifs.info) Linux FS Version File</div>
<div class="line">  rootfs  ---&gt;</div>
<div class="line">    [*]   rootfs (rootfs/system)  ---&gt;</div>
<div class="line">      Linux Root File System (UBIFS)  ---&gt;</div>
<div class="line">        (X) UBIFS</div>
</div><!-- fragment --></li>
<li>For Cooper SDK Yocto Build: <div class="fragment"><div class="line">build$ make menuconfig</div>
<div class="line">meta-ambabsp  ---&gt;</div>
<div class="line">  recipes-bsp  ---&gt;</div>
<div class="line">    [ ] ambfw (meta-ambabsp/recipes-bsp/boot)  ---</div>
<div class="line">    [*] amboot (meta-ambabsp/recipes-bsp/boot)  ---&gt;</div>
<div class="line">      Ambarella Bootloader Configuration  ---&gt;</div>
<div class="line">        Firmware Options  ---&gt;</div>
<div class="line">          Firmware Layout Style (Legacy Firmware Layout)  ---&gt;</div>
<div class="line">            (X) Legacy Firmware Layout</div>
<div class="line">          ROMFS Partition  ---&gt;</div>
<div class="line">            ($(ENV_IMG_ROOT)/rootfs.bin)  Romfs image</div>
<div class="line">            ($(AMBOOT_TOPDIR)/vif/ubifs.info) ROMFS Version File</div>
<div class="line">    [*] amrootfs (meta-ambabsp/recipes-bsp/amrootfs)  ---&gt;</div>
<div class="line">      Linux Root File System (UBIFS)  ---&gt;</div>
<div class="line">        (X) UBIFS</div>
</div><!-- fragment --></li>
</ul>
</li>
<li>Add UBIFS and memory technology device (MTD) block device support in the kernel.<br  />
 <div class="fragment"><div class="line">build$ make menuconfig_public_linux  <span class="comment">// for CV2x SDK 3.0 Amba build</span></div>
<div class="line">or</div>
<div class="line">build$ make linux_menuconfig         <span class="comment">// for Cooper SDK</span></div>
<div class="line">Device Drivers  ---&gt;</div>
<div class="line">  &lt;*&gt; Memory Technology Device (MTD) support  ---&gt;</div>
<div class="line">    &lt;*&gt;   Enable UBI - Unsorted block images  ---&gt;</div>
<div class="line">      (4096) UBI wear-leveling threshold</div>
<div class="line">      (20)  Maximum expected bad eraseblock <a class="code hl_variableRef" target="_blank" href="../../../library/d1/d82/cJSON_8h.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a> per 1024 eraseblocks</div>
<div class="line">File systems  ---&gt;</div>
<div class="line">  [*] Miscellaneous filesystems  ---&gt;</div>
<div class="line">    &lt;*&gt;   UBIFS file system support</div>
<div class="line">    [*]     Advanced compression options</div>
<div class="line">    [*]       LZO compression support</div>
<div class="line">    [*]       ZLIB compression support</div>
<div class="line">    [*]       ZSTD compression support</div>
<div class="line">    [*]     UBIFS XATTR support</div>
<div class="line">    [*]       UBIFS Security Labels</div>
<div class="ttc" id="acJSON_8h_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="../../../library/d1/d82/cJSON_8h.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a></div><div class="ttdeci">int count</div></div>
</div><!-- fragment --></li>
<li>Build the firmware.<ul>
<li>For CV2x SDK 3.0: <div class="fragment"><div class="line">build $ make -j8</div>
</div><!-- fragment --> The generated firmware: <code>ambarella/out/&lt;board_name&gt;/images/bst_bld_kernel_lnx_release.elf</code></li>
<li>For Cooper SDK: <div class="fragment"><div class="line">build $ make</div>
</div><!-- fragment --> The generated firmware: <code>ambarella/out/&lt;amba|yocto&gt;_out/&lt;board_name&gt;/firmware/bst_bld_kernel_lnx_release.elf</code></li>
</ul>
</li>
</ol>
<h2><a class="anchor" id="si_ramdisk_guide"></a>
2.2 RAMDisk Guidance</h2>
<p >RAMDisk file system is a virtual storage location created out of the system memory. All read and write requests to RAMdisk file system are processed in memory, resulting in a huge improvement in overall performance with ultra-fast speed and ultra-low latency.<br  />
</p>
<p >For flexible firmware layout, the user can enable the RAMDisk by performing the following steps (using CV72_gage as an example):</p><ol type="1">
<li>Allocate the "ramdisk" partition size. <div class="fragment"><div class="line"><span class="preprocessor">#define AMBOOT_PARTITION_LAYOUT \</span></div>
<div class="line"><span class="preprocessor">        MEDIA_DEV \</span></div>
<div class="line"><span class="preprocessor">        &quot;128k(bst),1024k(bld),896k(dtb),896k(env),128k(cfg),&quot;</span> \</div>
<div class="line">        &quot;32m@0x1300000(kernel),192m(ramdisk),-(raw)&quot;</div>
</div><!-- fragment --></li>
<li>Select the RAMDisk file system and configure it. <div class="fragment"><div class="line">build $ make menuconfig</div>
<div class="line">  rootfs ---&gt;</div>
<div class="line">    rootfs (rootfs/system) ---&gt;</div>
<div class="line">      Linux Root File System (Ramdisk) ---&gt;</div>
<div class="line">        (X) Ramdisk</div>
<div class="line">      [*]   Compress RAM disk              <span class="comment">// Compress the RAM disk to save size</span></div>
<div class="line">      (204800) Ambarella RootFS Size (KB)  <span class="comment">// 204800 (200M) relates to RAMDisk size if not compressed</span></div>
<div class="line">      (3500) Ambarella RootFS inodes number</div>
</div><!-- fragment --></li>
<li>Modify the <code>bootargs</code> and configure the initial ramdisk start address.<br  />
<ul>
<li>Use menuconfig to set the initrd start address. <div class="fragment"><div class="line">build $ make menuconfig</div>
<div class="line">  boot  ---&gt;</div>
<div class="line">    [*] amboot (boot/ambamk)  ---&gt;</div>
<div class="line">      Ambarella Bootloader Configuration  ---&gt;</div>
<div class="line">        Memory Options  ---&gt;</div>
<div class="line">          (0x10000000) Initrd start address</div>
</div><!-- fragment --></li>
<li>Modify the bootargs in <code>ambarella/boards/&lt;board_name&gt;/bsp/&lt;board_name&gt;.dts</code> <div class="fragment"><div class="line">bootargs = <span class="stringliteral">&quot;console=ttyS0 initrd=0x10000000,200M root=/dev/ram rw rootfs=ramfs earlycon pci=nomsi&quot;</span>;</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The "Kernel start address" and the "Initrd start address" must be set properly in case the kernel image overlaps with the rootfs image, which could cause the kernel to fail to boot.</dd></dl>
</li>
</ul>
</li>
<li>Add RAMDisk to the firmware.<ul>
<li>Create a <code>ambarella/boards/&lt;board_name&gt;/bsp/profile.ramdisk</code> for firmware layout. <div class="fragment"><div class="line">IMAGE_FWPROG    := $(BIN_DIR)/fwp.bin</div>
<div class="line"> </div>
<div class="line">IMAGE_0_NAME    := bst</div>
<div class="line">IMAGE_0_FILE    := $(BIN_DIR)/bst.bin</div>
<div class="line">IMAGE_0_ADDR    := -1</div>
<div class="line">IMAGE_0_FLAG    := force <a class="code hl_variableRef" target="_blank" href="../../../library/d1/d82/cJSON_8h.html#a788db922597cf2fb6389e278f822e59f">raw</a></div>
<div class="line"> </div>
<div class="line">IMAGE_1_NAME    := bld</div>
<div class="line">IMAGE_1_FILE    := $(BIN_DIR)/bld.bin</div>
<div class="line">IMAGE_1_ADDR    := -1</div>
<div class="line">IMAGE_1_FLAG    := force <a class="code hl_variableRef" target="_blank" href="../../../library/d1/d82/cJSON_8h.html#a788db922597cf2fb6389e278f822e59f">raw</a></div>
<div class="line"> </div>
<div class="line">IMAGE_2_NAME    := env</div>
<div class="line">IMAGE_2_FILE    := $(BIN_DIR)/env.bin</div>
<div class="line">IMAGE_2_ADDR    := -1</div>
<div class="line">IMAGE_2_FLAG    := force</div>
<div class="line"> </div>
<div class="line">IMAGE_3_NAME    := dtb</div>
<div class="line">IMAGE_3_FILE    := $(BIN_DIR)/dtb.bin</div>
<div class="line">IMAGE_3_ADDR    := -1</div>
<div class="line">IMAGE_3_FLAG    := force</div>
<div class="line"> </div>
<div class="line">IMAGE_4_NAME    := kernel</div>
<div class="line">IMAGE_4_FILE    := $(BIN_DIR)/kernel.bin</div>
<div class="line">IMAGE_4_ADDR    := $(KERNEL_RAM_START)</div>
<div class="line">IMAGE_4_FLAG    := verify compressed</div>
<div class="line"> </div>
<div class="line">IMAGE_5_NAME    := ramdisk</div>
<div class="line">IMAGE_5_FILE    := $(BIN_DIR)/rootfs.bin</div>
<div class="line">IMAGE_5_ADDR    := $(CONFIG_INITRD_PHYS)</div>
<div class="line">IMAGE_5_FLAG    := verify</div>
<div class="ttc" id="acJSON_8h_html_a788db922597cf2fb6389e278f822e59f"><div class="ttname"><a href="../../../library/d1/d82/cJSON_8h.html#a788db922597cf2fb6389e278f822e59f">raw</a></div><div class="ttdeci">const char *const const char *const raw</div></div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The "IMAGE_5_FLAG" for <code>ramdisk</code> must not be set to "raw". Because before the ramdisk image is loaded into the dynamic random access memory (DRAM), the bootloader will first check the ramdisk image's header which is excluded in the raw image.</dd></dl>
</li>
<li>Create a DTS file <code>ambarella/boards/&lt;board_name&gt;/bsp/&lt;board_name&gt;.env</code> for firmware layout. <div class="fragment"><div class="line">/dts-v1/;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;config.h&quot;</span></div>
<div class="line"> </div>
<div class="line">/ {</div>
<div class="line">    compatible = <span class="stringliteral">&quot;ambarella,environment&quot;</span>;</div>
<div class="line"><span class="preprocessor">    #address-cells = &lt;1&gt;;</span></div>
<div class="line"><span class="preprocessor">    #size-cells = &lt;1&gt;;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#if defined(AMBOOT_DEV_AUTO_BOOT)</span></div>
<div class="line">    auto_boot;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">    serial_num = AMBOOT_DEFAULT_SN;</div>
<div class="line"> </div>
<div class="line">    bootcmd = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    bootargs = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    kernel_meta {</div>
<div class="line">        partition = <span class="stringliteral">&quot;kernel&quot;</span>;</div>
<div class="line">        binary_id = &lt;0&gt;;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    dtb_meta {</div>
<div class="line">        partition = <span class="stringliteral">&quot;dtb&quot;</span>;</div>
<div class="line">        binary_id = &lt;0&gt;;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    ramdisk_meta {</div>
<div class="line">        partition = <span class="stringliteral">&quot;ramdisk&quot;</span>;</div>
<div class="line">        binary_id = &lt;0&gt;;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    netdev_eth0 {</div>
<div class="line">        mac = <span class="stringliteral">&quot;00:00:00:00:00:00&quot;</span>;</div>
<div class="line">        mask = <span class="stringliteral">&quot;0.0.0.0&quot;</span>;</div>
<div class="line">        gw = <span class="stringliteral">&quot;0.0.0.0&quot;</span>;</div>
<div class="line">        ip = <span class="stringliteral">&quot;0.0.0.0&quot;</span>;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    tftpd {</div>
<div class="line">        server,ip = <span class="stringliteral">&quot;0.0.0.0&quot;</span>;</div>
<div class="line">        kernel,file = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">        kernel,addr = &lt;0x00000000&gt;;</div>
<div class="line">        ramdisk,file = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">        ramdisk,addr = &lt;0x00000000&gt;;</div>
<div class="line">    };</div>
<div class="line">};</div>
</div><!-- fragment --></li>
<li>Enable the profile in menuconfig. <div class="fragment"><div class="line">build $ make menuconfig</div>
<div class="line">boot  ---&gt;</div>
<div class="line">  [*] ambfw (boot/ambamk)  ---&gt;</div>
<div class="line">    AMBFW Configuration  ---&gt;</div>
<div class="line">      [*] Build AMBFW</div>
<div class="line">      (profile.ramdisk) Firmware Profile</div>
<div class="line">  [*] amboot (boot/ambamk)  ---&gt;</div>
<div class="line">    Ambarella Bootloader Configuration  ---&gt;</div>
<div class="line">      Firmware Options  ---&gt;</div>
<div class="line">        Firmware Layout Style (Flexible Firmware Layout)  ---&gt;</div>
<div class="line">          (X) Flexible Firmware Layout</div>
</div><!-- fragment --></li>
</ul>
</li>
<li>Enable RAMDisk and RAM block device support in the kernel. <div class="fragment"><div class="line">build $ make linux_menuconfig</div>
<div class="line">    General set up ---&gt;</div>
<div class="line">      [*] Initial RAM filesystem and RAM disk (initramfs/initrd) support</div>
<div class="line">    File system ---&gt;</div>
<div class="line">      &lt;*&gt; Second extended fs support</div>
<div class="line">    Device Drivers ---&gt;</div>
<div class="line">      [*] Block devices ---&gt;</div>
<div class="line">         &lt;*&gt; RAM block device support</div>
<div class="line">         (204800) Default RAM disk size (kbytes)  <span class="comment">// 204800 (200M) relates to RAMDisk size</span></div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>During the ramdisk booting stage, if there are some errors related to the "incomplete write (xxx != xxx)", the user can enlarge the ramdisk size by adding "ramdisk_size=0x8000000" to bootargs or enlarging the RAM disk size in kernel, and then have a try.</dd></dl>
</li>
<li>Build and burn the firmware. <div class="fragment"><div class="line">build $ make</div>
</div><!-- fragment --> The generated firmware: <code>ambarella/out/amba_out/&lt;board_name&gt;/firmware/bst_bld_env_dtb_kernel_ramdisk.elf</code></li>
</ol>
<hr  />
 <h1><a class="anchor" id="si_rootfs_doc_license"></a>
3. License</h1>
<p >Copyright (c) 2024 Ambarella International LP.</p>
<p >This file and its contents ( "Software" ) are protected by intellectual property rights including, without limitation, U.S. and/or foreign copyrights. This Software is also the confidential and proprietary information of Ambarella International LP and its licensors. You may not use, reproduce, disclose, distribute, modify, or otherwise prepare derivative works of this Software or any portion thereof except pursuant to a signed license agreement or nondisclosure agreement with Ambarella International LP or its authorized affiliates. In the absence of such an agreement, you agree to promptly notify and return this Software to Ambarella International LP.</p>
<p >THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT, MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL AMBARELLA INTERNATIONAL LP OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
