<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>System: DEBUG - FAQ</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="System"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-ambarella.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Ambarella.png"/></td>
  <td id="projectalign">
   <div id="projectname">System<span id="projectnumber">&#160;Cooper_1.6.0 (CV72 &amp; CV3) @ 2024.07.10 14:12:44</span>
   </div>
   <div id="projectbrief">placeholder</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.html','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d3/df5/page_sys_faq_doc.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">DEBUG - FAQ </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="faq_choosing_the_appropriate_chip"></a>
1. Choosing the Appropriate Chip</h1>
<p >Choosing an appropriate chip depends on the following: encoding specifications, encode mode, double data rate (DDR) bandwidth, and DDR size. This section lists the specifications required for each to enable users to choose the appropriate chip(s) for their applications.</p><ul>
<li>Encoding specifications<br  />
 Please check the specification from release note document.</li>
<li>Encode mode<br  />
 It is important to ensure that the feature wanted is supported in current encode mode.<br  />
 For details, refer to <a class="elRef" target="_blank" href="../../../video/df/d92/fs_adv_enc_mode.html">ADVANCED - Encode Mode</a>.</li>
<li>DDR bandwidth<br  />
 DDR bandwidth is an important resource that users care a lot about. Dynamic random access memory (DRAM) bandwidth statistics tool could be useful when profiling bandwidth usage. Please check fs_others_dram_statistics for the usage of the tool.</li>
<li>DDR size<br  />
 DDR memory is divided into three partitions: Linux, image audio video (IAV), and digital signal processor (DSP). The Linux partition is used to run the operating system and the user program; the IAV partition is used for the interaction between the DSP and IAV; and the DSP partition is reserved for the DSP's internal usage.<br  />
 Currently, users can perform their own optimization. For details, refer to the Ambarella CV5x DG Flexible Linux SDK DRAM Optimization document.<br  />
 For the DSP partition, users can decide the size according to the specification. After they decide the size, users should check the minimum DSP memory with the user case; for example, use test commands.<br  />
 Additionally, users can modify the IAV partition using the "make menuconfig" command with the requirement.<br  />
 The following commands can be used to check the DSP RAM cost when the case is running: <div class="fragment"><div class="line"><span class="preprocessor"># dmesg | grep handle_dsp_cfg_msg</span></div>
<div class="line">[ 2762.614016] handle_dsp_cfg_msg(130): DSP DRAM Used: 392 <a class="code hl_defineRef" target="_blank" href="../../../driver/d6/d56/iav__utils_8h.html#aa6b38d492364d98453284934ed7caee9">MB</a></div>
<div class="ttc" id="aiav__utils_8h_html_aa6b38d492364d98453284934ed7caee9"><div class="ttname"><a href="../../../driver/d6/d56/iav__utils_8h.html#aa6b38d492364d98453284934ed7caee9">MB</a></div><div class="ttdeci">#define MB</div></div>
</div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="faq_system_change"></a>
2. System Change</h1>
<p >Ambarella performs several tests to determine the chip clocks for various part numbers. Therefore, to ensure stable encoding, Ambarella does not include APIs to change the clocks and recommends users not attempt to change them. Instead, Ambarella recommends users to choose a real part number with "Board-&gt; Board Revision" in "make menuconfig" to ensure that the system clock is configured correctly.</p>
<h1><a class="anchor" id="faq_how_to_obtain_audio_data"></a>
3. How to Obtain Audio Data</h1>
<p >In the user space, there are two interfaces for obtaining the PCM audio data: ALSA or PulseAudio. Although pulse audio provides a strong and rich interface, it requires more DRAM bandwidth and CPU.<br  />
 For ALSA, refer to the ALSA sample code for audio applications:<br  />
 <code>ambarella\unit_test\linux\audio\test_audio.cpp</code> or<br  />
 <code>ambarella\app\cloud\media_mw\src\audio_platform\linux_alsa\audio_alsa.cpp</code>.<br  />
 For pulse audio, users can refer to the following:<br  />
 <code>ambarella\app\cloud\media_mw\src\audio_platform\pulse_audio\pulse_audio.cpp</code> or<br  />
 <code>ambarella\oryx_v2\base\audio\device\am_audio_device_pulse.cpp</code>.</p>
<h1><a class="anchor" id="faq_full_duplex_communication_for_audio"></a>
4. Full Duplex Communication For Audio</h1>
<p >The I2S interface supports two-way voice data transmission; its core task is to achieve echo cancellation. Hardware and software methods can be used for echo cancellation:</p><ul>
<li>For hardware, usersâ€™ audio code should support echo cancellation, such as AK7755. Alternatively, users can add DSP for echo cancellation between audio CODEC and the master control chip, such as AK4951 + AK7719.</li>
<li>For software, users can try AEC of pulse audio in the SDK, which must run Oryx.</li>
</ul>
<h1><a class="anchor" id="faq_flash_usage"></a>
5 Flash Usage</h1>
<h2><a class="anchor" id="faq_flash_type"></a>
5.1 Type Confirm</h2>
<p >Before selecting a flash, first check if the flash is supported by the Ambarella SDK: </p><div class="fragment"><div class="line">make menuconfig</div>
<div class="line">  -*-Ambarella Boot Configuration ---&gt;</div>
<div class="line">       Amboot Configuration ---&gt;</div>
<div class="line">         Hardware Options  ---&gt;</div>
<div class="line">           [*] Support NAND Driver  ---&gt;</div>
<div class="line">              Nand Flash Type (P2K_E128K)  ---&gt;</div>
</div><!-- fragment --><p> Once the support is confirmed, choose the correct type and compile.</p>
<h2><a class="anchor" id="faq_flash_ecc"></a>
5.2 ECC Confirm</h2>
<p >Because incorrect ECC bits may lead to serious problems, users must first confirm and check the ECC so that ECC configuration errors do not occur in the mass production.<br  />
 The CV5x chip includes a hardware ECC function and supports 1/6/8 bit ECC. In the hardware design, first confirm that the ECC bits exist in the flash specification, and then configure the corresponding hardware POC for EVK as shown below. </p><div class="fragment"><div class="line">POC (15, 16) (VD0_OUT15, I2S0_SO):</div>
<div class="line">ECC level: [15 16], 1-bit = 00</div>
<div class="line">ECC level: [15 16], 6-bit = 01</div>
<div class="line">ECC level: [15 16], 8-bit = 11</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>If users want to support the 8-bit mode, then the flash page NAND size should be (2K+128). For more information, refer to the section on the ECC level in <a class="elRef" target="_blank" href="../../../peripherals/dc/dac/si_nand.html">NAND</a>.</dd></dl>
<h2><a class="anchor" id="faq_flash_format_level"></a>
5.3 File System Format and ECC Level</h2>
<p >For different page sizes, the number of ECC bytes generated by different ECC levels and its layout is in out of band (OOB). For the code, refer to the structure nand_ecclayout in <code>ambarella\kernel\linux-5.4\drivers\mtd\nand\ambarella_nand.c</code>.<br  />
 If the unsorted block image file system (UBIFS) are used, OOB stores only bad block markers and ECC data. In this case, as long as OOB has sufficient size to store ECC which is defined by flash specification, then flash can use UBIFS. If YAFFS2 are used, OOB includes file systems with information relating to YAFFS2, which are required for various storage purposes. Therefore, the OOB size must be large enough to store both ECC and YAFFS tags.<br  />
 The following lists the requirements:<br  />
 </p><div class="fragment"><div class="line">Chunks: 1<a class="code hl_defineRef" target="_blank" href="../../../driver/d6/d56/iav__utils_8h.html#a1841fd1a462d245d8c73dce55e2f45da">KB</a> 30 Bytes</div>
<div class="line">Chunks: 2kB 42 Bytes</div>
<div class="ttc" id="aiav__utils_8h_html_a1841fd1a462d245d8c73dce55e2f45da"><div class="ttname"><a href="../../../driver/d6/d56/iav__utils_8h.html#a1841fd1a462d245d8c73dce55e2f45da">KB</a></div><div class="ttdeci">#define KB</div></div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>If the OOB size is insufficient, it cannot support YAFFS2.<br  />
 If JFFS2 is used, then JFFS2 uses OOB to store specific information and must ensure that these locations, the hardware ECC, and the other data locations do not conflict with each other.<br  />
 For flash with built-in ECC, use UBIFS, as the OOB cannot be read from or written to.</dd></dl>
<h2><a class="anchor" id="faq_flash_notice"></a>
5.4 Notice for Flash Programmer</h2>
<p >A flash programmer is typically required in mass production. Because generating the ECC using the burner can be difficult, users can generate it using the master instead.<br  />
 The following steps describe this procedure:<br  />
</p><ul>
<li>Select a part of the flash that includes no bad blocks and solder it to the board. Erase all, and then use AmbaUSB to burn the firmware of mass production. When finished, do not reboot. Also, avoid writing operations in flash while running.<br  />
 Weld off the flash, wash, place it in the flash programmer, and then read the content several times, saving to the bin file and ensure there are no inconsistencies.<br  />
 Use the flash programmer to burn the bin file in Step 2 to flash. Ensure the burn is to the partition and not the entire piece. Mark the bad blocks using the burner.<br  />
 Patch the flash, and ensure that the system is fully activated for the first boot.</li>
</ul>
<h1><a class="anchor" id="faq_gpio_configuration"></a>
6 GPIO Configuration</h1>
<h2><a class="anchor" id="faq_gpio_default"></a>
6.1 System Startup with Default Configuration</h2>
<p >Activated in AMBoot, the default value is written in the <code>boards\$BOARD\bsp\bsp.h</code>. For example, for cv5_timn: <code>boards\cv5_timn\bsp\bsp.h</code>. </p><div class="fragment"><div class="line">DEFAULT_GPIOX_AFSEL</div>
<div class="line">DEFAULT_GPIOX_DIR</div>
<div class="line">DEFAULT_GPIOX_MASK</div>
<div class="line">DEFAULT_GPIOX_DATA,</div>
</div><!-- fragment --><p> For further details, refer to the following:</p><ul>
<li>GPIO: AMBARELLA CV5 HW PRM</li>
<li>GPIO: AMBARELLA CV52 HW PRM</li>
</ul>
<p >For GPIO, the following two registers can be enabled: </p><div class="fragment"><div class="line">DEFAULT_GPIO0_CTRL_ENA</div>
<div class="line">DEFAULT_GPIO0_CTRL_DIR</div>
</div><!-- fragment --><p> If one GPIO includes multiple functions, then the user must set its IOMUX register; the corresponding feature selection list can be found in the Ambarella CV5x Hardware PRM document. If the register is not correctly set, the default value will not be used.</p>
<h2><a class="anchor" id="faq_gpio_control"></a>
6.2 GPIO Control in User Space</h2>
<p >The following commands can be used for debug purposes: </p><div class="fragment"><div class="line"><span class="preprocessor"># amba_debug -g 59 -d 0x0</span></div>
<div class="line"><span class="preprocessor"># amba_debug -g 59 -d 0x1</span></div>
</div><!-- fragment --><p> For further details, refer to <a class="elRef" target="_blank" href="../../../peripherals/dd/df0/si_debugfs.html">Debugfs</a>. For customer use: </p><div class="fragment"><div class="line"><span class="preprocessor"># echo 59 &gt; /sys/class/gpio/export</span></div>
<div class="line"><span class="preprocessor"># echo out &gt; /sys/class/gpio/gpio59/direction</span></div>
<div class="line"><span class="preprocessor"># echo 1 &gt; /sys/class/gpio/gpio59/value</span></div>
<div class="line"><span class="preprocessor"># echo 0 &gt; /sys/class/gpio/gpio59/value</span></div>
<div class="line"><span class="preprocessor"># echo in &gt; /sys/class/gpio/gpio59/direction</span></div>
<div class="line"><span class="preprocessor"># cat /sys/class/gpio/gpio59/value</span></div>
<div class="line"><span class="preprocessor"># echo 59 &gt; /sys/class/gpio/unexport</span></div>
</div><!-- fragment --><h1><a class="anchor" id="faq_adc_usage"></a>
7. ADC Usage</h1>
<p >For information about ADC usage, refer to <code>ambarella\kernel\linux-5.15\Documentation\arm\ambarella\adc.txt</code>.</p>
<h1><a class="anchor" id="faq_lcd_in_cv5x"></a>
8. LCD in CV5x</h1>
<p >The following shows example steps for adding an LCD named "mylcd0" with a resolution of 320x240:</p><ul>
<li>Refer to the digital or td043 driver in <code>Ambarella\kernel\private\drivers\vout\amblcd\</code>. Check the LCD datasheet to confirm the resolution, pixel clock, timing signals, interface types rgb565 / rgb888, and other information, then create the driver following the datasheet.<br  />
 Use "`test_encode Â¨Ci 0 --lcd 320x240`" to configure and test the LCD.</li>
</ul>
<h1><a class="anchor" id="faq_chip_id_check"></a>
9. Chip ID Check</h1>
<p >UUID is not provided for chips. However, users can check the CPU type (chip ID) as follows: </p><div class="fragment"><div class="line"><a class="code hl_defineRef" target="_blank" href="../../../video/de/ddf/vout__init__cfg_8c.html#a88a5b93883c34229851d6a7a93254850">AM_IOCTL</a>(fd_iav, IAV_IOC_GET_CHIP_ID, &amp;chip_id);</div>
<div class="ttc" id="avout__init__cfg_8c_html_a88a5b93883c34229851d6a7a93254850"><div class="ttname"><a href="../../../video/de/ddf/vout__init__cfg_8c.html#a88a5b93883c34229851d6a7a93254850">AM_IOCTL</a></div><div class="ttdeci">#define AM_IOCTL(_filp, _cmd, _arg)</div></div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>Call this check after the DSP enters the preview or encode mode.</dd></dl>
<h1><a class="anchor" id="faq_protection_against_overcurrent_in_the_usb_host"></a>
10. Protection Against Overcurrent in the USB Host</h1>
<p >If the USB host does not have an overcurrent, users must disable the flow detection in the source code to avoid issues and ensure that the USB device can be identified.<br  />
 Modify <code>boards/cv5x_board/bsp/cv5x_board.dts</code>. The following command is an example that uses the CV5 Timn EVK board: </p><div class="fragment"><div class="line">Boards/cv5_timn/bsp/cv5_timn.dts</div>
<div class="line">    rct@ed080000 {</div>
<div class="line">        usbphy: usbphy@ed080050 {</div>
<div class="line">            <span class="comment">// high will trigger the ocp interrupt</span></div>
<div class="line">               amb,ocp-polarity = &lt;0&gt;;</div>
<div class="line">            <span class="comment">// disable below 2 lines if disable over-current</span></div>
<div class="line">            <span class="comment">//   pinctrl-names = &quot;default&quot;;</span></div>
<div class="line">            <span class="comment">//   pinctrl-0 = &lt;&amp;usb_host0_pins_a&gt;;</span></div>
<div class="line">               md-gpios = &lt;&amp;gpio 34 0x0&gt;;</div>
<div class="line">               hub-gpios = &lt;&amp;pca9539 10 0x0&gt;;</div>
<div class="line">        };</div>
<div class="line">    };</div>
</div><!-- fragment --><p> Check to verify that the open firmware is enabled: </p><dl class="section user"><dt>For Cooper Amba build:</dt><dd><div class="fragment"><div class="line">build $ make menuconfig</div>
<div class="line">  [*] boot (boot) ---&gt;</div>
<div class="line">    Bootloader ---&gt;</div>
<div class="line">      Ambarella Firmware Configuration ---&gt;</div>
<div class="line">        AMBoot Options  ---&gt;</div>
<div class="line">          Open Firmware and Device Tree  ---&gt;</div>
<div class="line">            [*] Support Open Firmware</div>
</div><!-- fragment --> </dd></dl>
<dl class="section user"><dt>For Cooper Yocto build:</dt><dd><div class="fragment"><div class="line">build $ make menuconfig</div>
<div class="line">  meta-ambabsp ---&gt;</div>
<div class="line">    recipes-bsp ---&gt;</div>
<div class="line">      [*] boot (meta-ambabsp/recipes-bsp/boot) ---&gt;</div>
<div class="line">        Bootloader ---&gt;</div>
<div class="line">          Ambarella Firmware Configuration ---&gt;</div>
<div class="line">            AMBoot Options  ---&gt;</div>
<div class="line">              Open Firmware and Device Tree  ---&gt;</div>
<div class="line">                [*] Support Open Firmware</div>
</div><!-- fragment --></dd></dl>
<h1><a class="anchor" id="faq_watchdog"></a>
11. Watchdog</h1>
<p >If users want to use the CV5x internal watchdog, they should refer to the example of the watchdog in the kernel in <code>ambarella\kernel\linux-5.15\Documentation\watchdog\</code>.</p>
<h1><a class="anchor" id="faq_spinor_flash"></a>
12. SPI NOR Flash</h1>
<p >First, users must add new flash-related attributes in the array "amb_ids", and include the ID flash, sector size, sector number, page size, clock, and more.<br  />
 Next, in the function <b>amb_spi_nor_shutdown()</b>, users must add the reset command for the new flash to avoid system problems after reboot.<br  />
 The following example is for mx25l25645g. For this flash, the ID is 0x1940c8; there are 512 sectors, each sector is 64K, and the page size is 256 bytes. See the following "amb_ids" after adding mx25l25645g: </p><div class="fragment"><div class="line">Const <span class="keyword">struct </span>ambid_t amb_ids[] static = {</div>
<div class="line">... ...</div>
<div class="line">{<span class="stringliteral">&quot;32M&quot;</span>, INFO (0x1920c2, 0, 64 * 1024, 512, 256, 50000000, 0,)},</div>
<div class="line">{<span class="stringliteral">&quot;mx25l25645g&quot;</span>, INFO (0x1940c8, 0, 64 * 1024, 512, 256, 50000000, 0,)},</div>
<div class="line">{<span class="stringliteral">&quot;w25q128&quot;</span>, INFO (0xef4018, 0, 64 * 1024, 256, 256, 50000000, 0,)},</div>
<div class="line">......</div>
<div class="line">}</div>
</div><!-- fragment --><p> SPI flash includes a definition of "addressing space". Address space of 3 bytes can access the 16M flash. If users must access more than 16M storage space, then they should use the 4-byte addressing mode.<br  />
 For mx25l25645g 32M, if the system wants to access any data within the flash, the 4-byte addressing mode is required. In functions <b>amb_spi_nor_probe()</b>, the system sends 4 byte instructions to the flash, so mx25l25645g is in a state of 4 byte. If the system reboots at this time, AMBoot will access the flash with 3 bytes, causing data read anomalies and leading to startup issues. The solution to this problem is to send reset to mx25l25645g in function "amb_spi_nor_shutdown()".</p>
<h1><a class="anchor" id="faq_sensor_driver_init"></a>
13. Sensor Driver Initialization</h1>
<p >The following lists information about the sensor driver initialization:</p><ul>
<li>Users must add parameters when using "insmod" or "modprobe" in order to load the driver directly.</li>
<li>Parameters such as the bayer_pattern, bus_addr, and lane, are related to the hardware design.</li>
<li>bayer_pattern is related to the sample timing of the pixel clock.</li>
<li>bus_addr is related to the I2C address and interface of the sensor.</li>
<li>Lane specifies the data transmission number between the sensor and main control. For example, set number of lanes to 2 when using OV4689 in the CV5 platform.</li>
</ul>
<h1><a class="anchor" id="faq_supporting_chinese_ssid"></a>
14. Supporting Chinese SSID</h1>
<p >The following lists the steps required to support Chinese SSID:</p><ul>
<li>Create a corresponding file for the Chinese fonts. Run the following command before generating the firmware in the fakeroot directory of the user's compiler environment. For example, on the CV5_Timn board, it is <code>ambarella/out/cv5_timn/fakeroot</code>. <div class="fragment"><div class="line">make -p $(FAKEROOT_DIR)/usr/lib/localelocaledef --prefix=$(FAKEROOT_DIR) --no-archive -c</div>
<div class="line">     --little-endian -i zh_CN -f UTF-8 zh_CN.UTF-8</div>
</div><!-- fragment --> Compile and burn the new firmware. Set Lang variables when the system is on, using the following command. <div class="fragment"><div class="line">export LANG=zh_CN.utf8 LANG=zh_CN.utf8</div>
</div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="faq_firmware_upgrade"></a>
15. Firmware Upgrade</h1>
<p >For kernel upgrade and rootfs upgrade, users can refer to si_online_upgrading.<br  />
 If <code>boards/$BOARD/bsp/$BOARD.dts</code> file is changed, then users must update the DTB file using the following command. </p><div class="fragment"><div class="line">upgrade_partition -d $BOARD.dts.dtb</div>
</div><!-- fragment --><p> <code>$BOARD.dts.dtb</code> file is under the <code>out/$BOARD/amboot</code>.</p>
<h1><a class="anchor" id="faq_mptool"></a>
16. MPtool</h1>
<p >As a testing tool, MPtool consists of two parts: the server on the product side and the client on the PC end. There are two methods for connecting: WiFi and USB virtual network card. Ambarella recommends using a USB to ensure a more stable connection.<br  />
 Enable the server in "`make menuconfig`". There is no relationship between the server implementation and Oryx middleware; it is implemented by calling the interface in unit test and IAV.</p>
<h1><a class="anchor" id="faq_how_to_patch"></a>
17. How to Patch</h1>
<p >Patch is used to improve the SDK package. Typically, package + patch is used. The package + patch1 + patch2 is not supported.<br  />
 After installing a new patch, users must re-integrate changes in bsp\dts, customized applications, and IQ related files when the board is brought-up. Additionally, users must accurately backup and manage IQ files to avoid negatively impacting the IQ performance after patch installation.</p>
<h1><a class="anchor" id="faq_configuration_file"></a>
18. Configuration File</h1>
<h2><a class="anchor" id="faq_configuration_dts"></a>
18.1 DTS</h2>
<p >The following includes general information about device trees (DTS) files:</p><ul>
<li>If users must modify the public portion of a chip, modify the file <code>arch\arm64\boot\dts\ambarella\ambarella-$SoC.dtsi</code>. For the CV5S66 chip, for example, modify the file <code>arch\arm64\boot\dts\ambarella\ambarella-cv5.dtsi</code>.</li>
<li>For external devices, users must modify the device tree file <code>ambarella\boards\$BOARD\bsp\$BOARD.dts</code>. For example, for CV5_Timn, modify <code>ambarella\boards\cv5_timn\bsp\cv5_timn.dts</code> and <code>ambarella\boards\cv5_timn\bsp\cv5_timn_private.dtsi</code>.</li>
<li>If users want to check how many device nodes exist when the system is running, they must first enable the device tree in the public Linux menuconfig. Then, check them in <code>proc\device-tree</code>. DTS works after the Linux kernel runs. The BST and AMBoot modes work before the kernel. Therefore, when there are changes in the hardware, users must check <code>ambarella/boards/$BOARD/bsp/bsp.h</code>. This file defines the initial state of each pin, the initial function of each pin, and each flash partitionâ€™s size. Incorrect bsp.h will cause the system to hang. For detailed DTS information, refer to <code>kernel\linux-5.15\documentation\devicetree\bindings\arm\ambarella.txt</code>.</li>
</ul>
<h2><a class="anchor" id="faq_configuration_ddr"></a>
18.2 DDR</h2>
<p >If users change the type of the DDR SDRAM or perform a shmoo test, then they must check or change <code>ambarella/boards/$BOARD/$BOARD_$CPU.ini</code>.<br  />
 For example, for CV5S66, users must change <code>ambarella/boards/cv5_timn/bsp/cv5_timn_66_micron_lpddr5.ini</code>.<br  />
 After running a shmoo test and receiving the correct DDR parameters, users can then modify the file <code>ambarella/boards/$BOARD/bsp/$BOARD_$CPU.ini</code>.<br  />
 For example, for cv5_timn, modify: <code>ambarella/boards/cv5_timn/bsp/cv5_timn_66_micron_lpddr5.ini</code>.</p>
<h2><a class="anchor" id="faq_configuration_menuconfig"></a>
18.3 Menuconfig</h2>
<p >The default configuration file for "make menuconfig", is <code>ambarella/boards/$BOARD/config/$BOARD_config</code>.<br  />
 To change the configuration in CV5 Timn, modify: <code>ambarella/boards/cv5_timn/bsp/cv5_ipcam_config</code>.<br  />
 While using make menuconfig_public_linux, the default kernel configuration file is typically <code>ambarella/boards/$BOARD/config/kernel/$BOARD_kernel_config</code>.<br  />
 Alternatively, for example, use <code>/linux-5.15/arch/arm64/configs/ambarella_cv5_defconfig</code>.</p>
<h2><a class="anchor" id="faq_configuration_cvflow_issues"></a>
18.4 CVflowÂ® Issues</h2>
<p >For issues concerning CVflow, refer to the document <code>Ambarella CV5x DG Flexible Linux SDK CVflow FAQ</code>.</p>
<h1><a class="anchor" id="faq_emmc_usage"></a>
19. eMMC Usage</h1>
<p >To use embedded multi-media controller (eMMC) on the EVK, a hardware rework may be required. Refer to si_sd_upgrading. Additionally, notitle provides information on software configuration and flash upgrading.</p>
<h1><a class="anchor" id="faq_cma_for_iav_cv_memory_partitions"></a>
20. CMA for IAV / CV Memory Partitions</h1>
<p >For instructions on how to use the contiguous memory allocator (CMA) for IAV / CV memory partitions, refer to the document Ambarella <code>CV5x DG Flexible Linux SDK CMA Driver</code>. Users are recommended to specify the size of the IAV / CV CMA partitions according to their requirements with less margin and leave more system memory for the Linux partition.<br  />
 Although the unused memory resource left in the CMA partition can be reused by the Linux system, it is easy to trigger the out of memory (OOM) killer when the Linux system starts to allocate from the CMA partition and this is a limitation of the CMA. For details on this limitation, refer to <code>Ambarella CV5x DG Flexible Linux SDK CMA Driver</code>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
