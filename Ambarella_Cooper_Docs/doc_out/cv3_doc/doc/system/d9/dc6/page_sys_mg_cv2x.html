<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>System: Migration Guide From CV2x</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="System"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-ambarella.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Ambarella.png"/></td>
  <td id="projectalign">
   <div id="projectname">System<span id="projectnumber">&#160;Cooper_1.6.0 (CV72 &amp; CV3) @ 2024.07.10 14:12:44</span>
   </div>
   <div id="projectbrief">placeholder</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.html','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d9/dc6/page_sys_mg_cv2x.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Migration Guide From CV2x </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="sys_mg_cv2x_history"></a>
0. Revision History</h1>
<a class="anchor" id="sys_migration_guide_rev_history"></a>
<table class="doxtable">
<caption></caption>
<tr>
<th>Updated Date </th><th align="left">Modification </th></tr>
<tr>
<td>20220812 </td><td>Initial Version </td></tr>
<tr>
<td>20221010 </td><td>Added Section <a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_sw_api_diff_img_scale">3.1.6 Arbitrary Image Scaler</a> </td></tr>
<tr>
<td rowspan="2">20221027 </td><td>1. Updated Section <a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface">IOCTL Interface</a> </td></tr>
<tr>
<td>2. Updated Section <a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_tools">Tools</a> </td></tr>
<tr>
<td rowspan="2">20230725 </td><td>1. Updated Section <a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_sw_api_diff">3.1 Application Programming Interface Differences</a> </td></tr>
<tr>
<td>2. Updated Section <a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_g_sys_res">4.5 IAV_IOC_GET_SYSTEM_RESOURCE</a> </td></tr>
<tr>
<td rowspan="2">20231025 </td><td>1. Updated Section <a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_tools_linux">6.2 Toolchain for Linux</a> </td></tr>
<tr>
<td>2. Updated Section <a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_g_sys_res">4.5 IAV_IOC_GET_SYSTEM_RESOURCE</a> </td></tr>
<tr>
<td>20240109 </td><td>Added Section <a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_sw_api_diff_multi_pass">3.1.7 Multi-Pass</a> </td></tr>
<tr>
<td rowspan="3">20240122 </td><td>1. Added Section <a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_sw_api_diff_custom_sei">3.1.8 Custom SEI</a> </td></tr>
<tr>
<td>2. Added Section <a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_sw_api_diff_raw_fps">3.1.9 RAW fps</a> </td></tr>
<tr>
<td>3. Updated Section <a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface">IOCTL Interface</a> </td></tr>
</table>
<h1><a class="anchor" id="sys_mg_overview"></a>
1. Overview</h1>
<p >This document provides users with instructions for migrating single- and multiple-video input (VIN) channel designs from the CV2x to the Cooper chip family. The Cooper family of chips includes the CV5, CV52, CV72, and CV3 chips.</p>
<hr  />
<h1><a class="anchor" id="sys_mg_hw"></a>
2. Hardware</h1>
<h2><a class="anchor" id="sys_mg_hw_main_diff"></a>
2.1 Main Differences</h2>
<p >The following table lists the main differences between the CV2S88, CV5S66, and CV72S66 chips. </p><table class="doxtable">
<caption>Table 2-1. Differences Between CV2S88, CV5S66, and CV72S66.</caption>
<tr>
<th colspan="2">Hardware Type </th><th>CV2S88 </th><th>CV5S66 </th><th>CV72S66 </th></tr>
<tr>
<th rowspan="8">Basic </th><th>Process(nm) </th><td>10 </td><td>5 </td><td>5 </td></tr>
<tr>
<th>CPU </th><td>Quad-Cortex速 A53 (1.0 GHz, 64 bits) </td><td>Dual-Cortex A76 (1.6 GHz, 64 bits) </td><td>Dual-Cortex A76 (1.6 GHz, 64 bits) + Cortex-M3 (576 MHz) </td></tr>
<tr>
<th>VIN </th><td>Native six (can future extend by B5 / B6 / B8) </td><td>Four independent VINs; total of 14 VINs (can extend via serializer / deserializer (SERDES)) </td><td>Three independent VINs; total of ten VINs (can extend via SERDES) </td></tr>
<tr>
<th>CVflow速 processor </th><td>One </td><td>One </td><td>One </td></tr>
<tr>
<th>USB interface </th><td>2.0 (up to 480 Mbps)</td><td>3.2 Gen 2 (up to 10 Gbps) </td><td>3.2 Gen 2 (up to 10 Gbps) </td></tr>
<tr>
<th>DRAM interface </th><td>LPDDR4 </td><td>LPDDR5 / LPDDR4 </td><td>LPDDR5 / LPDDR4 </td></tr>
<tr>
<th>Max DRAM size </th><td>4 GB </td><td>32 GB for LPDDR5 / 16 GB for LPDDR4 </td><td>16 GB for LPDDR5(x) / 8 GB for LPDDR4 </td></tr>
<tr>
<th>PCIe </th><td>N/A </td><td>Four-lane PCIe </td><td>One-lane PCIe Gen 3 </td></tr>
<tr>
<th rowspan="5">Clock(MHz) </th><th>Cortex </th><td>Quad-Core@1008 </td><td>Dual-Core@1608 </td><td>1608 </td></tr>
<tr>
<th>DRAM </th><td>1596 (64-bit LPDDR4)</td><td>2640 (64-bit LPDDR5) </td><td>3192 (32-bit LPDDR5) </td></tr>
<tr>
<th>IDSP </th><td>864 </td><td>696 </td><td>1272 </td></tr>
<tr>
<th>Core </th><td>960 </td><td>720 </td><td>624 </td></tr>
<tr>
<th>Vision (VP) </th><td>912 </td><td>1104 </td><td>624 </td></tr>
<tr>
<th>Voltage (V) </th><th>Core </th><td>0.80 </td><td>0.75 </td><td>0.75 </td></tr>
<tr>
<th rowspan="2">Performance</th><th>HEVC encode </th><td>4 x 5MP30 HEVC (linear VIN) </td><td>4 x (5MP30 + 720P30 + 5MP15) </td><td>4 x (5MP30 + 720p30 + 5MP2) </td></tr>
<tr>
<th>CV </th><td>Various convolutional neural network (CNN) algorithms </td><td>Various CNN algorithms </td><td>Various CNN algorithms </td></tr>
</table>
<h2><a class="anchor" id="sys_mg_hw_dsp_diff"></a>
2.2 Digital Signal Processor Differences</h2>
<p >The major digital signal processor (DSP)-related differences between CV2x, CV5x, CV72, and CV3 are as follows:</p><ul>
<li>CV2x and CV72 offer one core for both image digital signal processing (IDSP) and video digital signal processing (VDSP). Alternatively, CV5x and CV3 have dual cores for both IDSP and VDSP.</li>
<li>CV2x provides six pyramid layers. Alternatively, CV5x, CV72 and CV3 provide seven pyramid layers.</li>
</ul>
<h2><a class="anchor" id="sys_mg_hw_timn_board"></a>
2.3 CV5 Timn Board</h2>
<p >This sections provides details on the CV5 Timn board.</p>
<h3><a class="anchor" id="sys_mg_hw_timn_board_cfg"></a>
2.3.1 Board Configuration</h3>
<p >The figure below provides an overview of the major components and input / output (I/O) connectors of the CV5 evaluation kit (EVK) board, followed by a table of component descriptions. </p><div class="image">
<img src="../../cv5_timn_board.png" alt=""/>
<div class="caption">
Figure 2-1. CV5 Timn Board.</div></div>
<p> The major components and I/O connectors identified in the figure above are as follows. </p><table class="doxtable">
<caption>Table 2-2. Input / Output Connectors Identifier.</caption>
<tr>
<th>Identifier </th><th>Description </th></tr>
<tr>
<td>1 </td><td>Universal asynchronous receiver / transmitter (UART)1 DB9 with flow control </td></tr>
<tr>
<td>2 </td><td>USB to serial debug UART + firmware download port </td></tr>
<tr>
<td>3 </td><td>Internal power on / off </td></tr>
<tr>
<td>4 </td><td>Reset </td></tr>
<tr>
<td>5 </td><td>External power on / off </td></tr>
<tr>
<td>6 </td><td>Microcontroller unit (MCU) reset </td></tr>
<tr>
<td>7 </td><td>Audio line-out </td></tr>
<tr>
<td>8 </td><td>Analog microphone (MIC) </td></tr>
<tr>
<td>9 </td><td>Digital MIC </td></tr>
<tr>
<td>10 </td><td>Joint test action group (JTAG) </td></tr>
<tr>
<td>11 </td><td>Dual in-line package (DIP) switches </td></tr>
<tr>
<td>12 </td><td>Video input (VIN) port1 </td></tr>
<tr>
<td>13 </td><td>VIN port2 </td></tr>
<tr>
<td>14 </td><td>VIN port3 </td></tr>
<tr>
<td>15 </td><td>VIN port3 </td></tr>
<tr>
<td>16 </td><td>Mobile industry processor interface (MIPI速) DSI video output (VOUT) </td></tr>
<tr>
<td>17 </td><td>USB 3.0 host </td></tr>
<tr>
<td>18 </td><td>USB Type-C </td></tr>
<tr>
<td>19 </td><td>Micro USB 3.0 device </td></tr>
<tr>
<td>20 </td><td>Composite video with blanking and sync (CVBS) VOUT </td></tr>
<tr>
<td>21 </td><td>Infrared (IR) receiver </td></tr>
<tr>
<td>22 </td><td>Periperal component interconnect express (PICe) x4 port </td></tr>
<tr>
<td>23 </td><td>Ethernet </td></tr>
<tr>
<td>24 </td><td>Ethernet </td></tr>
<tr>
<td>25 </td><td>12-V DC power </td></tr>
<tr>
<td>26 </td><td>High-definition multimedia interface (HDMI速) VOUT </td></tr>
</table>
<h2><a class="anchor" id="sys_mg_hw_ga_board"></a>
2.4 CV72 Ga Board</h2>
<p >This section provides details on the CV72 Ga board.</p>
<h3><a class="anchor" id="sys_mg_hw_timn_board_cfg"></a>
2.3.1 Board Configuration</h3>
<p >The figure below provides an overview of the major components and I/O connectors of the CV72 EVK board, followed by a table of component descriptions. </p><div class="image">
<img src="../../cv72_ga_board.png" alt=""/>
<div class="caption">
Figure 2-2. CV72 Ga Board.</div></div>
<p> The major components and I/O connectors identified in the figure above are as follows. </p><table class="doxtable">
<caption>Table 2-3. Input / Output Connectors Identifier.</caption>
<tr>
<th>Identifier </th><th>Description </th></tr>
<tr>
<td>1 </td><td>USB to serial debug UART and firmware download port </td></tr>
<tr>
<td>2 </td><td>Internal power on / off </td></tr>
<tr>
<td>3 </td><td>Reset </td></tr>
<tr>
<td>4 </td><td>External power on / off </td></tr>
<tr>
<td>5 </td><td>MCU reset </td></tr>
<tr>
<td>6 </td><td>Audio line-out </td></tr>
<tr>
<td>7 </td><td>Audio headphone (HP) out </td></tr>
<tr>
<td>8 </td><td>Audio speaker out </td></tr>
<tr>
<td>9 </td><td>JTAG </td></tr>
<tr>
<td>10 </td><td>DIP switches </td></tr>
<tr>
<td>11 </td><td>VIN port1 </td></tr>
<tr>
<td>12 </td><td>VIN port2 </td></tr>
<tr>
<td>13 </td><td>MIPI DSI VOUT </td></tr>
<tr>
<td>14 </td><td>USB 3.2 host </td></tr>
<tr>
<td>15 </td><td>USB Type-C </td></tr>
<tr>
<td>16 </td><td>Micro USB 3.2 device </td></tr>
<tr>
<td>17 </td><td>CVBS VOUT </td></tr>
<tr>
<td>18 </td><td>IR receiver </td></tr>
<tr>
<td>19 </td><td>PCIe x1 port </td></tr>
<tr>
<td>20 </td><td>Ethernet </td></tr>
<tr>
<td>21 </td><td>12-V DC power </td></tr>
<tr>
<td>22 </td><td>HDMI VOUT </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="sys_mg_sw"></a>
3. Software</h1>
<p >This chapter describes the software migration process from CV2x to the Cooper Linux software development kit (SDK).</p>
<h2><a class="anchor" id="sys_mg_sw_api_diff"></a>
3.1 Application Programming Interface Differences</h2>
<h3><a class="anchor" id="sys_mg_sw_api_diff_sysres"></a>
3.1.1 System Resources</h3>
<p >CV2x uses the <b><a class="elRef" target="_blank" href="../../../library/df/d3a/structiav__system__resource.html">iav_system_resource</a></b> structure to describe system resources, including the channel, canvas, and stream. The Cooper Linux SDK splits the <b><a class="elRef" target="_blank" href="../../../library/df/d3a/structiav__system__resource.html">iav_system_resource</a></b> structure to create smaller structures. By removing the channel, canvas, and stream from the <b><a class="elRef" target="_blank" href="../../../library/df/d3a/structiav__system__resource.html">iav_system_resource</a></b> structure and adding a new input / output control (IOCTL) <b>IAV_IOC_SET_CHAN_CONFIG</b>, <b>IAV_IOC_SET_CANVAS_CONFIG</b>, and <b>IAV_IOC_SET_STREAM_RESOURCE</b>, the Cooper Linux SDK optimizes this process and enables a streamlined configuration. For detailed usage of these new IOCTLs, refer to "Set System Resources Limitations" in the Doxygen image audio / video (IAV) driver application programming interface (API) partition.</p>
<h3><a class="anchor" id="sys_mg_sw_api_diff_canvas_num"></a>
3.1.2 Canvas Number</h3>
<p >The Cooper chip family supports a maximum canvas number of 20, while CV2x supports a maximum of 12. On CV2x, canvas ID 16 is reserved for the encode from memory (EFM) stream; this has been changed to 24 in the Cooper Linux SDK. Canvas ID 16 indicates the 16th canvas in the Cooper Linux SDK, rather than the ID for the EFM stream. Because the canvas number has been upgraded from 12 to 20, there is potential for size changes to the canvas-related structures, or to the canvas bitmaps. More canvas numbers enable more dynamic random-access memory (DRAM) bandwidth, so the overall DRAM bandwidth may be increased. Users may expect the overall frame rate to be affected if the DRAM bandwidth is the bottleneck.</p>
<h3><a class="anchor" id="sys_mg_sw_api_diff_stream_num"></a>
3.1.3 Stream Number</h3>
<p >The Cooper chip family supports a maximum stream number of 20, while CV2x supports a maximum of 16. Note that the total encode performance remains unchanged for the Cooper chips, so the individual stream performance may require adjustments to support additional stream numbers. Due to the stream number increasing from 12 to 20, there is potential for size changes to the stream-related structures or the stream bitmaps.</p>
<h3><a class="anchor" id="sys_mg_sw_api_diff_blur_insertion"></a>
3.1.4 Blur Insertion</h3>
<p >For Cooper chips, dedicated hardware performs blur insertion, and the blur effect is improved to appear more natural. The blur interface is slightly different from CV2x. The information below provides further details on the blur-related interface changes for the Cooper Linux SDK and provides a comparison to CV2x.</p><ul>
<li>Blur color is no longer required in the Cooper Linux SDK. Blur operations are performed with the color from the original YUV data in order to provide a more natural appearance. The blur color can also be enabled for CV5x and later chips, to achieve backward compatible behavior.</li>
<li>Compared to the per-8x8 block for CV2x, the per-pixel-level blur granuarity is finer for Cooper chips. Because per-pixel-level blur granularity uses one bit per pixel in the blur memory, Cooper chips require a larger DRAM size and greater bandwidth than CV2x. A bit value of 0 indicates that blur is enabled, while a bit value of 1 indicates that blur is disabled for Cooper chips (these values are different for CV2x).</li>
<li>Cooper chips insert blur for each encode frame. There is not an "insert always" flag in the blur configuration.</li>
<li>The maximum-supported blur strength level is 4 on Cooper chips and 3 on CV2x.</li>
<li>Cooper chips supports two types of blur effect: mosaic-like blur and ground-glass-like blur.</li>
</ul>
<h3><a class="anchor" id="sys_mg_sw_api_diff_eis"></a>
3.1.5 Electronic Image Stabilization</h3>
<p >Implementation of the electronic image stabilization (EIS) feature in the Cooper chip family differs from that of CV2x. EIS is implemented with two channels in the Cooper Linux SDK, while the CV2x SDK uses a single channel. Using two channels for the EIS feature ensures that there is no extra latency in frames for 3A (auto exposure (AE) / auto white balance (AWB) / auto focus (AF)) statistics. For more details, refer to the EIS Library document in Doxygen, as well as the unit test <b>test_eis</b>.</p>
<h3><a class="anchor" id="sys_mg_sw_api_diff_img_scale"></a>
3.1.6 Arbitrary Image Scaler</h3>
<p >For Cooper chips, users can specify the image offset in the scaler output buffer. For CV2x, the image is always at the top-left corner of the output buffer.</p>
<h3><a class="anchor" id="sys_mg_sw_api_diff_multi_pass"></a>
3.1.7 Multi-Pass</h3>
<p >The multi-pass feature is redesigned for CV5x and later computer vision (CV) chips (but not applicable to earlier CV2x chips). It is a multi-channel design leveraging multi-region dewarp mode (mode 1) to expand the number of source buffers. Each channel still has only one pass.<br  />
 This feature is supported since Cooper SDK 1.6. For more details, refer to <a class="elRef" target="_blank" href="../../../video/d3/ddf/fs_adv_multi_pass.html">ADVANCED - Multi-Pass</a>.</p>
<h3><a class="anchor" id="sys_mg_sw_api_diff_custom_sei"></a>
3.1.8 Custom SEI</h3>
<p >The custom SEI feature is redesigned inside DSP / IAV for CV5x and later computer vision (CV) chips. Therefore, the API flow and interfaces are also refined. This feature is supported since Cooper SDK 1.6.</p>
<p >The previous CV2x API flow is listed as follows:</p><ol type="1">
<li>Enable custom SEI, and configure custom SEI related buffers when set up system resource before preview. The related parameters are custom_sei / custom_sei_buf_size / custom_sei_buf_num for <a class="elRef" target="_blank" href="../../../library/df/d3a/structiav__system__resource.html">iav_system_resource</a>.</li>
<li>Map the custom SEI memory with IAV_PART_DSP. For the previous CV2x platform, the custom SEI memory is inside the DSP partition (IAV_PART_DSP) memory.</li>
<li>Request custom SEI buffer to write the SEI content. The API is IAV_IOC_CUSTOM_SEI_REQUEST_BUF.</li>
<li>Fill the custom SEI buffer, and set request to IAV. The API is IAV_IOC_SET_STREAM_CONFIG with IAV_STMCFG_CUSTOM_SEI.</li>
</ol>
<p >The new API flow is listed as follows:</p><ol type="1">
<li>Enable custom SEI, and configure custom SEI related buffers when set up stream resource before preview. The related parameters are custom_sei_possible / custom_sei_data_max_size / custom_sei_buf_num for <a class="elRef" target="_blank" href="../../../library/d0/d9e/structiav__stream__resource.html">iav_stream_resource</a>. These parameters are stream based, so each stream can enable and configure them separately. The parameter "custom_sei_data_max_size" stands for the maximum custom SEI data size for this stream.</li>
<li>Map the custom SEI memory with IAV_PART_CUSTOM_SEI. For the new implementation, the custom SEI has its dedicated memory partition.</li>
<li>Request custom SEI buffer to write the SEI content. The API is IAV_IOC_GET_STREAM_CONFIG with IAV_STMCFG_CUSTOM_SEI.</li>
<li>Fill the custom SEI buffer, and set request to IAV. The API is IAV_IOC_SET_STREAM_CONFIG with IAV_STMCFG_CUSTOM_SEI.</li>
</ol>
<p >For more details, refer to <a class="elRef" target="_blank" href="../../../video/d5/d7d/fs_basic_stream.html#subsection_custom_sei">1.16 Insert User-Customized Data into Bitstream</a>.</p>
<h3><a class="anchor" id="sys_mg_sw_api_diff_raw_fps"></a>
3.1.9 RAW fps</h3>
<p >For CV5x and later chips, RAW fps is introduced between VIN fps and IDSP fps, which can potentially save significant DRAM bandwidth for RAW data output, if user needs a lower IDSP processing rate. For CV2x, RAW fps must be the same as VIN fps, which is also sensor fps.</p>
<p >The RAW fps is specified with parameter "raw_fps" or "raw_fps_hp" in <a class="elRef" target="_blank" href="../../../library/d9/db4/structiav__chan__cfg.html">iav_chan_cfg</a>. For more details, refer to <a class="elRef" target="_blank" href="../../../video/dc/d95/fs_basic_fps.html">BASIC - Frame Rate</a>.</p>
<h2><a class="anchor" id="sys_mg_sw_mem_access"></a>
3.2 Memory Access</h2>
<p >The CV2x platform supports up to 4 GB of DRAM. The DSP and vector processor (VP) hardware can access up to a 32-bit memory address. Therefore, all modules including CPU, DSP, and VP can access the entire 4-GB DRAM without issue.<br  />
 The CV5x platform supports up to 16 GB of DRAM. The DSP and VP hardware can access up to a 32-bit memory address. However, there is a limitation that the DSP and VP hardware can only access up to 4 GB of DRAM. The solution is to separate the memory access ranges for both DSP and VP, enabling VP to access a range from 0 GB to 4 GB, and the DSP to access a range within 4 GB to 8 GB. All memory, including DSP and VP memory, can be accessed by the Arm CPU. The shared memory between DSP and VP is within a 4 GB range with the end address of 4 GB. For more details, refer to Section 2.1.2, "8 GB (or &gt; 8 GB) Memory Layout" in the DRAM Optimization document.</p>
<p >DSP memory space is divided into two partitions: the first is DSP private memory, which can be accessed by only DSP and Arm; the other is the DSP shared memory, which can be accessed by DSP, Arm, and VP. If the DRAM size is 8 GB or greater, the DSP private memory starts from the physical memory (4 GB), and the shared memory ends with physical memory (4 GB). Due to the new memory layout introduced on the CV5x platform, there are some special notes:</p><ul>
<li>The DSP memory address and physical memory address may require translation from one to another. When the DRAM size is 8 GB or greater, the DSP private memory is mapped from the physical address (4 GB) to the DSP address (0x0).</li>
<li>If the DSP output buffer must be accessed by VP hardware, this buffer must be from the DSP shared memory rather than DSP private memory, which is within the 4-GB limit. For example, the canvas or pyramid buffer can enable the external memory or manual feed, which will be assigned in the DSP shared memory. Otherwise, the buffer is located in the DSP private memory, which cannot be directly accessed by the VP hardware. The typical DSP shared memory partitions may include canvas, pyramid, VOUT onscreen display (OSD), and overlay. These may be required to be directly accessed by the VP without a memory copy.</li>
<li>The graphics direct memory access (GDMA) hardware can only access 32-bit DRAM address; the accessing memory range is configured to be the same as the DSP in order to accelerate the copy speed for DSP-related memory.</li>
</ul>
<h3><a class="anchor" id="sys_mg_sw_mem_access_cv"></a>
3.2.1 Accessing Canvas Data from CV Applications</h3>
<p >For CV-related use cases, CV applications may require queried canvas data from the IAV driver and send it to the VP for further detection. To avoid extra memory copies, Ambarella suggests that users enable manual feed or external memory for this canvas. This way, the canvas will be from the DSP shared memory and can be directly accessed by the VP without extra copies from the DSP private memory to the VP-accessible memory.</p>
<p >If the canvas is enabled with manual feed or external memory, the queried canvas is from the canvas pool (<b>IAV_PART_CANVAS_POOL</b>) in the DSP shared memory, and the YUV data is reported with the base address of the canvas pool. Otherwise, the queried canvas is from the DSP partition (<b>IAV_PART_DSP</b>), and the YUV data is reported with the base address of the DSP partition.</p>
<p >To simplify the process for CV applications to query canvas data, Ambarella suggests that customers use the API <b>IAV_IOC_QUERY_INFO</b> with <b>IAV_INFO_CANVAS</b> to obtain the base address for the buffer pool of the reported canvas data and the total memory size for this buffer pool. </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_structRef" target="_blank" href="../../../library/d5/d30/structiav__canvas__info.html">iav_canvas_info</a> {</div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a> <a class="code hl_variableRef" target="_blank" href="../../../library/d5/d30/structiav__canvas__info.html#a2f1e22f38f7be358c963bc2a979fbf4d">canvas_id</a> : 8; <span class="comment">// Canvas ID</span></div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a> <a class="code hl_variableRef" target="_blank" href="../../../library/d5/d30/structiav__canvas__info.html#aee03509477274f40b568384584388e88">reserved0</a> : 24;</div>
<div class="line">     <span class="keyword">enum</span> <a class="code hl_enumerationRef" target="_blank" href="../../../driver/d3/de3/group__iav-ioctl-general-helper.html#ga72de8a505ff4d73f6252097b3bf5b993">iav_canvas_type</a> <a class="code hl_variableRef" target="_blank" href="../../../library/d5/d30/structiav__canvas__info.html#ad25de23139382a40fae433639dbc04e9">type</a>;</div>
<div class="line">     <span class="keyword">enum</span> <a class="code hl_enumerationRef" target="_blank" href="../../../driver/d3/de3/group__iav-ioctl-general-helper.html#ga70d00bb0a3406ea542514b8abde9383a">iav_canvas_state</a> <a class="code hl_variableRef" target="_blank" href="../../../library/d5/d30/structiav__canvas__info.html#aa177c4ac5b430185ba5212a8eeb99c29">state</a></div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a> <a class="code hl_variableRef" target="_blank" href="../../../library/d5/d30/structiav__canvas__info.html#a3bfac4a72761ec71f969cf4db1557498">reserved1</a>;</div>
<div class="line">     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code hl_variableRef" target="_blank" href="../../../library/d5/d30/structiav__canvas__info.html#a36706adaf8155ec1f0ce5b2130f996fc">mem_phys_addr</a>;   <span class="comment">// Canvas memory partition base physical address</span></div>
<div class="line">     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code hl_variableRef" target="_blank" href="../../../library/d5/d30/structiav__canvas__info.html#a6a21f902348c92a852a41a6ad83cf469">mem_size</a>;        <span class="comment">// Canvas memory partition size</span></div>
<div class="line">};</div>
<div class="ttc" id="agroup__iav-ioctl-general-helper_html_ga70d00bb0a3406ea542514b8abde9383a"><div class="ttname"><a href="../../../driver/d3/de3/group__iav-ioctl-general-helper.html#ga70d00bb0a3406ea542514b8abde9383a">iav_canvas_state</a></div><div class="ttdeci">iav_canvas_state</div></div>
<div class="ttc" id="agroup__iav-ioctl-general-helper_html_ga72de8a505ff4d73f6252097b3bf5b993"><div class="ttname"><a href="../../../driver/d3/de3/group__iav-ioctl-general-helper.html#ga72de8a505ff4d73f6252097b3bf5b993">iav_canvas_type</a></div><div class="ttdeci">iav_canvas_type</div></div>
<div class="ttc" id="agroup__iav-typedef_html_ga10e94b422ef0c20dcdec20d31a1f5049"><div class="ttname"><a href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a></div><div class="ttdeci">unsigned int u32</div></div>
<div class="ttc" id="astructiav__canvas__info_html"><div class="ttname"><a href="../../../library/d5/d30/structiav__canvas__info.html">iav_canvas_info</a></div></div>
<div class="ttc" id="astructiav__canvas__info_html_a2f1e22f38f7be358c963bc2a979fbf4d"><div class="ttname"><a href="../../../library/d5/d30/structiav__canvas__info.html#a2f1e22f38f7be358c963bc2a979fbf4d">iav_canvas_info::canvas_id</a></div><div class="ttdeci">u32 canvas_id</div></div>
<div class="ttc" id="astructiav__canvas__info_html_a36706adaf8155ec1f0ce5b2130f996fc"><div class="ttname"><a href="../../../library/d5/d30/structiav__canvas__info.html#a36706adaf8155ec1f0ce5b2130f996fc">iav_canvas_info::mem_phys_addr</a></div><div class="ttdeci">unsigned long mem_phys_addr</div></div>
<div class="ttc" id="astructiav__canvas__info_html_a3bfac4a72761ec71f969cf4db1557498"><div class="ttname"><a href="../../../library/d5/d30/structiav__canvas__info.html#a3bfac4a72761ec71f969cf4db1557498">iav_canvas_info::reserved1</a></div><div class="ttdeci">u32 reserved1</div></div>
<div class="ttc" id="astructiav__canvas__info_html_a6a21f902348c92a852a41a6ad83cf469"><div class="ttname"><a href="../../../library/d5/d30/structiav__canvas__info.html#a6a21f902348c92a852a41a6ad83cf469">iav_canvas_info::mem_size</a></div><div class="ttdeci">unsigned long mem_size</div></div>
<div class="ttc" id="astructiav__canvas__info_html_aa177c4ac5b430185ba5212a8eeb99c29"><div class="ttname"><a href="../../../library/d5/d30/structiav__canvas__info.html#aa177c4ac5b430185ba5212a8eeb99c29">iav_canvas_info::state</a></div><div class="ttdeci">enum iav_canvas_state state</div></div>
<div class="ttc" id="astructiav__canvas__info_html_ad25de23139382a40fae433639dbc04e9"><div class="ttname"><a href="../../../library/d5/d30/structiav__canvas__info.html#ad25de23139382a40fae433639dbc04e9">iav_canvas_info::type</a></div><div class="ttdeci">enum iav_canvas_type type</div></div>
<div class="ttc" id="astructiav__canvas__info_html_aee03509477274f40b568384584388e88"><div class="ttname"><a href="../../../library/d5/d30/structiav__canvas__info.html#aee03509477274f40b568384584388e88">iav_canvas_info::reserved0</a></div><div class="ttdeci">u32 reserved0</div></div>
</div><!-- fragment --><p >The example usage for this API to obtain buffer pool information is as follows: </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_structRef" target="_blank" href="../../../library/db/d5e/structiav__queryinfo.html">iav_queryinfo</a> query_info;</div>
<div class="line"><span class="keyword">struct </span><a class="code hl_structRef" target="_blank" href="../../../library/d5/d30/structiav__canvas__info.html">iav_canvas_info</a> *canvas_info = NULL;</div>
<div class="line">memset(&amp;query_info, 0, <span class="keyword">sizeof</span>(query_info));</div>
<div class="line">query_info.qid = <a class="code hl_variableRef" target="_blank" href="../../../driver/d3/de3/group__iav-ioctl-general-helper.html#gga1a439af5ebc8b8d356cfc7bfc7929a22ac21f054d0af36e5602d4673fc27b74e9">IAV_INFO_CANVAS</a>;</div>
<div class="line">canvas_info = &amp;query_info.arg.canvas;</div>
<div class="line">canvas_info-&gt;<a class="code hl_variableRef" target="_blank" href="../../../library/d5/d30/structiav__canvas__info.html#a2f1e22f38f7be358c963bc2a979fbf4d">canvas_id</a> = p_iav-&gt;buffer_id;</div>
<div class="line"><span class="keywordflow">if</span> (ioctl(fd_iav, IAV_IOC_QUERY_INFO, &amp;query_info) &lt; 0) {</div>
<div class="line">     perror(<span class="stringliteral">&quot;IAV_IOC_QUERY_INFO&quot;</span>);</div>
<div class="line">     <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"><span class="comment">// This is the buffer pool size</span></div>
<div class="line"><a class="code hl_variableRef" target="_blank" href="../../../library/d5/d30/structiav__canvas__info.html#a6a21f902348c92a852a41a6ad83cf469">mem_size</a> = canvas_info-&gt;<a class="code hl_variableRef" target="_blank" href="../../../library/d5/d30/structiav__canvas__info.html#a6a21f902348c92a852a41a6ad83cf469">mem_size</a>;</div>
<div class="line"><span class="comment">// This is the virtual memory base</span></div>
<div class="line">virt_base = (uint8_t *)mmap(NULL, <a class="code hl_variableRef" target="_blank" href="../../../library/d5/d30/structiav__canvas__info.html#a6a21f902348c92a852a41a6ad83cf469">mem_size</a>, PROT_READ, MAP_SHARED, p_iav-&gt;fd_iav, canvas_info-&gt;<a class="code hl_variableRef" target="_blank" href="../../../library/d5/d30/structiav__canvas__info.html#a36706adaf8155ec1f0ce5b2130f996fc">mem_phys_addr</a>);</div>
<div class="line"><span class="comment">// This is the physical memory base</span></div>
<div class="line">phy_base = canvas_info-&gt;<a class="code hl_variableRef" target="_blank" href="../../../library/d5/d30/structiav__canvas__info.html#a36706adaf8155ec1f0ce5b2130f996fc">mem_phys_addr</a>;</div>
<div class="ttc" id="agroup__iav-ioctl-general-helper_html_gga1a439af5ebc8b8d356cfc7bfc7929a22ac21f054d0af36e5602d4673fc27b74e9"><div class="ttname"><a href="../../../driver/d3/de3/group__iav-ioctl-general-helper.html#gga1a439af5ebc8b8d356cfc7bfc7929a22ac21f054d0af36e5602d4673fc27b74e9">IAV_INFO_CANVAS</a></div><div class="ttdeci">IAV_INFO_CANVAS</div></div>
<div class="ttc" id="astructiav__queryinfo_html"><div class="ttname"><a href="../../../library/db/d5e/structiav__queryinfo.html">iav_queryinfo</a></div></div>
</div><!-- fragment --><p >The example usage to access the YUV data is as follows: </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_structRef" target="_blank" href="../../../library/d8/de5/structiav__querydesc.html">iav_querydesc</a> query_desc = {0};</div>
<div class="line">------------------------------------------------------</div>
<div class="line">query_desc.<a class="code hl_variableRef" target="_blank" href="../../../library/d8/de5/structiav__querydesc.html#aa73b12ace6ac7df824707a89ac4f91ff">qid</a> = <a class="code hl_variableRef" target="_blank" href="../../../driver/d3/de3/group__iav-ioctl-general-helper.html#gga3606b35b652dca594dc455dfb0b9f172ad1eb61f9c66c08ad24169d01d4d0ee9e">IAV_DESC_CANVAS</a>;</div>
<div class="line">------------------------------------------------------</div>
<div class="line"><span class="keywordflow">if</span> (ioctl(fd_iav, IAV_IOC_QUERY_DESC, &amp;query_desc) &lt; 0) {</div>
<div class="line">     perror(<span class="stringliteral">&quot;IAV_IOC_QUERY_DESC&quot;</span>);</div>
<div class="line">     <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"><span class="comment">// This is the canvas luma physical address</span></div>
<div class="line">phy_luma_addr = (phy_base + data_cap-&gt;y_addr_offset);</div>
<div class="line"><span class="comment">// This is the canvas luma virtual address</span></div>
<div class="line">virt_luma_addr = (virt_base + data_cap-&gt;y_addr_offset);</div>
<div class="line"><span class="comment">// This is the canvas chroma physical address</span></div>
<div class="line">phy_chroma_addr = (phy_base + data_cap-&gt;uv_addr_offset);</div>
<div class="line"><span class="comment">// This is the canvas chroma virtual address</span></div>
<div class="line">virt_chroma_addr = (virt_base + data_cap-&gt;uv_addr_offset;</div>
<div class="ttc" id="agroup__iav-ioctl-general-helper_html_gga3606b35b652dca594dc455dfb0b9f172ad1eb61f9c66c08ad24169d01d4d0ee9e"><div class="ttname"><a href="../../../driver/d3/de3/group__iav-ioctl-general-helper.html#gga3606b35b652dca594dc455dfb0b9f172ad1eb61f9c66c08ad24169d01d4d0ee9e">IAV_DESC_CANVAS</a></div><div class="ttdeci">IAV_DESC_CANVAS</div></div>
<div class="ttc" id="astructiav__querydesc_html"><div class="ttname"><a href="../../../library/d8/de5/structiav__querydesc.html">iav_querydesc</a></div></div>
<div class="ttc" id="astructiav__querydesc_html_aa73b12ace6ac7df824707a89ac4f91ff"><div class="ttname"><a href="../../../library/d8/de5/structiav__querydesc.html#aa73b12ace6ac7df824707a89ac4f91ff">iav_querydesc::qid</a></div><div class="ttdeci">enum iav_desc_id qid</div></div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="sys_mg_ioctl_interface"></a>
4. Input / Output Control Interface</h1>
<p >This chapter describes software migration and provides IOCTL differences between the CV2x SDK and the Cooper Linux SDK. The IOCTLs are as follows:</p><ul>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_query_info">4.1 IAV_IOC_QUERY_INFO</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_set_dsp_log">4.2 IAV_IOC_SET_DSP_LOG</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_drv_dsp_info">4.3 IAV_IOC_DRV_DSP_INFO</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_s_sys_res">4.4 IAV_IOC_SET_SYSTEM_RESOURCE</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_g_sys_res">4.5 IAV_IOC_GET_SYSTEM_RESOURCE</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_s_chan_cfg">4.6 IAV_IOC_SET_CHAN_CONFIG</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_g_chan_cfg">4.7 IAV_IOC_GET_CHAN_CONFIG</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_s_canvas_cfg">4.8 IAV_IOC_SET_CANVAS_CONFIG</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_g_canvas_cfg">4.9 IAV_IOC_GET_CANVAS_CONFIG</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_s_stream_res">4.10 IAV_IOC_SET_STREAM_RESOURCE</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_g_stream_res">4.11 IAV_IOC_GET_STREAM_RESOURCE</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_query_encmode">4.12 IAV_IOC_QUERY_ENC_MODE_CAP</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_enter_idle">4.13 IAV_IOC_ENTER_IDLE</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_s_mem_layout_res">4.14 IAV_IOC_SET_MEM_LAYOUT_RESOURCE</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_g_mem_layout_res">4.15 IAV_IOC_GET_MEM_LAYOUT_RESOURCE</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_query_mem_layout">4.16 IAV_IOC_QUERY_MEM_LAYOUT_INFO</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_query_desc">4.17 IAV_IOC_QUERY_DESC</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_cfg_video_proc">4.18 IAV_IOC_CFG_VIDEO_PROC</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_g_video_proc">4.19 IAV_IOC_GET_VIDEO_PROC</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_s_raw_enc_cfg">4.20 IAV_IOC_SET_RAW_ENC_CFG</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_s_raw_encode">4.21 IAV_IOC_SET_RAW_ENCODE</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_g_raw_encode">4.22 IAV_IOC_GET_RAW_ENCODE</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_s_stream_cfg">4.23 IAV_IOC_SET_STREAM_CONFIG</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_g_stream_cfg">4.24 IAV_IOC_GET_ STREAM_CONFIG</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_s_blur_insert">4.25 IAV_IOC_SET_BLUR_INSERT</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_g_blur_insert">4.26 IAV_IOC_GET_ BLUR_INSERT</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_fram_sync_proc">4.27 IAV_IOC_APPLY_FRAME_SYNC_PROC</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_query_memblock">4.28 IAV_IOC_QUERY_MEMBLOCK</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_efm_hsk_frm">4.29 IAV_IOC_EFM_HANDSHAKE_FRAME</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_efm_set_ext_pool">4.30 IAV_IOC_EFM_SET_EXT_POOL</a></li>
<li><a class="el" href="../../d9/dc6/page_sys_mg_cv2x.html#sys_mg_ioctl_interface_depre_or_unsupport_ioc">4.31 Depreciated or Unsupported IOCTLs</a></li>
</ul>
<h2><a class="anchor" id="sys_mg_ioctl_interface_query_info"></a>
4.1 IAV_IOC_QUERY_INFO</h2>
<p >In the Cooper Linux SDK, selected parameters are diminished in the IOCTL <b>IAV_IOC_QUERY_INFO</b>. The removed information ID is as follows:</p><ul>
<li>IAV_INFO_MULTI_COLOR_MASK</li>
</ul>
<h2><a class="anchor" id="sys_mg_ioctl_interface_set_dsp_log"></a>
4.2 IAV_IOC_SET_DSP_LOG</h2>
<p >The Cooper Linux SDK adds new parameters in the structure <code><a class="elRef" target="_blank" href="../../../library/de/d8d/structiav__dsplog__setup.html">iav_dsplog_setup</a></code>, as shown below. </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_structRef" target="_blank" href="../../../library/de/d8d/structiav__dsplog__setup.html">iav_dsplog_setup</a> {</div>
<div class="line">     .......</div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a>    <a class="code hl_variableRef" target="_blank" href="../../../library/de/d8d/structiav__dsplog__setup.html#aeda0d80adf68e40191314d801960905d">module</a>; <span class="comment">//  DSP modules map.</span></div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a>    <a class="code hl_variableRef" target="_blank" href="../../../library/de/d8d/structiav__dsplog__setup.html#abd5633cf5406eaf75fd3e3fc903f3aba">level</a>;  <span class="comment">//  DSP log level.</span></div>
<div class="line">                  <span class="comment">// Log level:</span></div>
<div class="line">                  <span class="comment">// 0 :  Silent</span></div>
<div class="line">                  <span class="comment">// 1 :  MINIMAL</span></div>
<div class="line">                  <span class="comment">// 2 :  NORMAL</span></div>
<div class="line">                  <span class="comment">// 3 :  VERBOSE</span></div>
<div class="line">                  <span class="comment">// 4 :  DEBUG</span></div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a>    <a class="code hl_variableRef" target="_blank" href="../../../library/de/d8d/structiav__dsplog__setup.html#abef421db8c3f55f9fa7c05727c4ab3e4">mask</a>;</div>
<div class="line">     .......</div>
<div class="line">};</div>
<div class="ttc" id="astructiav__dsplog__setup_html"><div class="ttname"><a href="../../../library/de/d8d/structiav__dsplog__setup.html">iav_dsplog_setup</a></div></div>
<div class="ttc" id="astructiav__dsplog__setup_html_abd5633cf5406eaf75fd3e3fc903f3aba"><div class="ttname"><a href="../../../library/de/d8d/structiav__dsplog__setup.html#abd5633cf5406eaf75fd3e3fc903f3aba">iav_dsplog_setup::level</a></div><div class="ttdeci">u32 level</div></div>
<div class="ttc" id="astructiav__dsplog__setup_html_abef421db8c3f55f9fa7c05727c4ab3e4"><div class="ttname"><a href="../../../library/de/d8d/structiav__dsplog__setup.html#abef421db8c3f55f9fa7c05727c4ab3e4">iav_dsplog_setup::mask</a></div><div class="ttdeci">u32 mask</div></div>
<div class="ttc" id="astructiav__dsplog__setup_html_aeda0d80adf68e40191314d801960905d"><div class="ttname"><a href="../../../library/de/d8d/structiav__dsplog__setup.html#aeda0d80adf68e40191314d801960905d">iav_dsplog_setup::module</a></div><div class="ttdeci">u32 module</div></div>
</div><!-- fragment --><h2><a class="anchor" id="sys_mg_ioctl_interface_drv_dsp_info"></a>
4.3 IAV_IOC_DRV_DSP_INFO</h2>
<p >The Cooper Linux SDK removes selected parameters in the structure <b><a class="elRef" target="_blank" href="../../../library/d4/ddb/structiav__driver__dsp__info.html">iav_driver_dsp_info</a></b>. In this structure, <code>dspout</code> and <code>dspin</code> are removed.</p>
<h2><a class="anchor" id="sys_mg_ioctl_interface_s_sys_res"></a>
4.4 IAV_IOC_SET_SYSTEM_RESOURCE</h2>
<p >The following lists the changes in the structure parameter <code><a class="elRef" target="_blank" href="../../../library/df/d3a/structiav__system__resource.html">iav_system_resource</a></code> for the IOCTL <b>IAV_IOC_SET_SYSTEM_RESOURCE</b>.<br  />
 The Cooper Linux SDK modifies parameters in the structure <b><a class="elRef" target="_blank" href="../../../library/d1/d04/structiav__img__scale__cfg.html">iav_img_scale_cfg</a></b>, as follows: </p><table class="doxtable">
<caption>Table 4-1. <a class="elRef" target="_blank" href="../../../library/d1/d04/structiav__img__scale__cfg.html">iav_img_scale_cfg</a> Structure Definition.</caption>
<tr>
<th>Parameter </th><th>Change </th><th>Notes </th></tr>
<tr>
<td>"src_buf_id" </td><td>Removed </td><td></td></tr>
<tr>
<td>"max_input_width" </td><td>Removed </td><td>Replaced with <code>max_input</code> </td></tr>
<tr>
<td>"max_output_width" </td><td>Removed </td><td>Replaced with <code>max_output</code> </td></tr>
<tr>
<td>"max_input" </td><td>Added </td><td>Specifies the maximum input </td></tr>
<tr>
<td>"max_output" </td><td>Added </td><td>Specifies the maximum output </td></tr>
<tr>
<td>"format" </td><td>Added </td><td>Specifies the image scale data format of the input and output image </td></tr>
<tr>
<td>"output" </td><td>Updated </td><td>Replaced with the <code><a class="elRef" target="_blank" href="../../../driver/de/d3a/structiav__rect.html">iav_rect</a></code> structure from the <code><a class="elRef" target="_blank" href="../../../driver/dc/d76/structiav__window.html">iav_window</a></code> structure to support image scaling to a dedicated offset instead of always 0x0 </td></tr>
</table>
<p >The Cooper Linux SDK modifies parameters in the structure <code><a class="elRef" target="_blank" href="../../../library/df/d3a/structiav__system__resource.html">iav_system_resource</a></code>, as follows: </p><table class="doxtable">
<caption>Table 4-2. <a class="elRef" target="_blank" href="../../../library/df/d3a/structiav__system__resource.html">iav_system_resource</a> Structure Definition.</caption>
<tr>
<th>Parameter </th><th>Change </th><th>Notes </th></tr>
<tr>
<td>"raw_pitch_in_bytes" </td><td>Removed </td><td></td></tr>
<tr>
<td>"total_memory_size" </td><td>Removed </td><td></td></tr>
<tr>
<td>"iso_type" </td><td>Removed </td><td></td></tr>
<tr>
<td>"is_stitched" </td><td>Removed </td><td></td></tr>
<tr>
<td>"vout_only" </td><td>Removed </td><td></td></tr>
<tr>
<td>"insert_blur_enable" </td><td>Removed </td><td></td></tr>
<tr>
<td>"enable_vin_precise_sync" </td><td>Removed </td><td></td></tr>
<tr>
<td>"back_pressure_margin" </td><td>Removed </td><td></td></tr>
<tr>
<td>"insert_mc_mask_enable" </td><td>Removed </td><td></td></tr>
<tr>
<td>"emirror_vout_sync_enable" </td><td>Removed </td><td></td></tr>
<tr>
<td>"custom_sei" </td><td>Removed </td><td></td></tr>
<tr>
<td>"blend_stitch_type" </td><td>Removed </td><td></td></tr>
<tr>
<td>"prev_bottom_repeat_disabled" </td><td>Removed </td><td></td></tr>
<tr>
<td>"dynamic_slice" </td><td>Removed </td><td></td></tr>
<tr>
<td>"blur_vout_mixer" </td><td>Removed </td><td></td></tr>
<tr>
<td>"enc_raw_fast_enable" </td><td>Removed </td><td></td></tr>
<tr>
<td>"enabled_canvas_frame_tag" </td><td>Removed </td><td></td></tr>
<tr>
<td>"raw_size" </td><td>Removed </td><td></td></tr>
<tr>
<td>"custom_sei_buf_size" </td><td>Removed </td><td></td></tr>
<tr>
<td>"custom_sei_buf_num" </td><td>Removed </td><td></td></tr>
<tr>
<td>"enc_dummy_latency" </td><td>Removed </td><td></td></tr>
<tr>
<td>"dsp_api_thread_freq" </td><td>Removed </td><td></td></tr>
<tr>
<td>"eis_delay_count" </td><td>Removed </td><td></td></tr>
<tr>
<td>"low_delay_state_switch_enable" </td><td>Removed </td><td></td></tr>
<tr>
<td>"debug_stitched" </td><td>Removed </td><td></td></tr>
<tr>
<td>"debug_skip_efm_mb" </td><td>Removed </td><td></td></tr>
<tr>
<td>"debug_vp_dram_priority" </td><td>Removed </td><td></td></tr>
<tr>
<td>"debug_hevc_hi_dram_ef_mode" </td><td>Removed </td><td></td></tr>
<tr>
<td>"debug_reset_seq_num_in_idle" </td><td>Removed </td><td></td></tr>
<tr>
<td>"stream" </td><td>Removed </td><td>The stream resource configuration is moved to the new IOCTL <b>IAV_IOC_SET_STREAM_RESOURCE</b> </td></tr>
<tr>
<td>"chan_cfg" </td><td>Removed </td><td>The channel resource configuration is moved to the new IOCTL <b>IAV_IOC_SET_CHAN_CONFIG</b> </td></tr>
<tr>
<td>"canvas_cfg" </td><td>Removed </td><td>The canvas resource configuration is moved to the new IOCTL <b>IAV_IOC_SET_CANVAS_CONFIG</b> </td></tr>
<tr>
<td>"chan_map" </td><td>Added </td><td>Specifies the channel map </td></tr>
<tr>
<td>"canvas_map" </td><td>Added </td><td>Specifies the canvas map </td></tr>
<tr>
<td>"stream_map" </td><td>Added </td><td>Specifies the stream map </td></tr>
<tr>
<td>"avc_pjpeg_size_MB_per_tile" </td><td>Added </td><td>Specifies the DRAM size of the advanced video coding (AVC) JPEG encoding buffer </td></tr>
<tr>
<td>"debug_max_chroma_radius" </td><td>Added </td><td>Specifies the maximum chroma radius </td></tr>
<tr>
<td>"debug_ce_off" </td><td>Added </td><td>Disables chroma enhancement (CE) </td></tr>
<tr>
<td>"debug_perf_opt_enable" </td><td>Added </td><td>Enables / disables DSP performance optimal mode </td></tr>
<tr>
<td>"debug_low_delay_enable" </td><td>Added </td><td>Enables / disables low delay mode for mode 0 </td></tr>
<tr>
<td>"debug_preblend_only_for_aisp" </td><td>Added </td><td>Enables preblend pass only for AISP (mode 9) </td></tr>
<tr>
<td>"vout_back_pressure_margin" </td><td>Added </td><td>Specifies the IDSP VOUT back pressure margin </td></tr>
<tr>
<td>"mjpeg_pjpeg_size_MB_per_tile" </td><td>Added </td><td>Specify the DRAM size of the MJPEG / PJPEG encoding buffer </td></tr>
<tr>
<td>"vin_frame_broken_dummy_repeat" </td><td>Added </td><td>Enables / disables last good frame repeat when a broken frame is detected </td></tr>
<tr>
<td>"debug_chan_group_tolerance" </td><td>Added </td><td>Specify the group sync tolerance value to adapt the end-of-frame (EOF) drift between sensors within a group </td></tr>
</table>
<h2><a class="anchor" id="sys_mg_ioctl_interface_g_sys_res"></a>
4.5 IAV_IOC_GET_SYSTEM_RESOURCE</h2>
<p >Refer to the structure parameter change from the IOCTL <b>IAV_IOC_SET_SYSTEM_RESOURCE</b>.</p>
<h2><a class="anchor" id="sys_mg_ioctl_interface_s_chan_cfg"></a>
4.6 IAV_IOC_SET_CHAN_CONFIG</h2>
<p >CV2x uses IOCTL <b>IAV_IOC_SET_SYSTEM_RESOURCE</b> to configure the channel resource. The Cooper Linux SDK adds a new IOCTL <b>IAV_IOC_SET_CHAN_CONFIG</b> to configure the channel resource; it uses the same structure, <code><a class="elRef" target="_blank" href="../../../library/d9/db4/structiav__chan__cfg.html">iav_chan_cfg</a></code>. The structure parameter changes for the Cooper Linux SDK are listed below: </p><table class="doxtable">
<caption>Table 4-3. <a class="elRef" target="_blank" href="../../../library/d9/db4/structiav__chan__cfg.html">iav_chan_cfg</a> Structure Definition.</caption>
<tr>
<th>Parameter </th><th>Change </th><th>Notes </th></tr>
<tr>
<td>"input" </td><td>Removed </td><td></td></tr>
<tr>
<td>"mctf_10bit_ref" </td><td>Removed </td><td></td></tr>
<tr>
<td>"main_burst_tile" </td><td>Removed </td><td></td></tr>
<tr>
<td>"vin_overflow_protection" </td><td>Removed </td><td></td></tr>
<tr>
<td>"low_delay_vin_vout" </td><td>Removed </td><td></td></tr>
<tr>
<td>"is_still_fusion_proc" </td><td>Removed </td><td></td></tr>
<tr>
<td>"mc_mask_buf_ds" </td><td>Removed </td><td></td></tr>
<tr>
<td>"raw_vflip" </td><td>Removed </td><td></td></tr>
<tr>
<td>"enable_tml_raw_packing" </td><td>Removed </td><td></td></tr>
<tr>
<td>"enable_tml_proc" </td><td>Removed </td><td></td></tr>
<tr>
<td>"is_mo_fusion_img_cfg_chan" </td><td>Removed </td><td></td></tr>
<tr>
<td>"raw_dsp_priv_dram" </td><td>Removed </td><td></td></tr>
<tr>
<td>"srcbuf_to_fusion" </td><td>Removed </td><td></td></tr>
<tr>
<td>"hdec_raw_format" </td><td>Removed </td><td></td></tr>
<tr>
<td>"orig_idsp_fps_hp" </td><td>Removed </td><td></td></tr>
<tr>
<td>"debug_stitch_tile_num" </td><td>Removed </td><td></td></tr>
<tr>
<td>"enable_group" </td><td>Renamed </td><td>New name: "group_enable" </td></tr>
<tr>
<td>"chan_id" </td><td>Added </td><td>Specifies channel ID </td></tr>
<tr>
<td>"c2y_burst_tile" </td><td>Removed </td><td>Enables / disables c2y burst tile mode </td></tr>
<tr>
<td>"y12_enable" </td><td>Added </td><td>Enables / disables c2y y12 output </td></tr>
<tr>
<td>"y12_cached_items" </td><td>Added </td><td>Queries with blocking call </td></tr>
<tr>
<td>"slice_cfg_enable" </td><td>Added </td><td>Enables / disables slice-related configurations </td></tr>
<tr>
<td>"slice_num" </td><td>Added </td><td>Specifies the channel's slice number, automatically calculated by IAV </td></tr>
<tr>
<td>"slice_width" </td><td>Added </td><td>Specifies the channel's slice width </td></tr>
<tr>
<td>"slice_num" </td><td>Added </td><td>Specifies the channel's slice number </td></tr>
<tr>
<td>"raw_padding_width" </td><td>Added </td><td>Specifies the channel's padding width for RAW data when IDSP stitching is used </td></tr>
<tr>
<td>"warp_padding_width" </td><td>Added </td><td>Specifies the channel's padding width for YUV data at warp stage when IDSP stitching is used </td></tr>
<tr>
<td>"high_perf_enable" </td><td>Added </td><td>Enables IDSP high performance mode (obsolete) </td></tr>
<tr>
<td>"ext_mem" </td><td>Added </td><td>Enables / disables external memory for raw </td></tr>
<tr>
<td>"chan_input_src" </td><td>Added </td><td>Sets the input source for the channel </td></tr>
<tr>
<td>"idsp_core_cfg_enable" </td><td>Added </td><td>Enables / disables customized IDSP core mode </td></tr>
<tr>
<td>"idsp_core_mode" </td><td>Added </td><td>Specifies IDSP core mode </td></tr>
<tr>
<td>"raw_src_chan" </td><td>Added </td><td>Specifies the EIS or dewarp channel's input source channel </td></tr>
<tr>
<td>"eis_delay_count" </td><td>Added </td><td>Updated from 3 bits to 7 bits to support greater EIS delay count values </td></tr>
<tr>
<td>"reuse_src_chan_iso_cfg" </td><td>Added </td><td>Enables duplicated 3A configurations from master channel </td></tr>
<tr>
<td>"pre_dec_enable" </td><td>Added </td><td>Enables decoding first to generate YUV before going through IDSP pipeline </td></tr>
<tr>
<td>"pre_dec_type" </td><td>Added </td><td>Specifies the decoder type when <code>pre_dec_enable</code> = 1 </td></tr>
<tr>
<td>"img_stats_enable_group" </td><td>Added </td><td>Enables grouping for 3A control </td></tr>
<tr>
<td>"img_stats_group_idx" </td><td>Added </td><td>Specifies the group index of 3A statistic data </td></tr>
<tr>
<td>"vin_roi_idx" </td><td>Added </td><td>Specifies the VIN region of interest (ROI) index, when VIN ROI is enabled </td></tr>
<tr>
<td>"ca_warp_enable" </td><td>Added </td><td>Enables / disables the client application (CA) warp function </td></tr>
<tr>
<td>"raw_slice_num" </td><td>Added </td><td>Specifies the capture slice number for RAW data </td></tr>
<tr>
<td>"raw_slice_cached_items" </td><td>Added </td><td>Specifies the RAW slice cached items to query RAW with blocking call </td></tr>
<tr>
<td>"raw_width" </td><td>Added </td><td>Read-only option to report the RAW width for the current channel </td></tr>
<tr>
<td>"raw_height" </td><td>Added </td><td>Read-only option to report the RAW height for the current channel </td></tr>
<tr>
<td>"isp_nn_enable" </td><td>Added </td><td>Enables / disables ISP NN, such as True Motion </td></tr>
<tr>
<td>"motion_output_enable" </td><td>Added </td><td>Enables / disables motion buffer output from IDSP channel </td></tr>
<tr>
<td>"motion_cached_items" </td><td>Added </td><td>Specifies the motion buffer cached items for user to query </td></tr>
<tr>
<td>"src_from_canvas_enable" </td><td>Added </td><td>Enables / disables channel input from the specified canvas, for multi-pass feature </td></tr>
<tr>
<td>"src_canvas_id" </td><td>Added </td><td>Specifies the source canvas ID, for multi-pass feature </td></tr>
<tr>
<td>"raw_fps" </td><td>Added </td><td>Specifies the RAW fps between VIN fps and IDSP fps </td></tr>
<tr>
<td>"raw_fps_hp" </td><td>Added </td><td>Specifies the high precision RAW fps between VIN fps and IDSP fps </td></tr>
<tr>
<td>"ver_slice_num" </td><td>Added </td><td>Specifies the IDSP vertical slice number </td></tr>
<tr>
<td>"raw_padding_height" </td><td>Added </td><td>Specifies the RAW DATA padding height, for multiple IDSP vertical slices feature </td></tr>
<tr>
<td>"idsp_bypass_enable" </td><td>Added </td><td>Enables / disables IDSP bypass to enable DSP to encode from YUV input directly </td></tr>
</table>
<h2><a class="anchor" id="sys_mg_ioctl_interface_g_chan_cfg"></a>
4.7 IAV_IOC_GET_CHAN_CONFIG</h2>
<p >Refer to the structure parameter change from the IOCTL <b>IAV_IOC_SET_CHAN_CONFIG</b>.</p>
<h2><a class="anchor" id="sys_mg_ioctl_interface_s_canvas_cfg"></a>
4.8 IAV_IOC_SET_CANVAS_CONFIG</h2>
<p >CV2x uses the IOCTL <b>IAV_IOC_SET_SYSTEM_RESOURCE</b> to configure canvas resources. The Cooper Linux SDK adds a new IOCTL <b>IAV_IOC_SET_CANVAS_CONFIG</b> to configure the canvas resources; it uses the same structure, <code><a class="elRef" target="_blank" href="../../../library/dd/d01/structiav__canvas__cfg.html">iav_canvas_cfg</a></code>. The structure parameter changes for the Cooper Linux SDK are listed below: </p><table class="doxtable">
<caption>Table 4-4. <a class="elRef" target="_blank" href="../../../library/dd/d01/structiav__canvas__cfg.html">iav_canvas_cfg</a> Structure Definition.</caption>
<tr>
<th>Parameter </th><th>Change </th><th>Notes </th></tr>
<tr>
<td>"dsp_priv_dram" </td><td>Removed </td><td></td></tr>
<tr>
<td>"order" </td><td>Removed </td><td></td></tr>
<tr>
<td>"is_broken" </td><td>Removed </td><td></td></tr>
<tr>
<td>"canvas_id" </td><td>Added </td><td>Specifies the canvas ID </td></tr>
<tr>
<td>"ext_mem" </td><td>Added </td><td>Specifies the external memory for the canvas </td></tr>
<tr>
<td>"blend_stitch_type" </td><td>Added </td><td>Specifies the blend type for multi-channel stitching </td></tr>
<tr>
<td>"clear_background" </td><td>Added </td><td>Enables / disables clearing the canvas data in the background color before preview </td></tr>
<tr>
<td>"buf_offset_enable" </td><td>Added </td><td>Enables / disables source buffer offset in a single-view canvas </td></tr>
<tr>
<td>"blur_enable" </td><td>Added </td><td>Enables / disables blur operations from the specific canvas </td></tr>
<tr>
<td>"max_blur_area_num" </td><td>Added </td><td>Specifies the maximum number of blur areas </td></tr>
<tr>
<td>"blend_copy_num_minus_1" </td><td>Added </td><td>Specifies the copy sides, minus 1, of the blending area </td></tr>
<tr>
<td>"blend_warp_enable" </td><td>Added </td><td>Enables / disables H-warp for blending overlap region </td></tr>
<tr>
<td>"blend_stitch_circular_margin" </td><td>Added </td><td>Specifies the overlap margin of the last blend channel and first blend channel </td></tr>
<tr>
<td>"enc_extra_padding_enable" </td><td>Added </td><td>Disables / enables extra padding for stream encoding </td></tr>
<tr>
<td>"hevc_width_align_enable" </td><td>Added </td><td>Disables / enables canvas width alignment to improve HEVC encoding efficiency </td></tr>
<tr>
<td>"low_delay_enable" </td><td>Added </td><td>Disables / enables low delay output with multiple IDSP veritical slices </td></tr>
</table>
<h2><a class="anchor" id="sys_mg_ioctl_interface_g_canvas_cfg"></a>
4.9 IAV_IOC_GET_CANVAS_CONFIG</h2>
<p >Refer to the structure parameter change from the IOCTL <b>IAV_IOC_SET_CANVAS_CONFIG</b>.</p>
<h2><a class="anchor" id="sys_mg_ioctl_interface_s_stream_res"></a>
4.10 IAV_IOC_SET_STREAM_RESOURCE</h2>
<p >CV2x uses the IOCTL <b>IAV_IOC_SET_SYSTEM_RESOURCE</b> to configure the stream resource. The Cooper Linux SDK adds a new IOCTL, <b>IAV_IOC_SET_STREAM_RESOURCE</b>, to configure the stream resource; it uses the same structure, <b><a class="elRef" target="_blank" href="../../../library/d0/d9e/structiav__stream__resource.html">iav_stream_resource</a></b>. The structure parameter change for the Cooper Linux SDK is as follows:</p><ul>
<li>Add the parameter <code>stream_id</code>. This is used to specify the stream ID.</li>
<li>Add the parameter <code>efm_ext_mem</code>. This is used to enable the user-managed external EFM frame buffer.</li>
<li>Add the parameter <code>hevc_width_align_enable</code>. This is used to enable the HEVC width alignment for encoding efficiency.</li>
<li>Add the parameter <code>custom_sei_possible</code>. This is used to enable the customized SEI insertion into the stream.</li>
<li>Add the parameter <code>custom_sei_buf_num</code>. This is used to specify the customized SEI buffer number for the stream.</li>
<li>Add the parameter <code>custom_sei_data_max_size</code>. This is used to specify the customized SEI buffer max size for the stream.</li>
</ul>
<h2><a class="anchor" id="sys_mg_ioctl_interface_g_stream_res"></a>
4.11 IAV_IOC_GET_STREAM_RESOURCE</h2>
<p >Refer to the structure parameter change from the IOCTL <b>IAV_IOC_SET_STREAM_RESOURCE</b>.</p>
<h2><a class="anchor" id="sys_mg_ioctl_interface_query_encmode"></a>
4.12 IAV_IOC_QUERY_ENC_MODE_CAP</h2>
<p >The following lists the changes in the structure parameter <code><a class="elRef" target="_blank" href="../../../library/d8/dd6/structiav__enc__mode__cap.html">iav_enc_mode_cap</a></code> for the IOCTL <b>IAV_IOC_QUERY_ENC_MODE_CAP:</b> </p><table class="doxtable">
<caption>Table 4-5. <a class="elRef" target="_blank" href="../../../library/d8/dd6/structiav__enc__mode__cap.html">iav_enc_mode_cap</a> Structure Definition.</caption>
<tr>
<th>Parameter </th><th>Change </th><th>Notes </th></tr>
<tr>
<td>"vout_swap_possible" </td><td>Removed </td><td></td></tr>
<tr>
<td>"mc_mask_possible" </td><td>Removed </td><td></td></tr>
</table>
<h2><a class="anchor" id="sys_mg_ioctl_interface_enter_idle"></a>
4.13 IAV_IOC_ENTER_IDLE</h2>
<p >The following lists the changes in the structure parameter <code><a class="elRef" target="_blank" href="../../../library/dd/dd8/structiav__dsp__boot__params.html">iav_dsp_boot_params</a></code> for the IOCTL <b>IAV_IOC_ENTER_IDLE</b>. </p><table class="doxtable">
<caption>Table 4-6. <a class="elRef" target="_blank" href="../../../library/dd/dd8/structiav__dsp__boot__params.html">iav_dsp_boot_params</a> Structure Definition.</caption>
<tr>
<th>Parameter </th><th>Change </th><th>Notes </th></tr>
<tr>
<td>"vout_profile" </td><td>Removed </td><td></td></tr>
<tr>
<td>"osd_profile" </td><td>Removed </td><td></td></tr>
<tr>
<td>"vout_profile_flag" </td><td>Removed </td><td></td></tr>
<tr>
<td>"vout_osd_profile_flag" </td><td>Removed </td><td></td></tr>
<tr>
<td>"dsp_private_dram_flag" </td><td>Removed </td><td></td></tr>
<tr>
<td>"dsp_max_fb_num_flag" </td><td>Removed </td><td></td></tr>
<tr>
<td>"vout_underflow_prevention_flag" </td><td>Removed </td><td></td></tr>
<tr>
<td>"support_vout_rotate_flag" </td><td>Removed </td><td></td></tr>
<tr>
<td>"vout_back_pressure_margin_flag" </td><td>Removed </td><td></td></tr>
<tr>
<td>"dsp_max_fb_num" </td><td>Removed </td><td></td></tr>
<tr>
<td>"vout_underflow_prevention" </td><td>Removed </td><td></td></tr>
<tr>
<td>"vout0_support_rotate" </td><td>Removed </td><td></td></tr>
<tr>
<td>"vout1_support_rotate" </td><td>Removed </td><td></td></tr>
<tr>
<td>"vout0_back_pressure_margin" </td><td>Removed </td><td></td></tr>
<tr>
<td>"vout1_back_pressure_margin" </td><td>Removed </td><td></td></tr>
<tr>
<td>"bsh_no_reset" </td><td>Removed </td><td></td></tr>
<tr>
<td>"bsh_no_reset_flag" </td><td>Removed </td><td></td></tr>
<tr>
<td>"vout_status_msg_flag" </td><td>Removed </td><td></td></tr>
<tr>
<td>"vout_status_msg" </td><td>Removed </td><td></td></tr>
<tr>
<td>"dsp_private_dram_addr" </td><td>Removed </td><td></td></tr>
<tr>
<td>"dsp_private_dram_size" </td><td>Removed </td><td></td></tr>
<tr>
<td>"vout_osd_rescale_flag" </td><td>Added </td><td>Configures <code>vout_osd_rescale_disable</code> </td></tr>
<tr>
<td>"vout_osd_rescale_disable" </td><td>Added </td><td>Disables VOUT OSD rescale </td></tr>
<tr>
<td>"vout_possible_map_flag" </td><td>Added </td><td>Configures <code>vout_possible_map</code> </td></tr>
<tr>
<td>"vout_possible_map" </td><td>Added </td><td>Possible VOUT map when booting DSP </td></tr>
</table>
<h2><a class="anchor" id="sys_mg_ioctl_interface_s_mem_layout_res"></a>
4.14 IAV_IOC_SET_MEM_LAYOUT_RESOURCE</h2>
<p >The following lists the changes in the structure parameter <code><a class="elRef" target="_blank" href="../../../library/da/dca/structiav__mem__cfg__chan.html">iav_mem_cfg_chan</a></code> for the IOCTL <b>IAV_IOC_SET_MEM_LAYOUT_RESOURCE</b>. </p><table class="doxtable">
<caption>Table 4-7. <a class="elRef" target="_blank" href="../../../library/da/dca/structiav__mem__cfg__chan.html">iav_mem_cfg_chan</a> Structure Definition.</caption>
<tr>
<th>Parameter </th><th>Change </th><th>Notes </th></tr>
<tr>
<td>"mc_mask_possible" </td><td>Removed </td><td></td></tr>
<tr>
<td>"mc_mask_buf_max_num" </td><td>Removed </td><td></td></tr>
<tr>
<td>"mc_mask_buf_ds" </td><td>Removed </td><td></td></tr>
<tr>
<td>"tfc_possible" </td><td>Removed </td><td></td></tr>
<tr>
<td>"tfc_buf_max_num" </td><td>Removed </td><td></td></tr>
</table>
<h2><a class="anchor" id="sys_mg_ioctl_interface_g_mem_layout_res"></a>
4.15 IAV_IOC_GET_MEM_LAYOUT_RESOURCE</h2>
<p >Refer to the structure parameter change from the IOCTL <b>IAV_IOC_SET_MEM_LAYOUT_RESOURCE</b>.</p>
<h2><a class="anchor" id="sys_mg_ioctl_interface_query_mem_layout"></a>
4.16 IAV_IOC_QUERY_MEM_LAYOUT_INFO</h2>
<p >The following lists the changes in the structure parameter <code><a class="elRef" target="_blank" href="../../../library/d5/df0/structiav__mem__layout__info.html">iav_mem_layout_info</a></code> for the IOCTL <b>IAV_IOC_QUERY_MEM_LAYOUT_INFO</b>. </p><table class="doxtable">
<caption>Table 4-8. <a class="elRef" target="_blank" href="../../../library/d5/df0/structiav__mem__layout__info.html">iav_mem_layout_info</a> Structure Definition.</caption>
<tr>
<th>Parameter </th><th>Change </th><th>Notes </th></tr>
<tr>
<td>"mc_mask_layout" </td><td>Removed </td><td></td></tr>
<tr>
<td>"tfc_layout" </td><td>Removed </td><td></td></tr>
<tr>
<td>"raw_pool_layout" </td><td>Added </td><td>Queries each VIN's memory layout in raw pool </td></tr>
</table>
<p >The definition of the structure <b><a class="elRef" target="_blank" href="../../../library/d6/d27/structiav__mem__layout__raw__pool.html">iav_mem_layout_raw_pool</a></b> is shown below: </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_structRef" target="_blank" href="../../../library/d6/d27/structiav__mem__layout__raw__pool.html">iav_mem_layout_raw_pool</a> {</div>
<div class="line">     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code hl_variableRef" target="_blank" href="../../../library/d6/d27/structiav__mem__layout__raw__pool.html#a5ea707d750b2aaa86d0311f93deeafff">phys_base</a>;   <span class="comment">// Physical memory base address.</span></div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a> <a class="code hl_variableRef" target="_blank" href="../../../library/d6/d27/structiav__mem__layout__raw__pool.html#ad88bcfd65d92b5aa61232d6765d78365">total_user_size</a>;       <span class="comment">// Total memory size for user configuration.</span></div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a> <a class="code hl_variableRef" target="_blank" href="../../../library/d6/d27/structiav__mem__layout__raw__pool.html#ad1221508cfc76342b087d11d7717f090">total_size</a>;                <span class="comment">// Total memory size.</span></div>
<div class="line">     <span class="keyword">struct </span><a class="code hl_structRef" target="_blank" href="../../../library/df/d2e/structiav__mem__layout.html">iav_mem_layout</a> <a class="code hl_variableRef" target="_blank" href="../../../library/d6/d27/structiav__mem__layout__raw__pool.html#a8782bac11623f5def2d2bc8444d5072e">buf_layout</a>[<a class="code hl_defineRef" target="_blank" href="../../../library/d3/de3/group__iav-ioctl-general-helper.html#ga6467a620ccc4bef8e8aefc5156233c42">IAV_MAX_REAL_VIN_NUM</a>];    <span class="comment">// Buffer layout info.</span></div>
<div class="line">};</div>
<div class="ttc" id="agroup__iav-ioctl-general-helper_html_ga6467a620ccc4bef8e8aefc5156233c42"><div class="ttname"><a href="../../../library/d3/de3/group__iav-ioctl-general-helper.html#ga6467a620ccc4bef8e8aefc5156233c42">IAV_MAX_REAL_VIN_NUM</a></div><div class="ttdeci">#define IAV_MAX_REAL_VIN_NUM</div></div>
<div class="ttc" id="astructiav__mem__layout__raw__pool_html"><div class="ttname"><a href="../../../library/d6/d27/structiav__mem__layout__raw__pool.html">iav_mem_layout_raw_pool</a></div></div>
<div class="ttc" id="astructiav__mem__layout__raw__pool_html_a5ea707d750b2aaa86d0311f93deeafff"><div class="ttname"><a href="../../../library/d6/d27/structiav__mem__layout__raw__pool.html#a5ea707d750b2aaa86d0311f93deeafff">iav_mem_layout_raw_pool::phys_base</a></div><div class="ttdeci">unsigned long phys_base</div></div>
<div class="ttc" id="astructiav__mem__layout__raw__pool_html_a8782bac11623f5def2d2bc8444d5072e"><div class="ttname"><a href="../../../library/d6/d27/structiav__mem__layout__raw__pool.html#a8782bac11623f5def2d2bc8444d5072e">iav_mem_layout_raw_pool::buf_layout</a></div><div class="ttdeci">struct iav_mem_layout buf_layout[IAV_MAX_REAL_VIN_NUM]</div></div>
<div class="ttc" id="astructiav__mem__layout__raw__pool_html_ad1221508cfc76342b087d11d7717f090"><div class="ttname"><a href="../../../library/d6/d27/structiav__mem__layout__raw__pool.html#ad1221508cfc76342b087d11d7717f090">iav_mem_layout_raw_pool::total_size</a></div><div class="ttdeci">u32 total_size</div></div>
<div class="ttc" id="astructiav__mem__layout__raw__pool_html_ad88bcfd65d92b5aa61232d6765d78365"><div class="ttname"><a href="../../../library/d6/d27/structiav__mem__layout__raw__pool.html#ad88bcfd65d92b5aa61232d6765d78365">iav_mem_layout_raw_pool::total_user_size</a></div><div class="ttdeci">u32 total_user_size</div></div>
<div class="ttc" id="astructiav__mem__layout_html"><div class="ttname"><a href="../../../library/df/d2e/structiav__mem__layout.html">iav_mem_layout</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="sys_mg_ioctl_interface_query_desc"></a>
4.17 IAV_IOC_QUERY_DESC</h2>
<p >The following lists the changes in the structure parameter <code><a class="elRef" target="_blank" href="../../../library/d8/de5/structiav__querydesc.html">iav_querydesc</a></code> for the IOCTL <b>IAV_IOC_QUERY_DESC</b>. </p><table class="doxtable">
<caption>Table 4-9. <a class="elRef" target="_blank" href="../../../library/d8/de5/structiav__querydesc.html">iav_querydesc</a> Structure Definition.</caption>
<tr>
<th>Parameter </th><th>Change </th><th>Notes </th></tr>
<tr>
<td>"tml" </td><td>Removed </td><td></td></tr>
<tr>
<td>"dis" </td><td>Removed </td><td></td></tr>
<tr>
<td>"y12" </td><td>Added </td><td>Queries a single Y12 image </td></tr>
<tr>
<td>"raw" </td><td>Updated </td><td>Added parameter <code>delay_frames</code> for EIS delay frames to query raw data from this channel </td></tr>
<tr>
<td>"blend" </td><td>Updated </td><td>Added parameter <code>canvas_id</code> to query canvas-based blending options </td></tr>
<tr>
<td>"statis" </td><td>Updated </td><td>Added parameter <code>data2_addr_offset_valid</code> and <code>data2_addr_offset</code> to support the frame's second status for the second core, when dual-core spatial encode mode is used. </td></tr>
<tr>
<td>"custom_aisp" </td><td>Added </td><td>Queries custom AISP buffer information </td></tr>
<tr>
<td>"raw_slice" </td><td>Updated </td><td>Queries RAW slice buffer information </td></tr>
<tr>
<td>"motion" </td><td>Added </td><td>Queries a motion data from the IDSP channel </td></tr>
</table>
<h2><a class="anchor" id="sys_mg_ioctl_interface_cfg_video_proc"></a>
4.18 IAV_IOC_CFG_VIDEO_PROC</h2>
<p >The following lists the changes in the structure parameter <code><a class="elRef" target="_blank" href="../../../library/d2/d92/structiav__video__proc.html">iav_video_proc</a></code> for the IOCTL <b>IAV_IOC_CFG_VIDEO_PROC</b>. </p><table class="doxtable">
<caption>Table 4-10. <a class="elRef" target="_blank" href="../../../library/d2/d92/structiav__video__proc.html">iav_video_proc</a> Structure Definition.</caption>
<tr>
<th>Parameter </th><th>Change </th><th>Notes </th></tr>
<tr>
<td>"canvas_order" </td><td>Removed </td><td></td></tr>
<tr>
<td>"canvas_dptz" </td><td>Removed </td><td></td></tr>
<tr>
<td>"blend_warp" </td><td>Added </td><td></td></tr>
</table>
<h2><a class="anchor" id="sys_mg_ioctl_interface_g_video_proc"></a>
4.19 IAV_IOC_GET_VIDEO_PROC</h2>
<p >Refer to the structure parameter change from the IOCTL <b>IAV_IOC_CFG_VIDEO_PROC</b>.</p>
<h2><a class="anchor" id="sys_mg_ioctl_interface_s_raw_enc_cfg"></a>
4.20 IAV_IOC_SET_RAW_ENC_CFG</h2>
<p >CV2x uses the IOCTL <b>IAV_IOC_SET_RAW_ENCODE</b> to configure and perform raw encode. The IOCTL <b>IAV_IOC_SET_RAW_ENC_CFG</b> is added in the Cooper Linux SDK to configure the raw encode first. Then, it uses <b>IAV_IOC_SET_RAW_ENCODE</b> to perform raw encode and adds the structure <b><a class="elRef" target="_blank" href="../../../library/dc/db6/structiav__raw__enc__cfg.html">iav_raw_enc_cfg</a></b>. New parameters in the structure <b><a class="elRef" target="_blank" href="../../../library/dc/db6/structiav__raw__enc__cfg.html">iav_raw_enc_cfg</a></b> are shown below: </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_structRef" target="_blank" href="../../../library/dc/db6/structiav__raw__enc__cfg.html">iav_raw_enc_cfg</a> {</div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#gaed742c436da53c1080638ce6ef7d13de">u8</a> <a class="code hl_variableRef" target="_blank" href="../../../library/dc/db6/structiav__raw__enc__cfg.html#ad48d706a7ccf63d2518eb8f6f8b4d3ee">vinc_id</a>;                <span class="comment">// VIN Control ID</span></div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#gaed742c436da53c1080638ce6ef7d13de">u8</a> <a class="code hl_variableRef" target="_blank" href="../../../library/dc/db6/structiav__raw__enc__cfg.html#a09231b55490ecef4330af8b002c8c373">total_buf_num</a>;      <span class="comment">// Data total buf num</span></div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#gaed742c436da53c1080638ce6ef7d13de">u8</a> <a class="code hl_variableRef" target="_blank" href="../../../driver/df/dc0/group__IAV.html#ga60ef8bae6f4bb3dc7582a4ff861f2d36">reserved</a>[2];</div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a> <a class="code hl_variableRef" target="_blank" href="../../../library/dc/db6/structiav__raw__enc__cfg.html#a6f1d5bb48e5e918d7918fe33b8fb52ac">raw_pitch</a> : 16;        <span class="comment">// RAW data pitch</span></div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a> <a class="code hl_variableRef" target="_blank" href="../../../library/dc/db6/structiav__raw__enc__cfg.html#a3f44cdf6a01b1ed33ee2b294852bc667">raw_hdec_pitch</a> : 16; <span class="comment">// HDEC data pitch</span></div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a> <a class="code hl_variableRef" target="_blank" href="../../../library/dc/db6/structiav__raw__enc__cfg.html#a5812a880ef7a7bcd41f4506138ff782e">raw_width</a> : 16;        <span class="comment">// RAW data width</span></div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a> <a class="code hl_variableRef" target="_blank" href="../../../library/dc/db6/structiav__raw__enc__cfg.html#ae7c0bbc1241ec9a23c4ffd0755f0c149">raw_hdec_width</a> : 16; <span class="comment">// HDEC data width</span></div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a> <a class="code hl_variableRef" target="_blank" href="../../../library/dc/db6/structiav__raw__enc__cfg.html#a371a617a9bb42977a24e8cceb7f28d1e">raw_height</a> : 16;       <span class="comment">// RAW data height</span></div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a> <a class="code hl_variableRef" target="_blank" href="../../../library/dc/db6/structiav__raw__enc__cfg.html#a243a4bc34640c52bdcd3b3807e0bc88a">raw_hdec_height</a> : 16; <span class="comment">// HDEC data height</span></div>
<div class="line">     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code hl_variableRef" target="_blank" href="../../../library/dc/db6/structiav__raw__enc__cfg.html#a9bff1f81783f904d7caa7edf3c9e4828">raw_buf_addr</a>;    <span class="comment">// RAW data DRAM addr</span></div>
<div class="line">     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code hl_variableRef" target="_blank" href="../../../library/dc/db6/structiav__raw__enc__cfg.html#a7bc625ecd09c4d6672f5f52022238898">raw_hdec_buf_addr</a>; <span class="comment">// HDEC data DRAM addr</span></div>
<div class="line">};</div>
<div class="ttc" id="agroup__IAV_html_ga60ef8bae6f4bb3dc7582a4ff861f2d36"><div class="ttname"><a href="../../../driver/df/dc0/group__IAV.html#ga60ef8bae6f4bb3dc7582a4ff861f2d36">reserved</a></div><div class="ttdeci">u16 reserved</div></div>
<div class="ttc" id="agroup__iav-typedef_html_gaed742c436da53c1080638ce6ef7d13de"><div class="ttname"><a href="../../../driver/d0/dfa/group__iav-typedef.html#gaed742c436da53c1080638ce6ef7d13de">u8</a></div><div class="ttdeci">unsigned char u8</div></div>
<div class="ttc" id="astructiav__raw__enc__cfg_html"><div class="ttname"><a href="../../../library/dc/db6/structiav__raw__enc__cfg.html">iav_raw_enc_cfg</a></div></div>
<div class="ttc" id="astructiav__raw__enc__cfg_html_a09231b55490ecef4330af8b002c8c373"><div class="ttname"><a href="../../../library/dc/db6/structiav__raw__enc__cfg.html#a09231b55490ecef4330af8b002c8c373">iav_raw_enc_cfg::total_buf_num</a></div><div class="ttdeci">u8 total_buf_num</div></div>
<div class="ttc" id="astructiav__raw__enc__cfg_html_a243a4bc34640c52bdcd3b3807e0bc88a"><div class="ttname"><a href="../../../library/dc/db6/structiav__raw__enc__cfg.html#a243a4bc34640c52bdcd3b3807e0bc88a">iav_raw_enc_cfg::raw_hdec_height</a></div><div class="ttdeci">u16 raw_hdec_height</div></div>
<div class="ttc" id="astructiav__raw__enc__cfg_html_a371a617a9bb42977a24e8cceb7f28d1e"><div class="ttname"><a href="../../../library/dc/db6/structiav__raw__enc__cfg.html#a371a617a9bb42977a24e8cceb7f28d1e">iav_raw_enc_cfg::raw_height</a></div><div class="ttdeci">u16 raw_height</div></div>
<div class="ttc" id="astructiav__raw__enc__cfg_html_a3f44cdf6a01b1ed33ee2b294852bc667"><div class="ttname"><a href="../../../library/dc/db6/structiav__raw__enc__cfg.html#a3f44cdf6a01b1ed33ee2b294852bc667">iav_raw_enc_cfg::raw_hdec_pitch</a></div><div class="ttdeci">u16 raw_hdec_pitch</div></div>
<div class="ttc" id="astructiav__raw__enc__cfg_html_a5812a880ef7a7bcd41f4506138ff782e"><div class="ttname"><a href="../../../library/dc/db6/structiav__raw__enc__cfg.html#a5812a880ef7a7bcd41f4506138ff782e">iav_raw_enc_cfg::raw_width</a></div><div class="ttdeci">u16 raw_width</div></div>
<div class="ttc" id="astructiav__raw__enc__cfg_html_a6f1d5bb48e5e918d7918fe33b8fb52ac"><div class="ttname"><a href="../../../library/dc/db6/structiav__raw__enc__cfg.html#a6f1d5bb48e5e918d7918fe33b8fb52ac">iav_raw_enc_cfg::raw_pitch</a></div><div class="ttdeci">u16 raw_pitch</div></div>
<div class="ttc" id="astructiav__raw__enc__cfg_html_a7bc625ecd09c4d6672f5f52022238898"><div class="ttname"><a href="../../../library/dc/db6/structiav__raw__enc__cfg.html#a7bc625ecd09c4d6672f5f52022238898">iav_raw_enc_cfg::raw_hdec_buf_addr</a></div><div class="ttdeci">unsigned long raw_hdec_buf_addr</div></div>
<div class="ttc" id="astructiav__raw__enc__cfg_html_a9bff1f81783f904d7caa7edf3c9e4828"><div class="ttname"><a href="../../../library/dc/db6/structiav__raw__enc__cfg.html#a9bff1f81783f904d7caa7edf3c9e4828">iav_raw_enc_cfg::raw_buf_addr</a></div><div class="ttdeci">unsigned long raw_buf_addr</div></div>
<div class="ttc" id="astructiav__raw__enc__cfg_html_ad48d706a7ccf63d2518eb8f6f8b4d3ee"><div class="ttname"><a href="../../../library/dc/db6/structiav__raw__enc__cfg.html#ad48d706a7ccf63d2518eb8f6f8b4d3ee">iav_raw_enc_cfg::vinc_id</a></div><div class="ttdeci">u8 vinc_id</div></div>
<div class="ttc" id="astructiav__raw__enc__cfg_html_ae7c0bbc1241ec9a23c4ffd0755f0c149"><div class="ttname"><a href="../../../library/dc/db6/structiav__raw__enc__cfg.html#ae7c0bbc1241ec9a23c4ffd0755f0c149">iav_raw_enc_cfg::raw_hdec_width</a></div><div class="ttdeci">u16 raw_hdec_width</div></div>
</div><!-- fragment --><h2><a class="anchor" id="sys_mg_ioctl_interface_s_raw_encode"></a>
4.21 IAV_IOC_SET_RAW_ENCODE</h2>
<p >The following lists the changes in the structure parameter <code><a class="elRef" target="_blank" href="../../../library/d2/d5e/structiav__raw__enc__setup.html">iav_raw_enc_setup</a></code> for the IOCTL <b>IAV_IOC_SET_RAW_ENCODE</b>. The memory configuration parameters are moved to the IOCTL <b>IAV_IOC_SET_RAW_ENC_CFG</b>. </p><table class="doxtable">
<caption>Table 4-11. <a class="elRef" target="_blank" href="../../../library/d2/d5e/structiav__raw__enc__setup.html">iav_raw_enc_setup</a> Structure Definition.</caption>
<tr>
<th>Parameter </th><th>Change </th><th>Notes </th></tr>
<tr>
<td>"raw_frame_size" </td><td>Removed </td><td></td></tr>
<tr>
<td>"raw_hdec_size" </td><td>Removed </td><td></td></tr>
<tr>
<td>"preblend_size" </td><td>Removed </td><td></td></tr>
<tr>
<td>"pitch" </td><td>Removed </td><td></td></tr>
<tr>
<td>"raw_hdec_dpitch" </td><td>Removed </td><td></td></tr>
<tr>
<td>"preblend_dpitch" </td><td>Removed </td><td></td></tr>
<tr>
<td>"raw_frame_num" </td><td>Removed </td><td></td></tr>
<tr>
<td>"use_ext_buf" </td><td>Removed </td><td></td></tr>
<tr>
<td>"raw_format" </td><td>Removed </td><td></td></tr>
<tr>
<td>"hdec_raw_format" </td><td>Removed </td><td></td></tr>
<tr>
<td>"raw_daddr_offset" </td><td>Removed </td><td></td></tr>
<tr>
<td>"raw_hdec_daddr_offset" </td><td>Removed </td><td></td></tr>
<tr>
<td>"preblend_daddr_offset" </td><td>Removed </td><td></td></tr>
<tr>
<td>"ext_buf_addr" </td><td>Removed </td><td></td></tr>
<tr>
<td>"raw_daddr_buf_idx" </td><td>Added </td><td>Specifies the RAW data buffer index </td></tr>
<tr>
<td>"raw_hdec_daddr_buf_idx" </td><td>Added </td><td>Specifies the HDEC data buffer index </td></tr>
<tr>
<td>"mono_pts" </td><td>Added </td><td>Synchronizes with IDSP configurations for the EIS feature </td></tr>
</table>
<h2><a class="anchor" id="sys_mg_ioctl_interface_g_raw_encode"></a>
4.22 IAV_IOC_GET_RAW_ENCODE</h2>
<p >Refer to the structure parameter change from the IOCTL <b>IAV_IOC_SET_RAW_ENCODE</b>.</p>
<h2><a class="anchor" id="sys_mg_ioctl_interface_s_stream_cfg"></a>
4.23 IAV_IOC_SET_STREAM_CONFIG</h2>
<p >The following lists the changes in the structure parameter <code><a class="elRef" target="_blank" href="../../../library/d1/df3/structiav__stream__cfg.html">iav_stream_cfg</a></code> for the IOCTL <b>IAV_IOC_SET_STREAM_CONFIG</b>. </p><table class="doxtable">
<caption>Table 4-12. <a class="elRef" target="_blank" href="../../../library/d1/df3/structiav__stream__cfg.html">iav_stream_cfg</a> Structure Definition.</caption>
<tr>
<th>Parameter </th><th>Change </th><th>Notes </th></tr>
<tr>
<td>"format" </td><td>Updated </td><td>The parameter <code>enc_src_map</code> in the structure <code><a class="elRef" target="_blank" href="../../../library/dd/d8d/structiav__stream__format.html">iav_stream_format</a></code> is extended from 16 bits to 32 bits due to the support of up to 20 streams </td></tr>
<tr>
<td>"custom_sei" </td><td>Added </td><td>The new structure to specify the customized SEI configuration </td></tr>
</table>
<h2><a class="anchor" id="sys_mg_ioctl_interface_g_stream_cfg"></a>
4.24 IAV_IOC_GET_ STREAM_CONFIG</h2>
<p >Refer to the structure parameter change from the IOCTL <b>IAV_IOC_SET_STREAM_CONFIG</b>.</p>
<h2><a class="anchor" id="sys_mg_ioctl_interface_s_blur_insert"></a>
4.25 IAV_IOC_SET_BLUR_INSERT</h2>
<p >The following lists the changes in the structure parameter <code><a class="elRef" target="_blank" href="../../../library/d3/dcd/structiav__blur__insert.html">iav_blur_insert</a></code> for the IOCTL <b>IAV_IOC_SET_BLUR_INSERT</b>. </p><table class="doxtable">
<caption>Table 4-13. <a class="elRef" target="_blank" href="../../../library/d3/dcd/structiav__blur__insert.html">iav_blur_insert</a> Structure Definition.</caption>
<tr>
<th>Parameter </th><th>Change </th><th>Notes </th></tr>
<tr>
<td>"insert_always" </td><td>Removed </td><td>The blur will always insert into the stream input canvas; there no option to turn it off </td></tr>
<tr>
<td>"area" </td><td>Updated </td><td>The <code><a class="elRef" target="_blank" href="../../../library/d2/d61/structiav__blur__area.html">iav_blur_area</a></code> structure update information is listed in the following table </td></tr>
</table>
<p>The table below lists the structure parameter <b><a class="elRef" target="_blank" href="../../../library/d2/d61/structiav__blur__area.html">iav_blur_area</a></b> inside structure <b><a class="elRef" target="_blank" href="../../../library/d3/dcd/structiav__blur__insert.html">iav_blur_insert</a></b>. </p><table class="doxtable">
<caption>Table 4-14. <a class="elRef" target="_blank" href="../../../library/d2/d61/structiav__blur__area.html">iav_blur_area</a> Structure Definition.</caption>
<tr>
<th>Parameter </th><th>Change </th><th>Notes </th></tr>
<tr>
<td>"color_enable" </td><td>Added </td><td>Specifies whether the blur color is enabled or not for this blur area </td></tr>
<tr>
<td>"is_blocky" </td><td>Added </td><td>Specifies the blur effect. 0: Blur without blocky effect. 1: Blur with blocky effect </td></tr>
<tr>
<td>"coeff" </td><td>Added </td><td>Specifies the blur coefficients, range 0 ~ 3 when <code>is_blocky</code> is 0 and range 0 ~ 2 when <code>is_blocky</code> is 1. 0: Weakest blur coefficients </td></tr>
</table>
<h2><a class="anchor" id="sys_mg_ioctl_interface_g_blur_insert"></a>
4.26 IAV_IOC_GET_BLUR_INSERT</h2>
<p >Refer to the structure parameter change from the IOCTL <b>IAV_IOC_SET_BLUR_INSERT</b>.</p>
<h2><a class="anchor" id="sys_mg_ioctl_interface_fram_sync_proc"></a>
4.27 IAV_IOC_APPLY_FRAME_SYNC_PROC</h2>
<p >The following lists the changes in the structure parameter <code><a class="elRef" target="_blank" href="../../../library/d2/dde/structiav__apply__frame__sync.html">iav_apply_frame_sync</a></code> for the IOCTL <b>IAV_IOC_APPLY_FRAME_SYNC_PROC</b>. </p><table class="doxtable">
<caption>Table 4-15. <a class="elRef" target="_blank" href="../../../library/d2/dde/structiav__apply__frame__sync.html">iav_apply_frame_sync</a> Structure Definition.</caption>
<tr>
<th>Parameter </th><th>Change </th><th>Notes </th></tr>
<tr>
<td>"stream_updated_map" </td><td>Updated </td><td>The parameter <code>stream_updated_map</code> is extended from 16 bits to 28 bits, due to the support of up to 20 streams </td></tr>
</table>
<h2><a class="anchor" id="sys_mg_ioctl_interface_query_memblock"></a>
4.28 IAV_IOC_QUERY_MEMBLOCK</h2>
<p >Query IAV_MEM_IMG_FIFO is removed from enum <b>iav_mem_id</b>. Users can now only query partition or canvas memory block information. The following lists the changes in the enumeration parameter <code>iav_mem_part_id</code> for the IOCTL <b>IAV_IOC_QUERY_MEMBLOCK</b>. </p><table class="doxtable">
<caption>Table 4-16. iav_mem_part_id Enumeration Definition.</caption>
<tr>
<th>Parameter </th><th>Change </th><th>Notes </th></tr>
<tr>
<td>"IAV_PART_IMG_STATIS" </td><td>Removed </td><td></td></tr>
<tr>
<td>"IAV_PART_DIS_CTB_STATIS" </td><td>Removed </td><td></td></tr>
<tr>
<td>"IAV_PART_H26X_SCALELIST" </td><td>Renamed </td><td>HEVC and AVC scalelist partition </td></tr>
<tr>
<td>"IAV_PART_DEC_BSB" </td><td>Added </td><td>Decoder BSB buffer partition </td></tr>
<tr>
<td>"IAV_PART_DSP_CV" </td><td>Added </td><td>Partition ID for DSP and CV internal share </td></tr>
<tr>
<td>"IAV_PART_VOUT0_FB" </td><td>Added </td><td>VOUT0 frame buffer partition </td></tr>
<tr>
<td>"IAV_PART_VOUT1_FB" </td><td>Added </td><td>VOUT1 frame buffer partition </td></tr>
<tr>
<td>"IAV_PART_VOUT2_FB" </td><td>Added </td><td>VOUT2 frame buffer partition </td></tr>
</table>
<h2><a class="anchor" id="sys_mg_ioctl_interface_efm_hsk_frm"></a>
4.29 IAV_IOC_EFM_HANDSHAKE_FRAME</h2>
<p >The following lists the changes in the structure parameter <code><a class="elRef" target="_blank" href="../../../library/d1/d2c/structiav__efm__handshake__frame.html">iav_efm_handshake_frame</a></code> for the IOCTL <b>IAV_IOC_EFM_HANDSHAKE_FRAME</b>. </p><table class="doxtable">
<caption>Table 4-17. <a class="elRef" target="_blank" href="../../../library/d1/d2c/structiav__efm__handshake__frame.html">iav_efm_handshake_frame</a> Structure Definition.</caption>
<tr>
<th>Parameter </th><th>Change </th><th>Notes </th></tr>
<tr>
<td>"yuv_ext_offset" </td><td>Added </td><td>EFM YUV offset inside of YUV partition; should only be used when efm_ext_mem = 1 </td></tr>
<tr>
<td>"me_ext_offset" </td><td>Added </td><td>EFM ME offset inside of ME partition; should only be used when efm_ext_mem = 1 </td></tr>
</table>
<h2><a class="anchor" id="sys_mg_ioctl_interface_efm_set_ext_pool"></a>
4.30 IAV_IOC_EFM_SET_EXT_POOL</h2>
<p >The structure <code><a class="elRef" target="_blank" href="../../../library/de/d01/structiav__efm__ext__pool.html">iav_efm_ext_pool</a></code> and IOCTL <b>IAV_IOC_EFM_SET_EXT_POOL</b> are added to set EFM external memory infomation to IAV. The <code><a class="elRef" target="_blank" href="../../../library/de/d01/structiav__efm__ext__pool.html">iav_efm_ext_pool</a></code> structure definition is shown below: </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_structRef" target="_blank" href="../../../library/de/d01/structiav__efm__ext__pool.html">iav_efm_ext_pool</a> {</div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a> <a class="code hl_variableRef" target="_blank" href="../../../library/de/d01/structiav__efm__ext__pool.html#a2d8b2a2455fcda0bfa51698fca7015d0">stream_id</a>;     <span class="comment">// EFM stream id</span></div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a> <a class="code hl_variableRef" target="_blank" href="../../../library/de/d01/structiav__efm__ext__pool.html#a2f17e0cf4113bd5a9b9786df784e1ae1">yuv_buf_pid</a>;   <span class="comment">// EFM YUV buffer partition id</span></div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a> <a class="code hl_variableRef" target="_blank" href="../../../library/de/d01/structiav__efm__ext__pool.html#aece6328d28e5e21818b2a10b79e51447">me_buf_pid</a>;        <span class="comment">// EFM ME buffer partition id. No need when stream is MJPEG.</span></div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a> <a class="code hl_variableRef" target="_blank" href="../../../library/de/d01/structiav__efm__ext__pool.html#a7b975da315099212d30f72edde47de8b">yuv_pitch</a>;     <span class="comment">// YUV buffer pitch.</span></div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a> <a class="code hl_variableRef" target="_blank" href="../../../library/de/d01/structiav__efm__ext__pool.html#a6f156dea9ae9858a1b9aa59544a410bd">me1_pitch</a>;     <span class="comment">// me1 buffer pitch.</span></div>
<div class="line">     <a class="code hl_typedefRef" target="_blank" href="../../../driver/d0/dfa/group__iav-typedef.html#ga10e94b422ef0c20dcdec20d31a1f5049">u32</a> <a class="code hl_variableRef" target="_blank" href="../../../library/de/d01/structiav__efm__ext__pool.html#a8aee00036f31db0d2782e02aeba71b47">me0_pitch</a>;     <span class="comment">// me0 buffer pitch.</span></div>
<div class="line">     <span class="keyword">struct </span><a class="code hl_structRef" target="_blank" href="../../../driver/dc/d76/structiav__window.html">iav_window</a> <a class="code hl_variableRef" target="_blank" href="../../../library/de/d01/structiav__efm__ext__pool.html#a448423b89b5ee72d382217b85e7933ec">me1_size</a>;    <span class="comment">// me1 image size.</span></div>
<div class="line">     <span class="keyword">struct </span><a class="code hl_structRef" target="_blank" href="../../../driver/dc/d76/structiav__window.html">iav_window</a> <a class="code hl_variableRef" target="_blank" href="../../../library/de/d01/structiav__efm__ext__pool.html#a489781e35fa66e6e8e2070626f4f3333">me0_size</a>;    <span class="comment">// me0 image size.</span></div>
<div class="line">};</div>
<div class="ttc" id="astructiav__efm__ext__pool_html"><div class="ttname"><a href="../../../library/de/d01/structiav__efm__ext__pool.html">iav_efm_ext_pool</a></div></div>
<div class="ttc" id="astructiav__efm__ext__pool_html_a2d8b2a2455fcda0bfa51698fca7015d0"><div class="ttname"><a href="../../../library/de/d01/structiav__efm__ext__pool.html#a2d8b2a2455fcda0bfa51698fca7015d0">iav_efm_ext_pool::stream_id</a></div><div class="ttdeci">u32 stream_id</div></div>
<div class="ttc" id="astructiav__efm__ext__pool_html_a2f17e0cf4113bd5a9b9786df784e1ae1"><div class="ttname"><a href="../../../library/de/d01/structiav__efm__ext__pool.html#a2f17e0cf4113bd5a9b9786df784e1ae1">iav_efm_ext_pool::yuv_buf_pid</a></div><div class="ttdeci">u32 yuv_buf_pid</div></div>
<div class="ttc" id="astructiav__efm__ext__pool_html_a448423b89b5ee72d382217b85e7933ec"><div class="ttname"><a href="../../../library/de/d01/structiav__efm__ext__pool.html#a448423b89b5ee72d382217b85e7933ec">iav_efm_ext_pool::me1_size</a></div><div class="ttdeci">struct iav_window me1_size</div></div>
<div class="ttc" id="astructiav__efm__ext__pool_html_a489781e35fa66e6e8e2070626f4f3333"><div class="ttname"><a href="../../../library/de/d01/structiav__efm__ext__pool.html#a489781e35fa66e6e8e2070626f4f3333">iav_efm_ext_pool::me0_size</a></div><div class="ttdeci">struct iav_window me0_size</div></div>
<div class="ttc" id="astructiav__efm__ext__pool_html_a6f156dea9ae9858a1b9aa59544a410bd"><div class="ttname"><a href="../../../library/de/d01/structiav__efm__ext__pool.html#a6f156dea9ae9858a1b9aa59544a410bd">iav_efm_ext_pool::me1_pitch</a></div><div class="ttdeci">u32 me1_pitch</div></div>
<div class="ttc" id="astructiav__efm__ext__pool_html_a7b975da315099212d30f72edde47de8b"><div class="ttname"><a href="../../../library/de/d01/structiav__efm__ext__pool.html#a7b975da315099212d30f72edde47de8b">iav_efm_ext_pool::yuv_pitch</a></div><div class="ttdeci">u32 yuv_pitch</div></div>
<div class="ttc" id="astructiav__efm__ext__pool_html_a8aee00036f31db0d2782e02aeba71b47"><div class="ttname"><a href="../../../library/de/d01/structiav__efm__ext__pool.html#a8aee00036f31db0d2782e02aeba71b47">iav_efm_ext_pool::me0_pitch</a></div><div class="ttdeci">u32 me0_pitch</div></div>
<div class="ttc" id="astructiav__efm__ext__pool_html_aece6328d28e5e21818b2a10b79e51447"><div class="ttname"><a href="../../../library/de/d01/structiav__efm__ext__pool.html#aece6328d28e5e21818b2a10b79e51447">iav_efm_ext_pool::me_buf_pid</a></div><div class="ttdeci">u32 me_buf_pid</div></div>
<div class="ttc" id="astructiav__window_html"><div class="ttname"><a href="../../../driver/dc/d76/structiav__window.html">iav_window</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="sys_mg_ioctl_interface_depre_or_unsupport_ioc"></a>
4.31 Deprecated or Unsupported IOCTLs</h2>
<table class="doxtable">
<caption>Table 4-18. Deprecated or Unsupported IOCTLs.</caption>
<tr>
<th>IOCTL </th><th>Notes </th></tr>
<tr>
<td>IAV_IOC_SET_DSP_VP_CFG </td><td>Removed </td></tr>
<tr>
<td>IAV_IOC_GET_DSP_VP_CFG </td><td>Removed </td></tr>
<tr>
<td>IAV_IOC_DSP_AUTH </td><td>Removed </td></tr>
<tr>
<td>IAV_IOC_GET_SYSTEM_CONFIG </td><td>Removed, because there is no single system configuration. The system configuration is now separated into smaller configurations, such as channel configuration, canvas configuration, and stream configuration </td></tr>
<tr>
<td>IAV_IOC_SET_FASTOSD_INSERT </td><td>Removed </td></tr>
<tr>
<td>IAV_IOC_GET_FASTOSD_INSERT </td><td>Removed </td></tr>
<tr>
<td>IAV_IOC_CUSTOM_SEI_REQUEST_BUF </td><td>Removed </td></tr>
<tr>
<td>IAV_IOC_CTRL_DSP_DUMP_CMD </td><td>Removed </td></tr>
<tr>
<td>IAV_IOC_QUERY_DSP_DUMP_CMD </td><td>Removed </td></tr>
<tr>
<td>IAV_IOC_SET_TML_CONFIG </td><td>Not implemented </td></tr>
<tr>
<td>IAV_IOC_GET_TML_CONFIG </td><td>Not implemented </td></tr>
<tr>
<td>IAV_IOC_RELEASE_FRAMEDESC </td><td>Not implemented </td></tr>
<tr>
<td>IAV_IOC_FLUSH_FRAMEDESC </td><td>Not implemented </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="sys_mg_unit_test"></a>
5. Unit Test</h1>
<p >This chapter describes the unit test tool differences between CV2x and the Cooper chip family.</p>
<h2><a class="anchor" id="sys_mg_unit_test_encode"></a>
5.1 test_encode</h2>
<p >The CV2x and Cooper chip families both utilize the unit test <code>test_encode</code> to support single- and multi-VIN cases. This test can support both Lua scripts and command lines for single-VIN cases.</p>
<p >For multi-VIN cases, only Lua scripts are supported.</p>
<p >The Cooper family of chips adds another option, <code>--vout-cfg</code>, which enables users to configure VOUT from the Lua script.</p>
<hr  />
<h1><a class="anchor" id="sys_mg_tools"></a>
6. Tools</h1>
<p >This chapter describes how to upgrade the firmware and use the tools for Linux and the CVflow速 processor.</p>
<h2><a class="anchor" id="sys_mg_tools_fw_upgrade"></a>
6.1 Firmware Upgrade</h2>
<p >The CV5x firmware download process differs from the CV2x firmware download process. CV2x uses the AmbaUSB tool to upgrade the firmware, while CV5x can use either the AmbaUSB tool or the Android fastboot tool. Refer to <a class="elRef" target="_blank" href="../../../overview/d7/d6c/page_getting_start_guide.html">Getting Started Guide</a> for more details.<br  />
 CV72 is similar to CV2x in terms of firmware upgrade, as both use the AmbaUSB tool to download the firmware.</p>
<h2><a class="anchor" id="sys_mg_tools_linux"></a>
6.2 Toolchain for Linux</h2>
<p >Use the toolchain below to compile the Linux source code. </p><div class="fragment"><div class="line">build $ <a class="code hl_variableRef" target="_blank" href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> ../../build/env/amba-build.env</div>
<div class="line">============================================================</div>
<div class="line">Host System: ubuntu 18.04.6 LTS (Bionic Beaver)</div>
<div class="line">============================================================</div>
<div class="line">KERNEL_VER       : 5.15</div>
<div class="line">KERNEL_PV        : 136</div>
<div class="line">KERNEL_SRC       : /cooper_dev/ambarella/kernel/linux-5.15</div>
<div class="line">KERNEL_OUT       : /cooper_dev/ambarella/out/amba_out/cv72_gage/objects/kernel/linux-5.15</div>
<div class="line">AMBA_BOARD       : cv72_gage</div>
<div class="line">AMBA_SOC_SERIES  : cv7x</div>
<div class="line">AMBA_SOC         : cv72</div>
<div class="line">AMBA_CPU_ARCH    : armv8-a</div>
<div class="line">AMBA_DSP_ARCH    : v6</div>
<div class="line">AMBA_IMG_ARCH    : cv72</div>
<div class="line">AMBA_CAVALRY_ARCH: cavalry_v3</div>
<div class="line">ENV_MIRROR_URL   : http:<span class="comment">//yocto.ambarella.com/mirror/cooper_1.5</span></div>
<div class="line">============================================================</div>
<div class="line">============================================================</div>
<div class="line">TOOLCHAIN    PATH: /usr/local/cortex-a76-2023.04-gcc12.2-linux5.15</div>
<div class="line">TOOLCHAIN    NANE: aarch64-linux-gnu-gcc</div>
<div class="line">TOOLCHAIN VERSION: 12.2.1</div>
<div class="line">============================================================</div>
<div class="line">============================================================</div>
<div class="line">ENV_BUILD_MODE   : external</div>
<div class="line">ENV_BUILD_ARCH   : arm64</div>
<div class="line">ENV_BUILD_TOOL   : /usr/local/cortex-a76-2023.04-gcc12.2-linux5.15/bin/aarch64-linux-gnu-</div>
<div class="line">ENV_BUILD_JOBS   : -j8</div>
<div class="line">ENV_TOP_DIR      : /cooper_dev/ambarella</div>
<div class="line">ENV_MAKE_DIR     : /cooper_dev/ambarella/build/core</div>
<div class="line">ENV_TOOL_DIR     : /cooper_dev/ambarella/build/bin</div>
<div class="line">ENV_DOWN_DIR     : /cooper_dev/ambarella/out/mirror-cache/downloads</div>
<div class="line">ENV_CACHE_DIR    : /cooper_dev/ambarella/out/mirror-cache/build-cache</div>
<div class="line">ENV_TOP_OUT      : /cooper_dev/ambarella/out/amba_out/cv72_gage</div>
<div class="line">ENV_OUT_ROOT     : /cooper_dev/ambarella/out/amba_out/cv72_gage/objects</div>
<div class="line">ENV_INS_ROOT     : /cooper_dev/ambarella/out/amba_out/cv72_gage/sysroot</div>
<div class="line">ENV_DEP_ROOT     : /cooper_dev/ambarella/out/amba_out/cv72_gage/sysroot</div>
<div class="line">ENV_IMG_ROOT     : /cooper_dev/ambarella/out/amba_out/cv72_gage/images</div>
<div class="line">ENV_CFG_ROOT     : /cooper_dev/ambarella/out/amba_out/cv72_gage/config</div>
<div class="line">ENV_OUT_HOST     : /cooper_dev/ambarella/out/amba_out/cv72_gage/objects-native</div>
<div class="line">ENV_INS_HOST     : /cooper_dev/ambarella/out/amba_out/cv72_gage/sysroot-native</div>
<div class="line">ENV_DEP_HOST     : /cooper_dev/ambarella/out/amba_out/cv72_gage/sysroot-native</div>
<div class="line">ENV_FSANITIZE_OPTION : 0 <span class="comment">// 0:close, 1:address, 2:thread, 3:leak, 4:undefined</span></div>
<div class="line">============================================================</div>
<div class="ttc" id="avin__init_8c_html_a07a87b2e6ed927503e2f95f119c9fc23"><div class="ttname"><a href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a></div><div class="ttdeci">int source</div></div>
</div><!-- fragment --><h2><a class="anchor" id="sys_mg_tools_cvflow_processor"></a>
6.3 Toolchain for the CVflow Processor</h2>
<p >Use the toolchain below to compile the CV source code. </p><div class="fragment"><div class="line">build $ <a class="code hl_variableRef" target="_blank" href="../../../video/d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> /usr/local/amba-cv-tools-2.4.0.0.1020.ubuntu-18.04/env/cv5.env</div>
<div class="line">Using cavalry_gen version latest</div>
<div class="line">=================================================</div>
<div class="line">AmbaCnnUtils Version: cv2.2.4.0.0.1020.ubu1804</div>
<div class="line">    CnnUtils Version: cv2.2.4.0.0.1020.ubu1804</div>
<div class="line">     Cavalry Version: version 2.2.8.2 ( HASH a38a866 )</div>
<div class="line">         Vas Version: cv5.2.4.0.0.1020.ubu1804</div>
<div class="line">=================================================</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="sys_mg_faq"></a>
7. Frequently Asked Questions (FAQ)</h1>
<p ><b>Question:</b> Is it difficult to migrate CV2x products to the Cooper chip family?</p>
<p ><b>Answer:</b> Migrating from the CV2x platform to the Cooper chip family is simple. The Cooper SDK IOCTL is backwards-compatible with the CV2x IOCTL, so users who have already designed a CV2x-based single-VIN / channel platform should find it easy to migrate upper-level applications from CV2x to the Cooper Linux SDK. Users who have designed CV2x multi-channel products must implement minor changes to the processing flow, as well as to some data structures in the Lua script, in order to access multi-channel features.</p>
<hr  />
<h1><a class="anchor" id="sys_mg_license"></a>
8. License</h1>
<p >Copyright (c) 2024 Ambarella International LP.</p>
<p >This file and its contents ( "Software" ) are protected by intellectual property rights including, without limitation, U.S. and/or foreign copyrights. This Software is also the confidential and proprietary information of Ambarella International LP and its licensors. You may not use, reproduce, disclose, distribute, modify, or otherwise prepare derivative works of this Software or any portion thereof except pursuant to a signed license agreement or nondisclosure agreement with Ambarella International LP or its authorized affiliates. In the absence of such an agreement, you agree to promptly notify and return this Software to Ambarella International LP.</p>
<p >THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT, MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL AMBARELLA INTERNATIONAL LP OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
