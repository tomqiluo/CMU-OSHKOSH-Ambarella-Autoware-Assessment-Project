<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Library: test_nnctrl_mfd.c</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Library"/>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="../../../library/mathjax/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-ambarella.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Ambarella.png"/></td>
  <td id="projectalign">
   <div id="projectname">Library<span id="projectnumber">&#160;Cooper_1.6.0 (CV72 &amp; CV3) @ 2024.07.10 14:12:44</span>
   </div>
   <div id="projectbrief">placeholder</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.html','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d0/dc8/test_nnctrl_mfd_8c-example.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle"><div class="title">test_nnctrl_mfd.c</div></div>
</div><!--header-->
<div class="contents">
<p >This is a source code file of test_nnctrl_mfd.</p>
<div class="fragment"><div class="line"><span class="comment">/*******************************************************************************</span></div>
<div class="line"><span class="comment"> * test_nnctrl_mfd.c</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * History:</span></div>
<div class="line"><span class="comment"> *    2020/05/27  - [Tao Wu] created</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Copyright (c) 2018 Ambarella International LP</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This file and its contents ( &quot;Software&quot; ) are protected by intellectual</span></div>
<div class="line"><span class="comment"> * property rights including, without limitation, U.S. and/or foreign</span></div>
<div class="line"><span class="comment"> * copyrights. This Software is also the confidential and proprietary</span></div>
<div class="line"><span class="comment"> * information of Ambarella International LP and its licensors. You may not use, reproduce,</span></div>
<div class="line"><span class="comment"> * disclose, distribute, modify, or otherwise prepare derivative works of this</span></div>
<div class="line"><span class="comment"> * Software or any portion thereof except pursuant to a signed license agreement</span></div>
<div class="line"><span class="comment"> * or nondisclosure agreement with Ambarella International LP or its authorized affiliates.</span></div>
<div class="line"><span class="comment"> * In the absence of such an agreement, you agree to promptly notify and return</span></div>
<div class="line"><span class="comment"> * this Software to Ambarella International LP.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This file includes sample code and is only for internal testing and evaluation.  If you</span></div>
<div class="line"><span class="comment"> * distribute this sample code (whether in source, object, or binary code form), it will be</span></div>
<div class="line"><span class="comment"> * without any warranty or indemnity protection from Ambarella International LP or its affiliates.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * THIS SOFTWARE IS PROVIDED &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES,</span></div>
<div class="line"><span class="comment"> * INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,</span></div>
<div class="line"><span class="comment"> * MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span></div>
<div class="line"><span class="comment"> * IN NO EVENT SHALL AMBARELLA INTERNATIONAL LP OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,</span></div>
<div class="line"><span class="comment"> * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span></div>
<div class="line"><span class="comment"> * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</span></div>
<div class="line"><span class="comment"> * LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS</span></div>
<div class="line"><span class="comment"> * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span></div>
<div class="line"><span class="comment"> * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span></div>
<div class="line"><span class="comment"> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span></div>
<div class="line"><span class="comment"> * POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment">******************************************************************************/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fcntl.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stddef.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ctype.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;errno.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;getopt.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sched.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/ioctl.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/mman.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/time.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/wait.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;time.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;pthread.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;signal.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../de/db0/cavalry__mem_8h.html">cavalry_mem.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;cavalry_gen.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../db/d9f/nnctrl_8h.html">nnctrl.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;linux/dma-buf.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;vp_bw/vp_bw.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;nnctrl_utils.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t g_extra_high_mem_phys = 0;</div>
<div class="line"> </div>
<div class="line"><span class="comment">//#define DMABUF_SYNC (1)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MEASURE_TIME_VAR() \</span></div>
<div class="line"><span class="preprocessor">    struct timeval tv1, tv2; \</span></div>
<div class="line"><span class="preprocessor">    unsigned long tv_us</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MEASURE_TIME_START(s) do { \</span></div>
<div class="line"><span class="preprocessor">    gettimeofday(&amp;tv1, NULL); \</span></div>
<div class="line"><span class="preprocessor">} while (0)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MEASURE_TIME_END(s) do { \</span></div>
<div class="line"><span class="preprocessor">    gettimeofday(&amp;tv2, NULL); \</span></div>
<div class="line"><span class="preprocessor">    tv_us = (unsigned long) 1000000 * (unsigned long) (tv2.tv_sec - tv1.tv_sec) + \</span></div>
<div class="line"><span class="preprocessor">        (unsigned long) (tv2.tv_usec - tv1.tv_usec); \</span></div>
<div class="line"><span class="preprocessor">    tv1 = tv2; \</span></div>
<div class="line"><span class="preprocessor">    printf(&quot;%s : %lu us\n&quot;</span>, s, tv_us); \</div>
<div class="line">} while (0)</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef ROUND_UP</span></div>
<div class="line"><span class="preprocessor">#define ROUND_UP(size, align) (((size) + ((align) - 1)) &amp; ~((align) - 1))</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define FILENAME_LENGTH     (256)</span></div>
<div class="line"><span class="preprocessor">#define DUMMY_DATA_LENGTH   (256)</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *app_ver = <span class="stringliteral">&quot;app 3.0.1&quot;</span>;</div>
<div class="line"><span class="keyword">struct </span>io_match {</div>
<div class="line">    uint32_t load_input : 1;</div>
<div class="line">    uint32_t store_output : 1;</div>
<div class="line">    uint32_t no_mem : 1;</div>
<div class="line">    uint32_t crc_inited : 1;</div>
<div class="line">    uint32_t out_stored : 1;</div>
<div class="line">    uint32_t rotate_flip_bitmap : 5;</div>
<div class="line">    uint32_t reserved_0 : 22;</div>
<div class="line"> </div>
<div class="line">    uint32_t crc_result;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> *virt_addr;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> dram_offset;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> dram_size;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> data_size;</div>
<div class="line">    <span class="keywordtype">int</span> dram_addr_fd;</div>
<div class="line"> </div>
<div class="line">    uint32_t update_pitch;</div>
<div class="line">    <span class="keyword">struct </span><a id="_a0" name="_a0"></a><a class="code hl_struct" href="../../db/de7/structio__dim.html">io_dim</a> dim;</div>
<div class="line">    <span class="keyword">struct </span><a id="_a1" name="_a1"></a><a class="code hl_struct" href="../../d8/d06/structio__data__fmt.html">io_data_fmt</a> data_fmt;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">char</span> port_name[CAVALRY_IO_NAME_MAX];</div>
<div class="line">    <span class="keywordtype">char</span> file_name[FILENAME_LENGTH];</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>net_match {</div>
<div class="line">    uint32_t verbose : 1; <span class="comment">/* nerual network verbose */</span></div>
<div class="line">    uint32_t reuse_mem : 1;</div>
<div class="line">    uint32_t query_dvi : 1;</div>
<div class="line">    uint32_t dump_net_en : 1;</div>
<div class="line">    uint32_t print_time : 1;</div>
<div class="line">    uint32_t dump_net_done : 1;</div>
<div class="line">    uint32_t net_feed_mem : 1;</div>
<div class="line">    uint32_t persist_net_mem : 1;</div>
<div class="line">    uint32_t print_user_info : 1;</div>
<div class="line">    uint32_t feed_dummy_data : 1;</div>
<div class="line">    uint32_t remove_pad : 1;</div>
<div class="line">    uint32_t add_port_meta_header : 1;</div>
<div class="line">    uint32_t no_chip_check : 1;</div>
<div class="line">    uint32_t enable_extra_high_mem : 1;</div>
<div class="line">    uint32_t is_encrypted_net : 1;</div>
<div class="line">    uint32_t export_all_pitch : 1;</div>
<div class="line">    uint32_t enable_dvi_crc_check : 1;</div>
<div class="line">    uint32_t set_hw_affinity : 1;</div>
<div class="line">    uint32_t reserved_0 : 14;</div>
<div class="line"> </div>
<div class="line">    uint32_t net_id;</div>
<div class="line">    uint32_t iter_num;</div>
<div class="line">    uint32_t batch_num;</div>
<div class="line">    uint8_t spilt_num;</div>
<div class="line">    uint8_t reserved_1[3];</div>
<div class="line">    uint32_t query_dvi_id;</div>
<div class="line">    <span class="keywordtype">char</span> net_name[FILENAME_LENGTH];</div>
<div class="line">    <span class="keywordtype">char</span> path_dump[FILENAME_LENGTH];</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* affinity */</span></div>
<div class="line">    uint32_t nvp_affinity;</div>
<div class="line">    uint32_t gvp_affinity;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* encryption */</span></div>
<div class="line">    <span class="keyword">struct </span>customer_certificate encrypt_certificate;</div>
<div class="line">    <span class="keyword">struct </span>aes256_key encrypt_key;</div>
<div class="line">    uint8_t encrypt_digest[CAVALRY_DIGEST_LENGTH];</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *encrypt_certificate_filename;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *encrypt_key_filename;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *encrypt_digest_filename;</div>
<div class="line"> </div>
<div class="line">    uint64_t net_bw_sz; <span class="comment">/* Total size */</span></div>
<div class="line">    uint32_t net_bw_us; <span class="comment">/* VP time, unit: us */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span><a id="_a2" name="_a2"></a><a class="code hl_struct" href="../../d3/deb/structnet__run__cfg.html">net_run_cfg</a> net_run;</div>
<div class="line">    <span class="keyword">struct </span>cavalry_mfd_desc net_m;</div>
<div class="line"> </div>
<div class="line">    uint32_t in_num;</div>
<div class="line">    uint32_t out_num;</div>
<div class="line">    <span class="keyword">struct </span>io_match in_pair[<a id="a3" name="a3"></a><a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga0e2b8805187717eb546342bcea70a22a">MAX_IO_NUM</a>];</div>
<div class="line">    <span class="keyword">struct </span>io_match out_pair[<a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga0e2b8805187717eb546342bcea70a22a">MAX_IO_NUM</a>];</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum</span> io_type {</div>
<div class="line">    IO_INVALID = 0,</div>
<div class="line">    IO_INPUT = 1,</div>
<div class="line">    IO_OUTPUT = 2,</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum</span> run_mode {</div>
<div class="line">    MODE_SERIAL = 0,</div>
<div class="line">    MODE_PARALLEL = 1,</div>
<div class="line">    MODE_RANDOM = 2,</div>
<div class="line">    MODE_NUM,</div>
<div class="line">    MODE_FIRST = MODE_SERIAL,</div>
<div class="line">    MODE_LAST = MODE_RANDOM,</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>nnctrl_param {</div>
<div class="line">    <span class="keywordtype">int</span> fd_cav;</div>
<div class="line"> </div>
<div class="line">    uint32_t verbose : 1; <span class="comment">/* nnctrl library verbose */</span></div>
<div class="line">    uint32_t all_cache_en : 1; <span class="comment">/* 0: nocached; 1: cached */</span></div>
<div class="line">    uint32_t all_check_md5 : 1;</div>
<div class="line">    uint32_t all_print_time : 1;</div>
<div class="line">    uint32_t all_run_loop : 1;</div>
<div class="line">    uint32_t all_single_run_dag : 1;</div>
<div class="line">    uint32_t all_net_feed_mem : 1;</div>
<div class="line">    uint32_t all_remove_pad : 1;</div>
<div class="line">    uint32_t all_add_port_meta_header : 1;</div>
<div class="line">    uint32_t all_en_extra_high_mem : 1;</div>
<div class="line">    uint32_t all_en_dvi_crc_check : 1;</div>
<div class="line">    uint32_t reserved_0 : 21;</div>
<div class="line"> </div>
<div class="line">    uint32_t show_version_flag : 1;</div>
<div class="line">    uint32_t ck_bw_flag : 1;</div>
<div class="line">    uint32_t show_net_io_flag : 1;</div>
<div class="line">    uint32_t show_net_bin_version_flag : 1;</div>
<div class="line">    uint32_t set_log_level_flag : 1;</div>
<div class="line">    uint32_t update_inter_num_flag : 1;</div>
<div class="line">    uint32_t show_net_encrypt_state_flag : 1;</div>
<div class="line">    uint32_t reserved_1 : 25;</div>
<div class="line"> </div>
<div class="line">    uint32_t all_nvp_affinity;</div>
<div class="line">    uint32_t libnn_log_level;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">enum</span> run_mode mode;</div>
<div class="line">    uint32_t all_inter_num;</div>
<div class="line">    uint32_t all_batch_num;</div>
<div class="line"> </div>
<div class="line">    uint32_t net_num;</div>
<div class="line">    <span class="keyword">struct </span>net_match *net_pair; <span class="comment">/* list for each net */</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>nnctrl_param G_nnctrl;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define NO_ARG      0</span></div>
<div class="line"><span class="preprocessor">#define HAS_ARG     1</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum</span> <a class="code hl_enumerationRef" target="_blank" href="../../../video/d0/d7d/test__decode_8h.html#ab5fefa6fc4abffdc4b912255ea537aae">numeric_short_options</a> {</div>
<div class="line">    INPUT,</div>
<div class="line">    OUTPUT,</div>
<div class="line">    NO_MEM,</div>
<div class="line">    ROTATE_FLIP,</div>
<div class="line">    OFF_REUSE,</div>
<div class="line">    QUERY_DVI,</div>
<div class="line">    DUMP_MODE,</div>
<div class="line">    FEED_NET_MEM,</div>
<div class="line">    VERSION,</div>
<div class="line">    SHOW_NET_IO,</div>
<div class="line">    SPLIT_NUM,</div>
<div class="line">    BATCH_NUM,</div>
<div class="line">    UPDATE_IO_PITCH,</div>
<div class="line">    EXPORT_ALL_IO_PITCH,</div>
<div class="line">    RUN_NET_PRIORITY,</div>
<div class="line">    NO_AUTO_RESUME_NET,</div>
<div class="line">    FEED_DUMMY_DATA,</div>
<div class="line">    NET_BIN_VERSION,</div>
<div class="line">    KEEP_PADDING,</div>
<div class="line">    ADD_PORT_META_HEADER,</div>
<div class="line">    NO_CHIP_CHECK,</div>
<div class="line">    LOAD_NET_HIGH_MEM,</div>
<div class="line">    ENCRYPT_CERTIFICATE,</div>
<div class="line">    ENCRYPT_KEY,</div>
<div class="line">    ENCRYPT_DIGEST,</div>
<div class="line">    SHOW_ENCRYPT_STATE,</div>
<div class="line">    EN_DVI_CRC_CHECK,</div>
<div class="line">    NVP_AFFINITY,</div>
<div class="line">    GVP_AFFINITY,</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>option <a id="a4" name="a4"></a>long_options[] = {</div>
<div class="line">    {<span class="stringliteral">&quot;cvr-bin&quot;</span>, <a id="a5" name="a5"></a><a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, <span class="charliteral">&#39;b&#39;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;in&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, INPUT},</div>
<div class="line">    {<span class="stringliteral">&quot;out&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, OUTPUT},</div>
<div class="line">    {<span class="stringliteral">&quot;no&quot;</span>, <a id="a6" name="a6"></a><a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, NO_MEM},</div>
<div class="line">    {<span class="stringliteral">&quot;rotate-flip&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, ROTATE_FLIP},</div>
<div class="line">    {<span class="stringliteral">&quot;update-pitch&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, UPDATE_IO_PITCH},</div>
<div class="line">    {<span class="stringliteral">&quot;export-pitch&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, EXPORT_ALL_IO_PITCH},</div>
<div class="line">    {<span class="stringliteral">&quot;off-reuse&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, OFF_REUSE},</div>
<div class="line">    {<span class="stringliteral">&quot;dvi&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, QUERY_DVI},</div>
<div class="line">    {<span class="stringliteral">&quot;dump&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, DUMP_MODE},</div>
<div class="line">    {<span class="stringliteral">&quot;nvp-affinity&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, NVP_AFFINITY},</div>
<div class="line">    {<span class="stringliteral">&quot;gvp-affinity&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, GVP_AFFINITY},</div>
<div class="line">    {<span class="stringliteral">&quot;cert&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, ENCRYPT_CERTIFICATE},</div>
<div class="line">    {<span class="stringliteral">&quot;key&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, ENCRYPT_KEY},</div>
<div class="line">    {<span class="stringliteral">&quot;digest&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, ENCRYPT_DIGEST},</div>
<div class="line">    {<span class="stringliteral">&quot;log-level&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, <span class="charliteral">&#39;d&#39;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;net-verbose&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, <span class="charliteral">&#39;v&#39;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;dummy&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, FEED_DUMMY_DATA},</div>
<div class="line">    {<span class="stringliteral">&quot;ctrl-verbose&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, <span class="charliteral">&#39;V&#39;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;print-time&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, <span class="charliteral">&#39;e&#39;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;single-run&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, <span class="charliteral">&#39;s&#39;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;split&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, SPLIT_NUM},</div>
<div class="line">    {<span class="stringliteral">&quot;no-auto-resume&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, NO_AUTO_RESUME_NET},</div>
<div class="line">    {<span class="stringliteral">&quot;no-chip-check&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, NO_CHIP_CHECK},</div>
<div class="line">    {<span class="stringliteral">&quot;en-dvi-check&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, EN_DVI_CRC_CHECK},</div>
<div class="line">    {<span class="stringliteral">&quot;priority&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, RUN_NET_PRIORITY},</div>
<div class="line">    {<span class="stringliteral">&quot;feed-mem&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, FEED_NET_MEM},</div>
<div class="line">    {<span class="stringliteral">&quot;high-mem&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, LOAD_NET_HIGH_MEM},</div>
<div class="line">    {<span class="stringliteral">&quot;keep-pad&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, KEEP_PADDING},</div>
<div class="line">    {<span class="stringliteral">&quot;port-header&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, ADD_PORT_META_HEADER},</div>
<div class="line">    {<span class="stringliteral">&quot;cache&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, <span class="charliteral">&#39;c&#39;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;check&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, <span class="charliteral">&#39;k&#39;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;iter&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, <span class="charliteral">&#39;t&#39;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;batch&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, BATCH_NUM},</div>
<div class="line">    {<span class="stringliteral">&quot;mode&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a>, 0, <span class="charliteral">&#39;m&#39;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;ck-bw&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, <span class="charliteral">&#39;w&#39;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;show-encrypt&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, SHOW_ENCRYPT_STATE},</div>
<div class="line">    {<span class="stringliteral">&quot;show-io&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, SHOW_NET_IO},</div>
<div class="line">    {<span class="stringliteral">&quot;version&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, VERSION},</div>
<div class="line">    {<span class="stringliteral">&quot;bin-version&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, NET_BIN_VERSION},</div>
<div class="line">    {<span class="stringliteral">&quot;help&quot;</span>, <a class="code hl_defineRef" target="_blank" href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a>, 0, <span class="charliteral">&#39;h&#39;</span>},</div>
<div class="line">    {0, 0, 0, 0}</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a id="a7" name="a7"></a>short_options = <span class="stringliteral">&quot;b:d:vVesckt:m:wh&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a id="_a8" name="_a8"></a><a class="code hl_structRef" target="_blank" href="../../../video/d2/d4b/structhint__s.html">hint_s</a> {</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a id="a9" name="a9"></a><a class="code hl_variableRef" target="_blank" href="../../../video/d2/d4b/structhint__s.html#aa56a50443afd9d2f7cf738fb7ffba168">arg</a>;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a id="a10" name="a10"></a><a class="code hl_variableRef" target="_blank" href="../../../video/d2/d4b/structhint__s.html#a2799cca21c05a4f99f4c8b3b178d0133">str</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code hl_structRef" target="_blank" href="../../../video/d2/d4b/structhint__s.html">hint_s</a> <a id="a11" name="a11"></a>hint[] = {</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tCavalry_gen generated binary, it is network binary&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\t\tInput port name and filename to load, specify after network&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tOutput port name and filename to save, specify after network&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\t\tDo not allocate port memory in libnnctrl, specify after port&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\tSet port rotate-flip bit map, specify after port. Bitmap order (High -&gt; Low):\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\t\t\t\t  4: pflip; 3: dflip; 2: vflip; 1: hflip; 0: rotate. E.g. vflip+rotate: 0x05 (00101)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\t\t\t\t  Note: Do not support hflip and rotate on output.&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\tUpdate pitch of port. CNNGen gen pitch in 32 Byte align by default, but use case is different.\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\t\t\t\t  Should set no_mem if set update_pitch, specify after port.&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\tUpdate pitch of port with default value. Used for export in/out pitch poke info, specify after network\n&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tTurn off reuse various port memory in libnnctrl, specify after network. Default is on&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tQuery dvi description by dvi_id, specify after network.&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tThe path to blob dump and dvi dump, specify after network.&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;Path should exist, will turn off reuse port&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\tSpecify NVP HW affinity when run net, specify after network&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\tSpecify GVP HW affinity when run net, specify after network&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tSpecify certificate filename for encrypt network.&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tSpecify re-encrypted-key (dek-encrypted-pek) filename for encrypt network.&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tSpecify digest filename for encrypt network.&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tlog level of libnnctrl. 0: Error; 1: Warning; 2: Info; 3: Debug; 4: Verbose. Default is 2&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\tprint verbose info of neural network, specify after network&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tFeed dummy data([0,1,...,255]) to input for one network&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\tprint verbose info of nnctrl library&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tprint execute time of all neural network. Default is disable&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tRun single DAG in one ioctl for one network&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tIssued split number times ioctl to driver for each network, specify after network.&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\tDon&#39;t auto resume net if other high priority net preempt. Default is disable&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\tDon&#39;t check chip arch between NET.bin and libnnctrl. Default is disable, specify after network.&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\t\t\tIt&#39;s debug proposal, shouldn&#39;t set this for production&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\tEnable check DVI&#39;s crc32 value when VP hang(check if DVI is broken). &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;It will slower down load_net when enable this.&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tSet run network priority [lowest: 0 ~ highest: 31], specify after network.&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tFeed network binary by memory instread of filename. Default is disable&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tLoad network binary partially in high memory (Bigger than 3.5GByte). Default is disable&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tKeep padding when save output file. Default is remove padding.&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tAdd header to describle the port binary, like dimension, data_format and size etc.&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tmmap cache memory. Default is noncache&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tCheck later output if same as first one by CRC32. Default is disable&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tIteration of run network, loop forever (0xffffffff) if set 0. Default is 1&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tSet the batch num to run network&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tModes to run multiple networks at the same time. Default is 0.\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\t\t\t\t  0: Serial one network by one network;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\t\t\t\t  1: Parallel call in multi-thread;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\t\t\t\t  2: Switch networks in random order.&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tCheck current VP memory bandwidth if is sufficient for all network.\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\t\t\t\tChange default loop_cnt by &#39;-t&#39; option.&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tShow encrypt state of network binary. 0: un-encrypt; 1: encrypt by dek.&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tShow all network&#39;s input and output info&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tShow library and cavalry parser version&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tShow cavalry network binary version&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;\t\tPrint help info&quot;</span>},</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> <a id="a12" name="a12"></a><a class="code hl_function" href="../../dc/d60/test__smartfb_8c.html#ad96d407a911fbb914fa8e4cfbf2faf0f">usage</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *itself = <span class="stringliteral">&quot;test_nnctrl_mfd&quot;</span>;</div>
<div class="line">    uint32_t i = 0;</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;%s %s usage:\n&quot;</span>, itself, app_ver);</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; <span class="keyword">sizeof</span>(long_options) / <span class="keyword">sizeof</span>(long_options[0]) - 1; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (isalpha(long_options[i].val))</div>
<div class="line">            printf(<span class="stringliteral">&quot;-%c &quot;</span>, long_options[i].val);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            printf(<span class="stringliteral">&quot;   &quot;</span>);</div>
<div class="line">        printf(<span class="stringliteral">&quot;--%s&quot;</span>, long_options[i].<a id="a13" name="a13"></a><a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a25d22ecc7e656d2c59332072684e8766">name</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (hint[i].<a class="code hl_variableRef" target="_blank" href="../../../video/d2/d4b/structhint__s.html#aa56a50443afd9d2f7cf738fb7ffba168">arg</a>[0] != 0)</div>
<div class="line">            printf(<span class="stringliteral">&quot; [%s]&quot;</span>, hint[i].<a class="code hl_variableRef" target="_blank" href="../../../video/d2/d4b/structhint__s.html#aa56a50443afd9d2f7cf738fb7ffba168">arg</a>);</div>
<div class="line">        printf(<span class="stringliteral">&quot;\t%s\n&quot;</span>, hint[i].<a class="code hl_variableRef" target="_blank" href="../../../video/d2/d4b/structhint__s.html#a2799cca21c05a4f99f4c8b3b178d0133">str</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;\nExample:\n\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;1. Run one network with cache memory and print network execute time:\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  # %s -c -e -b &lt;network.bin&gt; --in &lt;name&gt;=&lt;file&gt; --out &lt;name&gt;=&lt;file&gt;&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\n\n&quot;</span>, itself);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;2. Run one network with multi-io:\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  # %s -b &lt;network.bin&gt; &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;--in &lt;name_0&gt;=&lt;file_0&gt; --in &lt;name_1&gt;=&lt;file_1&gt; &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;--out &lt;name_0&gt;=&lt;file_0&gt; --out &lt;name_1&gt;=&lt;file_1&gt;&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\n\n&quot;</span>, itself);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;3. Run multi-networks in single thread by default order with 10 times:\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  # %s -m 0 -t 10 -b &lt;network_0.bin&gt; --in &lt;name&gt;=&lt;file&gt; --out &lt;name&gt;=&lt;file&gt;&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; -b &lt;network_1.bin&gt; --in &lt;name&gt;=&lt;file&gt; --out &lt;name&gt;=&lt;file&gt;&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\n\n&quot;</span>, itself);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;4. Run multi-networks in multi-thread forever and check output:\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  # %s -m 1 -t 0 -k -b &lt;network_0.bin&gt; --in &lt;name&gt;=&lt;file&gt; --out &lt;name&gt;=&lt;file&gt;&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; -b &lt;network_1.bin&gt; --in &lt;name&gt;=&lt;file&gt; --out &lt;name&gt;=&lt;file&gt;&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\n\n&quot;</span>, itself);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;5. Run multi-networks in single thread by random order forever and check output:\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  # %s -m 2 -t 0 -k -b &lt;network_0.bin&gt; --in &lt;name&gt;=&lt;file&gt; --out &lt;name&gt;=&lt;file&gt;&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; -b &lt;network_1.bin&gt; --in &lt;name&gt;=&lt;file&gt; --out &lt;name&gt;=&lt;file&gt;&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\n\n&quot;</span>, itself);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;6. Check current VP memory bandwidth if is sufficient:\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  # %s -w &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\n\n&quot;</span>, itself);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;7. Show library and cavalry parser version:\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  # %s --version &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\n\n&quot;</span>, itself);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;8. Show cavalry network binary version:\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  # %s -b &lt;network.bin&gt; --bin-version &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\n\n&quot;</span>, itself);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define WIN_SIZE (512)</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> uint32_t crc32_tab[] = {</div>
<div class="line">    0x00000000, 0x77073096, 0xee0e612c, 0x990951ba, 0x076dc419, 0x706af48f,</div>
<div class="line">    0xe963a535, 0x9e6495a3, 0x0edb8832, 0x79dcb8a4, 0xe0d5e91e, 0x97d2d988,</div>
<div class="line">    0x09b64c2b, 0x7eb17cbd, 0xe7b82d07, 0x90bf1d91, 0x1db71064, 0x6ab020f2,</div>
<div class="line">    0xf3b97148, 0x84be41de, 0x1adad47d, 0x6ddde4eb, 0xf4d4b551, 0x83d385c7,</div>
<div class="line">    0x136c9856, 0x646ba8c0, 0xfd62f97a, 0x8a65c9ec, 0x14015c4f, 0x63066cd9,</div>
<div class="line">    0xfa0f3d63, 0x8d080df5, 0x3b6e20c8, 0x4c69105e, 0xd56041e4, 0xa2677172,</div>
<div class="line">    0x3c03e4d1, 0x4b04d447, 0xd20d85fd, 0xa50ab56b, 0x35b5a8fa, 0x42b2986c,</div>
<div class="line">    0xdbbbc9d6, 0xacbcf940, 0x32d86ce3, 0x45df5c75, 0xdcd60dcf, 0xabd13d59,</div>
<div class="line">    0x26d930ac, 0x51de003a, 0xc8d75180, 0xbfd06116, 0x21b4f4b5, 0x56b3c423,</div>
<div class="line">    0xcfba9599, 0xb8bda50f, 0x2802b89e, 0x5f058808, 0xc60cd9b2, 0xb10be924,</div>
<div class="line">    0x2f6f7c87, 0x58684c11, 0xc1611dab, 0xb6662d3d, 0x76dc4190, 0x01db7106,</div>
<div class="line">    0x98d220bc, 0xefd5102a, 0x71b18589, 0x06b6b51f, 0x9fbfe4a5, 0xe8b8d433,</div>
<div class="line">    0x7807c9a2, 0x0f00f934, 0x9609a88e, 0xe10e9818, 0x7f6a0dbb, 0x086d3d2d,</div>
<div class="line">    0x91646c97, 0xe6635c01, 0x6b6b51f4, 0x1c6c6162, 0x856530d8, 0xf262004e,</div>
<div class="line">    0x6c0695ed, 0x1b01a57b, 0x8208f4c1, 0xf50fc457, 0x65b0d9c6, 0x12b7e950,</div>
<div class="line">    0x8bbeb8ea, 0xfcb9887c, 0x62dd1ddf, 0x15da2d49, 0x8cd37cf3, 0xfbd44c65,</div>
<div class="line">    0x4db26158, 0x3ab551ce, 0xa3bc0074, 0xd4bb30e2, 0x4adfa541, 0x3dd895d7,</div>
<div class="line">    0xa4d1c46d, 0xd3d6f4fb, 0x4369e96a, 0x346ed9fc, 0xad678846, 0xda60b8d0,</div>
<div class="line">    0x44042d73, 0x33031de5, 0xaa0a4c5f, 0xdd0d7cc9, 0x5005713c, 0x270241aa,</div>
<div class="line">    0xbe0b1010, 0xc90c2086, 0x5768b525, 0x206f85b3, 0xb966d409, 0xce61e49f,</div>
<div class="line">    0x5edef90e, 0x29d9c998, 0xb0d09822, 0xc7d7a8b4, 0x59b33d17, 0x2eb40d81,</div>
<div class="line">    0xb7bd5c3b, 0xc0ba6cad, 0xedb88320, 0x9abfb3b6, 0x03b6e20c, 0x74b1d29a,</div>
<div class="line">    0xead54739, 0x9dd277af, 0x04db2615, 0x73dc1683, 0xe3630b12, 0x94643b84,</div>
<div class="line">    0x0d6d6a3e, 0x7a6a5aa8, 0xe40ecf0b, 0x9309ff9d, 0x0a00ae27, 0x7d079eb1,</div>
<div class="line">    0xf00f9344, 0x8708a3d2, 0x1e01f268, 0x6906c2fe, 0xf762575d, 0x806567cb,</div>
<div class="line">    0x196c3671, 0x6e6b06e7, 0xfed41b76, 0x89d32be0, 0x10da7a5a, 0x67dd4acc,</div>
<div class="line">    0xf9b9df6f, 0x8ebeeff9, 0x17b7be43, 0x60b08ed5, 0xd6d6a3e8, 0xa1d1937e,</div>
<div class="line">    0x38d8c2c4, 0x4fdff252, 0xd1bb67f1, 0xa6bc5767, 0x3fb506dd, 0x48b2364b,</div>
<div class="line">    0xd80d2bda, 0xaf0a1b4c, 0x36034af6, 0x41047a60, 0xdf60efc3, 0xa867df55,</div>
<div class="line">    0x316e8eef, 0x4669be79, 0xcb61b38c, 0xbc66831a, 0x256fd2a0, 0x5268e236,</div>
<div class="line">    0xcc0c7795, 0xbb0b4703, 0x220216b9, 0x5505262f, 0xc5ba3bbe, 0xb2bd0b28,</div>
<div class="line">    0x2bb45a92, 0x5cb36a04, 0xc2d7ffa7, 0xb5d0cf31, 0x2cd99e8b, 0x5bdeae1d,</div>
<div class="line">    0x9b64c2b0, 0xec63f226, 0x756aa39c, 0x026d930a, 0x9c0906a9, 0xeb0e363f,</div>
<div class="line">    0x72076785, 0x05005713, 0x95bf4a82, 0xe2b87a14, 0x7bb12bae, 0x0cb61b38,</div>
<div class="line">    0x92d28e9b, 0xe5d5be0d, 0x7cdcefb7, 0x0bdbdf21, 0x86d3d2d4, 0xf1d4e242,</div>
<div class="line">    0x68ddb3f8, 0x1fda836e, 0x81be16cd, 0xf6b9265b, 0x6fb077e1, 0x18b74777,</div>
<div class="line">    0x88085ae6, 0xff0f6a70, 0x66063bca, 0x11010b5c, 0x8f659eff, 0xf862ae69,</div>
<div class="line">    0x616bffd3, 0x166ccf45, 0xa00ae278, 0xd70dd2ee, 0x4e048354, 0x3903b3c2,</div>
<div class="line">    0xa7672661, 0xd06016f7, 0x4969474d, 0x3e6e77db, 0xaed16a4a, 0xd9d65adc,</div>
<div class="line">    0x40df0b66, 0x37d83bf0, 0xa9bcae53, 0xdebb9ec5, 0x47b2cf7f, 0x30b5ffe9,</div>
<div class="line">    0xbdbdf21c, 0xcabac28a, 0x53b39330, 0x24b4a3a6, 0xbad03605, 0xcdd70693,</div>
<div class="line">    0x54de5729, 0x23d967bf, 0xb3667a2e, 0xc4614ab8, 0x5d681b02, 0x2a6f2b94,</div>
<div class="line">    0xb40bbe37, 0xc30c8ea1, 0x5a05df1b, 0x2d02ef8d</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t crc32(<span class="keyword">const</span> <span class="keywordtype">void</span> *buf, uint32_t size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> uint8_t *p = NULL;</div>
<div class="line">    uint32_t crc = 0;</div>
<div class="line">    <span class="comment">//MEASURE_TIME_VAR();</span></div>
<div class="line"> </div>
<div class="line">    p = (<span class="keyword">const</span> uint8_t *)buf;</div>
<div class="line">    crc = ~0U;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//MEASURE_TIME_START();</span></div>
<div class="line">    <span class="keywordflow">while</span> (size &gt; 0) {</div>
<div class="line">        crc = crc32_tab[(crc ^ *p++) &amp; 0xff] ^ (crc &gt;&gt; 8);</div>
<div class="line">        size--;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//MEASURE_TIME_END(&quot;crc_time&quot;);</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> crc ^ ~0U;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint64_t get_dim_width_size(uint64_t width, uint32_t data_fmt_size, uint32_t bitsize)</div>
<div class="line">{</div>
<div class="line">    uint64_t width_line_size = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (bitsize) {</div>
<div class="line">        <span class="keywordflow">switch</span> (bitsize) {</div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">            width_line_size = (width + 7) &gt;&gt; 3;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 4:</div>
<div class="line">            width_line_size = (width + 3) &gt;&gt; 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 8:</div>
<div class="line">            width_line_size = width;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 16:</div>
<div class="line">            width_line_size = width &lt;&lt; 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 32:</div>
<div class="line">            width_line_size = width &lt;&lt; 2;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            width_line_size = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">switch</span> (data_fmt_size) {</div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">            width_line_size = width; <span class="comment">/* 8bit */</span></div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">            width_line_size = width &lt;&lt; 1; <span class="comment">/* 16bit */</span></div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 2:</div>
<div class="line">            width_line_size = width &lt;&lt; 2; <span class="comment">/* 32bit */</span></div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            width_line_size = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> width_line_size;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> set_io_pair(<span class="keywordtype">char</span> *in_opt, <span class="keyword">struct</span> io_match *io_pair)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *fn_ptr = NULL;</div>
<div class="line">    <span class="keywordtype">size_t</span> len1, len2;</div>
<div class="line"> </div>
<div class="line">    fn_ptr = strchr(in_opt, <span class="charliteral">&#39;=&#39;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (fn_ptr) {</div>
<div class="line">        *fn_ptr = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line">        fn_ptr++;</div>
<div class="line">        len1 = strlen(fn_ptr);</div>
<div class="line">        len2 = strlen(in_opt);</div>
<div class="line">        <span class="keywordflow">if</span> (len1 &gt;= <span class="keyword">sizeof</span>(io_pair-&gt;file_name)) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;io port file [%s] is too long, max[%lu]\n&quot;</span>,</div>
<div class="line">                fn_ptr, <span class="keyword">sizeof</span>(io_pair-&gt;file_name));</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (len2 &gt;= <span class="keyword">sizeof</span>(io_pair-&gt;port_name)) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;io port name [%s] is too long, max[%lu]\n&quot;</span>,</div>
<div class="line">                in_opt, <span class="keyword">sizeof</span>(io_pair-&gt;port_name));</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">        memcpy(io_pair-&gt;port_name, in_opt, len2);</div>
<div class="line">        io_pair-&gt;port_name[len2] = 0;</div>
<div class="line"> </div>
<div class="line">        memcpy(io_pair-&gt;file_name, fn_ptr, len1);</div>
<div class="line">        io_pair-&gt;file_name[len1] = 0;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        len2 = strlen(in_opt);</div>
<div class="line">        <span class="keywordflow">if</span> (len2 &gt;= <span class="keyword">sizeof</span>(io_pair-&gt;port_name)) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;io port name [%s] is too long, max[%lu]\n&quot;</span>,</div>
<div class="line">                in_opt, <span class="keyword">sizeof</span>(io_pair-&gt;port_name));</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">        memcpy(io_pair-&gt;port_name, in_opt, len2);</div>
<div class="line">        io_pair-&gt;port_name[len2] = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> init_param(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>nnctrl_param *pctrl = &amp;G_nnctrl;</div>
<div class="line">    <span class="keyword">enum</span> io_type io_t = IO_INVALID;</div>
<div class="line">    uint32_t net_idx = 0;</div>
<div class="line">    uint32_t in_idx = 0;</div>
<div class="line">    uint32_t out_idx = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> ch = 0;</div>
<div class="line">    <span class="keywordtype">int</span> value = 0;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> long_value = 0;</div>
<div class="line">    <span class="keywordtype">int</span> option_index = 0;</div>
<div class="line">    <span class="keywordtype">int</span> i = 0, net_cnt = 0;</div>
<div class="line">    <span class="keywordtype">char</span> opt_buf[CAVALRY_IO_NAME_MAX + 1 + FILENAME_LENGTH];</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Search how many networks, then malloc corresponding memory */</span></div>
<div class="line">    <span class="keywordflow">for</span> (i = 1; i &lt; argc; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (!strcmp(argv[i], <span class="stringliteral">&quot;-b&quot;</span>) || !strcmp(argv[i], <span class="stringliteral">&quot;-cvr-bin&quot;</span>)) {</div>
<div class="line">            net_cnt++;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Workaround: fix memory leak when enable Sanitizer(-fsanitize=address) */</span></div>
<div class="line">    <span class="keywordflow">if</span> (net_cnt == 0) {</div>
<div class="line">        net_cnt = 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pctrl-&gt;net_pair = (<span class="keyword">struct </span>net_match *)malloc(net_cnt * <span class="keyword">sizeof</span>(<span class="keyword">struct</span> net_match));</div>
<div class="line">    <span class="keywordflow">if</span> (!pctrl-&gt;net_pair) {</div>
<div class="line">        perror(<span class="stringliteral">&quot;malloc total net pair mem\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    memset(pctrl-&gt;net_pair, 0, net_cnt * <span class="keyword">sizeof</span>(<span class="keyword">struct</span> net_match));</div>
<div class="line"> </div>
<div class="line">    opterr = 0;</div>
<div class="line">    optind = 0;</div>
<div class="line">    optopt = 0;</div>
<div class="line">    <span class="keywordflow">while</span> ((ch = getopt_long(argc, argv, short_options, long_options, &amp;option_index)) != -1) {</div>
<div class="line">        <span class="keywordflow">switch</span> (ch) {</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;b&#39;</span>:</div>
<div class="line">            value = strlen(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (value &gt;= FILENAME_LENGTH) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Filename [%s] is too long [%u] (&gt;%u).\n&quot;</span>, optarg,</div>
<div class="line">                value, FILENAME_LENGTH);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            net_idx = pctrl-&gt;net_num;</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].reuse_mem = 1; <span class="comment">/* Enable reuse mem by default */</span></div>
<div class="line">            snprintf(pctrl-&gt;net_pair[net_idx].net_name, <span class="keyword">sizeof</span>(pctrl-&gt;net_pair[net_idx].net_name), <span class="stringliteral">&quot;%s&quot;</span>, optarg);</div>
<div class="line">            printf(<span class="stringliteral">&quot;Cavalry Bin: [%u][%s]\n&quot;</span>, net_idx, pctrl-&gt;net_pair[net_idx].net_name);</div>
<div class="line">            pctrl-&gt;net_num++;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> INPUT:</div>
<div class="line">            value = strlen(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (value &gt; CAVALRY_IO_NAME_MAX + 1 + FILENAME_LENGTH) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;io pair [%s] is too long [%u] (&gt;%u).\n&quot;</span>, optarg,</div>
<div class="line">                value, CAVALRY_IO_NAME_MAX + 1 + FILENAME_LENGTH);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            snprintf(opt_buf, <span class="keyword">sizeof</span>(opt_buf), <span class="stringliteral">&quot;%s&quot;</span>, optarg);</div>
<div class="line">            printf(<span class="stringliteral">&quot;INPUT: [%s]\n&quot;</span>, opt_buf);</div>
<div class="line">            in_idx = pctrl-&gt;net_pair[net_idx].in_num;</div>
<div class="line">            <span class="keywordflow">if</span> (in_idx &gt;= <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga0e2b8805187717eb546342bcea70a22a">MAX_IO_NUM</a>) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;IO pair number is too much: %u &gt; %u.\n&quot;</span>, in_idx, <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga0e2b8805187717eb546342bcea70a22a">MAX_IO_NUM</a>);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (set_io_pair(opt_buf, &amp;pctrl-&gt;net_pair[net_idx].in_pair[in_idx]) &lt; 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;parse io pair [%s] failed, discard.\n&quot;</span>, opt_buf);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].in_pair[in_idx].load_input = 1;</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].in_num++;</div>
<div class="line">            io_t = IO_INPUT;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> OUTPUT:</div>
<div class="line">            value = strlen(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (value &gt; CAVALRY_IO_NAME_MAX + 1 + FILENAME_LENGTH) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;io pair [%s] is too long [%u] (&gt;%u).\n&quot;</span>, optarg,</div>
<div class="line">                value, CAVALRY_IO_NAME_MAX + 1 + FILENAME_LENGTH);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            snprintf(opt_buf, <span class="keyword">sizeof</span>(opt_buf), <span class="stringliteral">&quot;%s&quot;</span>, optarg);</div>
<div class="line">            printf(<span class="stringliteral">&quot;OUTPUT: [%s]\n&quot;</span>, opt_buf);</div>
<div class="line">            out_idx = pctrl-&gt;net_pair[net_idx].out_num;</div>
<div class="line">            <span class="keywordflow">if</span> (out_idx &gt;= <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga0e2b8805187717eb546342bcea70a22a">MAX_IO_NUM</a>) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;IO pair number is too much: %u &gt; %u.\n&quot;</span>, out_idx, <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga0e2b8805187717eb546342bcea70a22a">MAX_IO_NUM</a>);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (set_io_pair(opt_buf, &amp;pctrl-&gt;net_pair[net_idx].out_pair[out_idx]) &lt; 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;parse io pair [%s] failed, discard.\n&quot;</span>, opt_buf);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].out_num++;</div>
<div class="line">            io_t = IO_OUTPUT;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> NO_MEM:</div>
<div class="line">            <span class="keywordflow">if</span> (io_t == IO_INPUT) {</div>
<div class="line">                pctrl-&gt;net_pair[net_idx].in_pair[in_idx].no_mem = 1;</div>
<div class="line">                printf(<span class="stringliteral">&quot;Do not allocate net [%u] input [%u] memory in libnnctrl.\n&quot;</span>,</div>
<div class="line">                    net_idx, in_idx);</div>
<div class="line">            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (io_t == IO_OUTPUT) {</div>
<div class="line">                pctrl-&gt;net_pair[net_idx].out_pair[out_idx].no_mem = 1;</div>
<div class="line">                printf(<span class="stringliteral">&quot;Do not allocate net [%u] output [%u] memory in libnnctrl.\n&quot;</span>,</div>
<div class="line">                    net_idx, out_idx);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                printf(<span class="stringliteral">&quot;--no option only for io port\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> ROTATE_FLIP:</div>
<div class="line">            value = strtoul(optarg, NULL, 0);</div>
<div class="line">            <span class="keywordflow">if</span> (value &amp; (~0x1f)) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid rotate-flip bitmap value: 0x%x, [0x0 ~ 0x1f]\n&quot;</span>, value);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (io_t == IO_INPUT) {</div>
<div class="line">                pctrl-&gt;net_pair[net_idx].in_pair[in_idx].rotate_flip_bitmap = value;</div>
<div class="line">            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (io_t == IO_OUTPUT) {</div>
<div class="line">                pctrl-&gt;net_pair[net_idx].out_pair[out_idx].rotate_flip_bitmap = value;</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                printf(<span class="stringliteral">&quot;--rotate-flip option only for io port\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> UPDATE_IO_PITCH:</div>
<div class="line">            value = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (io_t == IO_INPUT) {</div>
<div class="line">                pctrl-&gt;net_pair[net_idx].in_pair[in_idx].update_pitch = value;</div>
<div class="line">            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (io_t == IO_OUTPUT) {</div>
<div class="line">                pctrl-&gt;net_pair[net_idx].out_pair[out_idx].update_pitch = value;</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                printf(<span class="stringliteral">&quot;--update-pitch option only for io port\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> EXPORT_ALL_IO_PITCH:</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].export_all_pitch = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>:</div>
<div class="line">            value = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (value == 0) {</div>
<div class="line">                pctrl-&gt;all_inter_num = ~0;</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                pctrl-&gt;all_inter_num = value;</div>
<div class="line">            }</div>
<div class="line">            pctrl-&gt;update_inter_num_flag = 1;</div>
<div class="line">            printf(<span class="stringliteral">&quot;Iteration number [%u]\n&quot;</span>, pctrl-&gt;all_inter_num);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> BATCH_NUM:</div>
<div class="line">            value = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (value &lt; 1) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid batch num %u, should &gt;= 1\n&quot;</span>, value);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            pctrl-&gt;all_batch_num = value;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> OFF_REUSE:</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].reuse_mem = 0;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> QUERY_DVI:</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].query_dvi = 1;</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].query_dvi_id = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> SPLIT_NUM:</div>
<div class="line">            value = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (value &lt; 1) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid spllt num %u\n&quot;</span>, value);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].spilt_num = value;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> NO_AUTO_RESUME_NET:</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].net_run.no_auto_resume = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> NO_CHIP_CHECK:</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].no_chip_check = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> RUN_NET_PRIORITY:</div>
<div class="line">            value = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> ((value &lt; CAVALRY_PRIORITY_LOWEST) || (value &gt; CAVALRY_PRIORITY_HIGHEST)) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid priority %u, rang [%u, %u]\n&quot;</span>, value,</div>
<div class="line">                    CAVALRY_PRIORITY_LOWEST, CAVALRY_PRIORITY_HIGHEST);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].net_run.priority = value;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> DUMP_MODE:</div>
<div class="line">            value = strlen(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (value &gt; FILENAME_LENGTH) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Path to dump [%s] is too long [%u] (&gt;%u).\n&quot;</span>, optarg,</div>
<div class="line">                    value, FILENAME_LENGTH);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].dump_net_en = 1;</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].reuse_mem = 0;</div>
<div class="line">            snprintf(pctrl-&gt;net_pair[net_idx].path_dump, <span class="keyword">sizeof</span>(pctrl-&gt;net_pair[net_idx].path_dump), <span class="stringliteral">&quot;%s&quot;</span>, optarg);</div>
<div class="line">            printf(<span class="stringliteral">&quot;Implied disabling blob memory reuse in order to dump.\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> NVP_AFFINITY:</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].nvp_affinity = strtoul(optarg, NULL, 0);</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].set_hw_affinity = 1;</div>
<div class="line">            pctrl-&gt;all_nvp_affinity = strtoul(optarg, NULL, 0);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> GVP_AFFINITY:</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].gvp_affinity = strtoul(optarg, NULL, 0);</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].set_hw_affinity = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> ENCRYPT_CERTIFICATE:</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].encrypt_certificate_filename= optarg;</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].is_encrypted_net = 1;</div>
<div class="line">            printf(<span class="stringliteral">&quot;Encryption Certificate: %s\n&quot;</span>, pctrl-&gt;net_pair[net_idx].encrypt_certificate_filename);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> ENCRYPT_KEY:</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].encrypt_key_filename = optarg;</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].is_encrypted_net = 1;</div>
<div class="line">            printf(<span class="stringliteral">&quot;Encryption Key: %s\n&quot;</span>, pctrl-&gt;net_pair[net_idx].encrypt_key_filename);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> ENCRYPT_DIGEST:</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].encrypt_digest_filename = optarg;</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].is_encrypted_net = 1;</div>
<div class="line">            printf(<span class="stringliteral">&quot;Encryption Digest: %s\n&quot;</span>, pctrl-&gt;net_pair[net_idx].encrypt_digest_filename);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>:</div>
<div class="line">            value = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> ((value &gt;= MODE_FIRST) &amp;&amp; (value &lt;= MODE_LAST)) {</div>
<div class="line">                pctrl-&gt;mode = value;</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid run mode: %d, range[%u, %u]\n&quot;</span>,</div>
<div class="line">                    value, MODE_FIRST, MODE_LAST);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:</div>
<div class="line">            value = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> ((value &lt; <a id="a14" name="a14"></a><a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga6bdeac461478fc7f0ae51c70f7ce190c">NN_LOG_ERR</a>) || (value &gt; <a id="a15" name="a15"></a><a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga39e7b53328351fc47cce0121afb434a4">NN_LOG_VERBOSE</a>)) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;log level %u out of range [%u, %u]\n&quot;</span>,</div>
<div class="line">                    value, <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga6bdeac461478fc7f0ae51c70f7ce190c">NN_LOG_ERR</a>, <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga39e7b53328351fc47cce0121afb434a4">NN_LOG_VERBOSE</a>);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            pctrl-&gt;libnn_log_level = value;</div>
<div class="line">            pctrl-&gt;set_log_level_flag = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;v&#39;</span>:</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].verbose = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> FEED_DUMMY_DATA:</div>
<div class="line">            pctrl-&gt;net_pair[net_idx].feed_dummy_data = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;V&#39;</span>:</div>
<div class="line">            pctrl-&gt;verbose = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> FEED_NET_MEM:</div>
<div class="line">            pctrl-&gt;all_net_feed_mem = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> LOAD_NET_HIGH_MEM:</div>
<div class="line">            long_value = strtoul(optarg, NULL, 0);</div>
<div class="line">            <span class="keywordflow">if</span> (long_value &lt; CV2X_ARM_ACCESS_MEM_BOUNDARY) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid extra_high_mem_phys: 0x%lx, should in range [0x%x, 4GByte)\n&quot;</span>,</div>
<div class="line">                    long_value, CV2X_ARM_ACCESS_MEM_BOUNDARY);</div>
<div class="line">            }</div>
<div class="line">            g_extra_high_mem_phys = value;</div>
<div class="line">            pctrl-&gt;all_en_extra_high_mem = 1;</div>
<div class="line">            printf(<span class="stringliteral">&quot;--------------------------\n&quot;</span>);</div>
<div class="line">            printf(<span class="stringliteral">&quot;Specify Extra High Mem Phys: 0x%x\n&quot;</span>, g_extra_high_mem_phys);</div>
<div class="line">            printf(<span class="stringliteral">&quot;--------------------------\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> EN_DVI_CRC_CHECK:</div>
<div class="line">            pctrl-&gt;all_en_dvi_crc_check = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> KEEP_PADDING:</div>
<div class="line">            pctrl-&gt;all_remove_pad = 0;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> ADD_PORT_META_HEADER:</div>
<div class="line">            pctrl-&gt;all_add_port_meta_header = 1;</div>
<div class="line">            printf(<span class="stringliteral">&quot;Add port header in the head of port data, header size: %lu\n&quot;</span>,</div>
<div class="line">            <span class="keyword">sizeof</span>(<span class="keyword">struct</span> port_meta_header));</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:</div>
<div class="line">            pctrl-&gt;all_cache_en = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;e&#39;</span>:</div>
<div class="line">            pctrl-&gt;all_print_time = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:</div>
<div class="line">            pctrl-&gt;all_single_run_dag = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;k&#39;</span>:</div>
<div class="line">            pctrl-&gt;all_check_md5 = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;w&#39;</span>:</div>
<div class="line">            pctrl-&gt;ck_bw_flag = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> SHOW_ENCRYPT_STATE:</div>
<div class="line">            pctrl-&gt;show_net_encrypt_state_flag = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> SHOW_NET_IO:</div>
<div class="line">            pctrl-&gt;show_net_io_flag = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> VERSION:</div>
<div class="line">            pctrl-&gt;show_version_flag = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> NET_BIN_VERSION:</div>
<div class="line">            pctrl-&gt;show_net_bin_version_flag = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span>:</div>
<div class="line">            <a class="code hl_function" href="../../dc/d60/test__smartfb_8c.html#ad96d407a911fbb914fa8e4cfbf2faf0f">usage</a>();</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            printf(<span class="stringliteral">&quot;unknown option found: %c\n&quot;</span>, ch);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> alloc_cv_mem(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *psize, <span class="keywordtype">int</span> *fd, <span class="keywordtype">void</span> **pvirt)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>nnctrl_param *pctrl = &amp;G_nnctrl;</div>
<div class="line">    <span class="keywordtype">void</span> *virt = NULL;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> size = 0;</div>
<div class="line">    <span class="keywordtype">int</span> memfd = 0;</div>
<div class="line">    uint8_t cache_en = pctrl-&gt;all_cache_en;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    size = *psize;</div>
<div class="line">    <span class="keywordflow">if</span> (<a id="a16" name="a16"></a><a class="code hl_function" href="../../d3/dbf/group__cavalry__mem-api-details.html#ga11496d15c21487b501f9a884337eb4dd">cavalry_mem_alloc_mfd</a>(size, &amp;memfd, &amp;virt, cache_en) &lt; 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;cavalry_mem_alloc err\n&quot;</span>);</div>
<div class="line">        rval = -1;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        *fd = memfd;</div>
<div class="line">        *pvirt = virt;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> sync_cache_mem(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> size, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offset, <span class="keywordtype">int</span> fd,</div>
<div class="line">    uint8_t clean, uint8_t invalid)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>nnctrl_param *pctrl = &amp;G_nnctrl;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (pctrl-&gt;all_cache_en) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a id="a17" name="a17"></a><a class="code hl_function" href="../../d3/dbf/group__cavalry__mem-api-details.html#gac7c5651a00b1b00eadf9690d20b2bedd">cavalry_mem_sync_cache_mfd</a>(size, offset, fd, clean, invalid) &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;cavalry_mem_sync_cache err\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> free_all_cv_mem(<span class="keyword">struct</span> nnctrl_param *pctrl)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>net_match *pnet = NULL;</div>
<div class="line">    <span class="keyword">struct </span>cavalry_mfd_desc *pmem = NULL;</div>
<div class="line">    <span class="keyword">struct </span>io_match *io = NULL;</div>
<div class="line">    uint32_t i = 0, j = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; pctrl-&gt;net_num; i++) {</div>
<div class="line">        pnet = &amp;pctrl-&gt;net_pair[i];</div>
<div class="line">        pmem = &amp;pnet-&gt;net_m;</div>
<div class="line">        <span class="keywordflow">if</span> (pmem-&gt;virt_addr &amp;&amp; pmem-&gt;mem_size) {</div>
<div class="line">            <span class="keywordflow">if</span> (<a id="a18" name="a18"></a><a class="code hl_function" href="../../d3/dbf/group__cavalry__mem-api-details.html#gac1c19b44ff8de3191b58d623ae74f42c">cavalry_mem_free_mfd</a>(pmem-&gt;mem_size,</div>
<div class="line">                pmem-&gt;fd, pmem-&gt;virt_addr) &lt; 0 ) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;cavalry_mem_free err\n&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (j = 0; j &lt; pnet-&gt;in_num; j++) {</div>
<div class="line">            io = &amp;pnet-&gt;in_pair[j];</div>
<div class="line">            <span class="keywordflow">if</span> (io-&gt;no_mem) {</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d3/dbf/group__cavalry__mem-api-details.html#gac1c19b44ff8de3191b58d623ae74f42c">cavalry_mem_free_mfd</a>(io-&gt;dram_size,</div>
<div class="line">                    io-&gt;dram_addr_fd, io-&gt;virt_addr) &lt; 0) {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;cavalry_mem_free err\n&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (j = 0; j &lt; pnet-&gt;out_num; j++) {</div>
<div class="line">            io = &amp;pnet-&gt;out_pair[j];</div>
<div class="line">            <span class="keywordflow">if</span> (io-&gt;no_mem) {</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d3/dbf/group__cavalry__mem-api-details.html#gac1c19b44ff8de3191b58d623ae74f42c">cavalry_mem_free_mfd</a>(io-&gt;dram_size,</div>
<div class="line">                    io-&gt;dram_addr_fd, io-&gt;virt_addr) &lt; 0) {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;cavalry_mem_free err\n&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t <a id="a19" name="a19"></a><a class="code hl_function" href="../../db/db8/file__io_8h.html#afaf3af3799be8b7b8b626f21d3b70167">get_file_size</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *path)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>stat statbuff;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (stat(path, &amp;statbuff) &lt; 0) {</div>
<div class="line">        perror(path);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">return</span> statbuff.st_size;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint8_t *alloc_mem_for_file(<span class="keyword">const</span> <span class="keywordtype">char</span> *file_name, uint32_t *size)</div>
<div class="line">{</div>
<div class="line">    uint8_t *virt = NULL;</div>
<div class="line">    FILE *in = NULL;</div>
<div class="line">    uint32_t file_size = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        file_size = <a class="code hl_function" href="../../db/db8/file__io_8h.html#afaf3af3799be8b7b8b626f21d3b70167">get_file_size</a>(file_name);</div>
<div class="line">        <span class="keywordflow">if</span> (!file_size) {</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        virt = (uint8_t *)malloc(file_size);</div>
<div class="line">        <span class="keywordflow">if</span> (!virt) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Can not alloc memory size: %u\n&quot;</span>, file_size);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        in = fopen(file_name, <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (in == NULL) {</div>
<div class="line">            perror(file_name);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (fread(virt, file_size, 1, in) != 1) {</div>
<div class="line">            perror(file_name);</div>
<div class="line">            <span class="keywordflow">if</span> (virt) {</div>
<div class="line">                free(virt);</div>
<div class="line">                virt = NULL;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">while</span> (0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (in) {</div>
<div class="line">        fclose(in);</div>
<div class="line">        in = NULL;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (size &amp;&amp; virt) {</div>
<div class="line">        *size = file_size;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> virt;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *get_arch_name_by_id(uint8_t vdg_arch)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a25d22ecc7e656d2c59332072684e8766">name</a> = NULL;</div>
<div class="line">    uint32_t arch = vdg_arch;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (arch) {</div>
<div class="line">    <span class="keywordflow">case</span> CAVALRY_VDG_ARCH_BYPASS:</div>
<div class="line">        <a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a25d22ecc7e656d2c59332072684e8766">name</a> = <span class="stringliteral">&quot;Bypass&quot;</span>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> CAVALRY_VDG_ARCH_CV22:</div>
<div class="line">        <a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a25d22ecc7e656d2c59332072684e8766">name</a> = <span class="stringliteral">&quot;cv22&quot;</span>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> CAVALRY_VDG_ARCH_CV2:</div>
<div class="line">        <a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a25d22ecc7e656d2c59332072684e8766">name</a> = <span class="stringliteral">&quot;cv2&quot;</span>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> CAVALRY_VDG_ARCH_CV25:</div>
<div class="line">        <a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a25d22ecc7e656d2c59332072684e8766">name</a> = <span class="stringliteral">&quot;cv25&quot;</span>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> CAVALRY_VDG_ARCH_CV28:</div>
<div class="line">        <a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a25d22ecc7e656d2c59332072684e8766">name</a> = <span class="stringliteral">&quot;cv28&quot;</span>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> CAVALRY_VDG_ARCH_CV5:</div>
<div class="line">        <a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a25d22ecc7e656d2c59332072684e8766">name</a> = <span class="stringliteral">&quot;cv5&quot;</span>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">        <a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a25d22ecc7e656d2c59332072684e8766">name</a> = <span class="stringliteral">&quot;Unknown&quot;</span>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a25d22ecc7e656d2c59332072684e8766">name</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> load_no_padding_file(FILE *in, uint8_t *virt_addr,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code hl_struct" href="../../db/de7/structio__dim.html">io_dim</a> *dim, <span class="keyword">struct</span> <a class="code hl_struct" href="../../d8/d06/structio__data__fmt.html">io_data_fmt</a> *data_fmt, uint32_t final_pitch, uint32_t batch_num)</div>
<div class="line">{</div>
<div class="line">    uint8_t *virt = NULL;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> fused_row = 0, fused_col = 1;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> one_line = 0, column = 0;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a id="a20" name="a20"></a><a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a> = 0, c = 0;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    virt = virt_addr;</div>
<div class="line">    <span class="keywordflow">if</span> (dim-&gt;<a id="a21" name="a21"></a><a class="code hl_variable" href="../../db/de7/structio__dim.html#a5574b64abdcb1e8455471e18f6947d04">dram_fmt</a> == 0) {</div>
<div class="line">        one_line = get_dim_width_size(dim-&gt;<a id="a22" name="a22"></a><a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>, data_fmt-&gt;<a id="a23" name="a23"></a><a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ae5dc6ffcd9b7605c7787791e40cc6bb0">size</a>, data_fmt-&gt;<a id="a24" name="a24"></a><a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#a30ac373a73f28a69e7f5036846722455">bitsize</a>);</div>
<div class="line">        column = dim-&gt;<a id="a25" name="a25"></a><a class="code hl_variable" href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">loop_cnt</a> * dim-&gt;<a id="a26" name="a26"></a><a class="code hl_variable" href="../../db/de7/structio__dim.html#afab25cb00475c5e5167bd688c8935f1d">plane</a> * dim-&gt;<a id="a27" name="a27"></a><a class="code hl_variable" href="../../db/de7/structio__dim.html#af3562adee51a826821063e1a6e7dcd5b">depth</a> * dim-&gt;<a id="a28" name="a28"></a><a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a>;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a5574b64abdcb1e8455471e18f6947d04">dram_fmt</a> == 1) {  <span class="comment">/* fuse the most significant dimension to width dim when dram_fmt=1 */</span></div>
<div class="line">        <span class="keywordflow">if</span> (dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#afab25cb00475c5e5167bd688c8935f1d">plane</a> &gt; 1) {</div>
<div class="line">            fused_row = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#afab25cb00475c5e5167bd688c8935f1d">plane</a> * dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>;</div>
<div class="line">            fused_col = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#af3562adee51a826821063e1a6e7dcd5b">depth</a> * dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a>;</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#af3562adee51a826821063e1a6e7dcd5b">depth</a> &gt; 1) {</div>
<div class="line">            fused_row = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#af3562adee51a826821063e1a6e7dcd5b">depth</a> * dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>;</div>
<div class="line">            fused_col = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a>;</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a> &gt; 1) {</div>
<div class="line">            fused_row = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a> * dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>;</div>
<div class="line">            fused_col = 1;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            fused_row = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>;</div>
<div class="line">            fused_col = 1;</div>
<div class="line">        }</div>
<div class="line">        one_line = get_dim_width_size(fused_row, data_fmt-&gt;<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ae5dc6ffcd9b7605c7787791e40cc6bb0">size</a>, data_fmt-&gt;<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#a30ac373a73f28a69e7f5036846722455">bitsize</a>);</div>
<div class="line">        column = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">loop_cnt</a> * fused_col;</div>
<div class="line">        printf(<span class="stringliteral">&quot;  load_no_padding file for dram_fmt 1, one_row_byte_size: %lu, col_size: %lu\n&quot;</span>,</div>
<div class="line">            one_line, column);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        printf(<span class="stringliteral">&quot;  Unsupport to load_no_padding file to dram_fmt: %u memory\n&quot;</span>, dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a5574b64abdcb1e8455471e18f6947d04">dram_fmt</a>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a> = 0; <a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a> &lt; batch_num; <a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a>++) {</div>
<div class="line">        <span class="keywordflow">for</span> (c = 0; c &lt; column; c++) {</div>
<div class="line">            <span class="keywordflow">if</span> (fread(virt, 1, one_line, in) != one_line) {</div>
<div class="line">                perror(<span class="stringliteral">&quot;fread input file&quot;</span>);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            virt += final_pitch;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> store_no_padding_file(FILE *out, uint8_t *virt_addr,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code hl_struct" href="../../db/de7/structio__dim.html">io_dim</a> *dim, <span class="keyword">struct</span> <a class="code hl_struct" href="../../d8/d06/structio__data__fmt.html">io_data_fmt</a> *data_fmt, uint32_t final_pitch, uint32_t batch_num)</div>
<div class="line">{</div>
<div class="line">    uint8_t *virt = NULL;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> fused_row = 0, fused_col = 1;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> one_line = 0, column = 0;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a> = 0, c = 0;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    virt = virt_addr;</div>
<div class="line">    <span class="keywordflow">if</span> (dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a5574b64abdcb1e8455471e18f6947d04">dram_fmt</a> == 0) {</div>
<div class="line">        one_line = get_dim_width_size(dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>, data_fmt-&gt;<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ae5dc6ffcd9b7605c7787791e40cc6bb0">size</a>, data_fmt-&gt;<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#a30ac373a73f28a69e7f5036846722455">bitsize</a>);</div>
<div class="line">        column = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">loop_cnt</a> * dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#afab25cb00475c5e5167bd688c8935f1d">plane</a> * dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#af3562adee51a826821063e1a6e7dcd5b">depth</a> * dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a>;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a5574b64abdcb1e8455471e18f6947d04">dram_fmt</a> == 1) {  <span class="comment">/* fuse the most significant dimension to width dim when dram_fmt=1 */</span></div>
<div class="line">        <span class="keywordflow">if</span> (dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#afab25cb00475c5e5167bd688c8935f1d">plane</a> &gt; 1) {</div>
<div class="line">            fused_row = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#afab25cb00475c5e5167bd688c8935f1d">plane</a> * dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>;</div>
<div class="line">            fused_col = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#af3562adee51a826821063e1a6e7dcd5b">depth</a> * dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a>;</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#af3562adee51a826821063e1a6e7dcd5b">depth</a> &gt; 1) {</div>
<div class="line">            fused_row = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#af3562adee51a826821063e1a6e7dcd5b">depth</a> * dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>;</div>
<div class="line">            fused_col = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a>;</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a> &gt; 1) {</div>
<div class="line">            fused_row = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a> * dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>;</div>
<div class="line">            fused_col = 1;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            fused_row = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>;</div>
<div class="line">            fused_col = 1;</div>
<div class="line">        }</div>
<div class="line">        one_line = get_dim_width_size(fused_row, data_fmt-&gt;<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ae5dc6ffcd9b7605c7787791e40cc6bb0">size</a>, data_fmt-&gt;<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#a30ac373a73f28a69e7f5036846722455">bitsize</a>);</div>
<div class="line">        column = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">loop_cnt</a> * fused_col;</div>
<div class="line">        printf(<span class="stringliteral">&quot;  store_no_padding file for dram_fmt 1, one_row_byte_size: %lu, col_size: %lu\n&quot;</span>,</div>
<div class="line">            one_line, column);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        printf(<span class="stringliteral">&quot;  Unsupport to store_no_padding file from dram_fmt: %u memory\n&quot;</span>, dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a5574b64abdcb1e8455471e18f6947d04">dram_fmt</a>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a> = 0; <a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a> &lt; batch_num; <a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a>++) {</div>
<div class="line">        <span class="keywordflow">for</span> (c = 0; c &lt; column; c++) {</div>
<div class="line">            <span class="keywordflow">if</span> (fwrite(virt, 1, one_line, out) != one_line) {</div>
<div class="line">                perror(<span class="stringliteral">&quot;fwrite output file&quot;</span>);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            virt += final_pitch;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> load_file_simple(<span class="keyword">const</span> <span class="keywordtype">char</span> *file_name, <span class="keywordtype">void</span> *virt, uint32_t size)</div>
<div class="line">{</div>
<div class="line">    FILE *in = NULL;</div>
<div class="line">    uint32_t file_size = 0;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        in = fopen(file_name, <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (in == NULL) {</div>
<div class="line">            perror(file_name);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (fseek(in, 0, SEEK_END) &lt; 0) {</div>
<div class="line">            perror(<span class="stringliteral">&quot;fseek input file&quot;</span>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        file_size = ftell(in);</div>
<div class="line">        <span class="keywordflow">if</span> (file_size != size) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;specify size [%u] doesn&#39;t match input file size [%u]\n&quot;</span>,</div>
<div class="line">                size, file_size);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (fseek(in, 0, SEEK_SET) &lt; 0) {</div>
<div class="line">            perror(<span class="stringliteral">&quot;fseek input file&quot;</span>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (fread(virt, 1, size, in) != size) {</div>
<div class="line">            perror(<span class="stringliteral">&quot;fread input file&quot;</span>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">while</span> (0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (in) {</div>
<div class="line">        fclose(in);</div>
<div class="line">        in = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> load_file(<span class="keyword">const</span> <span class="keywordtype">char</span> *file_name, uint8_t *virt_addr, uint64_t one_size,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code hl_struct" href="../../db/de7/structio__dim.html">io_dim</a> *dim, <span class="keyword">struct</span> <a class="code hl_struct" href="../../d8/d06/structio__data__fmt.html">io_data_fmt</a> *data_fmt,</div>
<div class="line">    uint32_t update_pitch, uint32_t batch_num)</div>
<div class="line">{</div>
<div class="line">    FILE *in = NULL;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> final_pitch = 0;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> file_size = 0;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> no_padding_size = 0;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> size = one_size * batch_num;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        <span class="keywordflow">if</span> ((in = fopen(file_name, <span class="stringliteral">&quot;rb&quot;</span>)) == NULL) {</div>
<div class="line">            perror(file_name);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (fseek(in, 0, SEEK_END) &lt; 0) {</div>
<div class="line">            perror(<span class="stringliteral">&quot;fseek input file&quot;</span>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        file_size = ftell(in);</div>
<div class="line">        <span class="keywordflow">if</span> (fseek(in, 0, SEEK_SET) &lt; 0) {</div>
<div class="line">            perror(<span class="stringliteral">&quot;fseek input file&quot;</span>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (file_size == size) {</div>
<div class="line">            <span class="keywordflow">if</span> (fread(virt_addr, 1, size, in) != size) {</div>
<div class="line">                perror(<span class="stringliteral">&quot;fread input file&quot;</span>);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            final_pitch = update_pitch ? update_pitch : dim-&gt;<a id="a29" name="a29"></a><a class="code hl_variable" href="../../db/de7/structio__dim.html#a6151b90948f9409a6ad67219369dd801">pitch</a>;</div>
<div class="line">            no_padding_size = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">loop_cnt</a> * dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#afab25cb00475c5e5167bd688c8935f1d">plane</a> * dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#af3562adee51a826821063e1a6e7dcd5b">depth</a> * dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a> *</div>
<div class="line">                get_dim_width_size(dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>, data_fmt-&gt;<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ae5dc6ffcd9b7605c7787791e40cc6bb0">size</a>, data_fmt-&gt;<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#a30ac373a73f28a69e7f5036846722455">bitsize</a>) * batch_num;</div>
<div class="line">            <span class="keywordflow">if</span> (file_size == no_padding_size) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Load no-padding file [%s] size [%lu]. Width: %lu, dfmt_size: %u, Pitch: %lu\n&quot;</span>,</div>
<div class="line">                    file_name, file_size, dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>, data_fmt-&gt;<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ae5dc6ffcd9b7605c7787791e40cc6bb0">size</a>, final_pitch);</div>
<div class="line">                rval = load_no_padding_file(in, virt_addr, dim, data_fmt, final_pitch, batch_num);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                printf(<span class="stringliteral">&quot;File [%s] size [%lu] mismatch input size [%lu] &quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;or no_padding size [%lu]\n&quot;</span>,</div>
<div class="line">                    file_name, file_size, size, no_padding_size);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">while</span> (0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (in) {</div>
<div class="line">        fclose(in);</div>
<div class="line">        in = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> format_meta_header(<span class="keyword">struct</span> port_meta_header *hdr, <span class="keyword">const</span> <span class="keywordtype">char</span> *net_filename)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a id="_a30" name="_a30"></a><a class="code hl_struct" href="../../d5/d3e/structnet__bin__version.html">net_bin_version</a> bin_ver = {0};</div>
<div class="line">    <span class="keyword">struct </span><a id="_a31" name="_a31"></a><a class="code hl_struct" href="../../d1/d44/structnnctrl__version.html">nnctrl_version</a> lib_ver = {0};</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    hdr-&gt;magic_num = PORT_META_HEADER_MAGIC_NUM;</div>
<div class="line">    hdr-&gt;api_version = PORT_META_HEADER_API_VERSION;</div>
<div class="line">    hdr-&gt;header_payload_size = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>port_meta_header) -</div>
<div class="line">        offsetof(struct port_meta_header, header_payload_size);</div>
<div class="line"> </div>
<div class="line">    hdr-&gt;pitch_align_rule = CAVALRY_PORT_PITCH_ALIGN;</div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        bin_ver.<a id="a32" name="a32"></a><a class="code hl_variable" href="../../d5/d3e/structnet__bin__version.html#a63cde667c15df0743427416708b7a45c">net_file</a> = net_filename;</div>
<div class="line">        rval = <a id="a33" name="a33"></a><a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#ga2e54cd7df70002d6a5f8bee58dc5a3ba">nnctrl_get_net_bin_version</a>(&amp;bin_ver);</div>
<div class="line">        <span class="keywordflow">if</span> (rval) {</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        snprintf(hdr-&gt;cavalry_gen_ver, <span class="keyword">sizeof</span>(hdr-&gt;cavalry_gen_ver),</div>
<div class="line">            <span class="stringliteral">&quot;Cavalry Gen Version: %u.%u.%u.%u\n&quot;</span>,</div>
<div class="line">            <a id="a34" name="a34"></a><a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga9b8a1d5299e0f02ef59e27ef5713104b">GET_CAVALRY_MAJ_VER</a>(bin_ver.<a id="a35" name="a35"></a><a class="code hl_variable" href="../../d5/d3e/structnet__bin__version.html#aee8a17f0e8b74a97832ab1824d1aba20">cavalry_gen_version</a>),</div>
<div class="line">            <a id="a36" name="a36"></a><a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga3bd8b633ac23950949e26e99c402b23d">GET_CAVALRY_MIN_VER</a>(bin_ver.<a class="code hl_variable" href="../../d5/d3e/structnet__bin__version.html#aee8a17f0e8b74a97832ab1824d1aba20">cavalry_gen_version</a>),</div>
<div class="line">            <a id="a37" name="a37"></a><a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#gab0b85d308346a48417ca7c6a75bc0403">GET_CAVALRY_API_VER</a>(bin_ver.<a class="code hl_variable" href="../../d5/d3e/structnet__bin__version.html#aee8a17f0e8b74a97832ab1824d1aba20">cavalry_gen_version</a>),</div>
<div class="line">            bin_ver.<a id="a38" name="a38"></a><a class="code hl_variable" href="../../d5/d3e/structnet__bin__version.html#ac86996e2075c6c7db5004ecfc6777157">cavalry_compat_version</a>);</div>
<div class="line">        snprintf(hdr-&gt;chip_name, <span class="keyword">sizeof</span>(hdr-&gt;chip_name),</div>
<div class="line">            <span class="stringliteral">&quot;VDG Chip Arch: %s\n&quot;</span>, get_arch_name_by_id(bin_ver.<a id="a39" name="a39"></a><a class="code hl_variable" href="../../d5/d3e/structnet__bin__version.html#ad58fa20ade994ca3ac378e6dc8e809f0">vdg_arch</a>));</div>
<div class="line"> </div>
<div class="line">        rval = <a id="a40" name="a40"></a><a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#ga945387bab991147baebaf92cf47389cd">nnctrl_get_version</a>(&amp;lib_ver);</div>
<div class="line">        <span class="keywordflow">if</span> (rval &lt; 0) {</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        snprintf(hdr-&gt;cavalry_parser_ver, <span class="keyword">sizeof</span>(hdr-&gt;cavalry_parser_ver),</div>
<div class="line">            <span class="stringliteral">&quot;Libnntrl Version: %u.%u.%u.%u. \n&quot;</span>,</div>
<div class="line">            <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga9b8a1d5299e0f02ef59e27ef5713104b">GET_CAVALRY_MAJ_VER</a>(lib_ver.<a id="a41" name="a41"></a><a class="code hl_variable" href="../../d1/d44/structnnctrl__version.html#a6572b29c16030fbdca67e71f3c8c0233">cavalry_parser</a>),</div>
<div class="line">            <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga3bd8b633ac23950949e26e99c402b23d">GET_CAVALRY_MIN_VER</a>(lib_ver.<a class="code hl_variable" href="../../d1/d44/structnnctrl__version.html#a6572b29c16030fbdca67e71f3c8c0233">cavalry_parser</a>),</div>
<div class="line">            <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#gab0b85d308346a48417ca7c6a75bc0403">GET_CAVALRY_API_VER</a>(lib_ver.<a class="code hl_variable" href="../../d1/d44/structnnctrl__version.html#a6572b29c16030fbdca67e71f3c8c0233">cavalry_parser</a>),</div>
<div class="line">            lib_ver.<a id="a42" name="a42"></a><a class="code hl_variable" href="../../d1/d44/structnnctrl__version.html#a499cd1589d0fa6e6e8a639090024c652">cavalry_compat</a>);</div>
<div class="line">        snprintf(hdr-&gt;libnnctrl_ver, <span class="keyword">sizeof</span>(hdr-&gt;libnnctrl_ver),</div>
<div class="line">            <span class="stringliteral">&quot;%s: %u.%u.%u, mod-time: 0x%x\n&quot;</span>,</div>
<div class="line">            lib_ver.<a id="a43" name="a43"></a><a class="code hl_variable" href="../../d1/d44/structnnctrl__version.html#ac48a22b1e5a1a1c27eeef05e54529e79">description</a>, lib_ver.<a id="a44" name="a44"></a><a class="code hl_variable" href="../../d1/d44/structnnctrl__version.html#acaa8a60018b724301b0de7b13fa449d1">major</a>, lib_ver.<a id="a45" name="a45"></a><a class="code hl_variable" href="../../d1/d44/structnnctrl__version.html#a7feeb248b9f5c0a309c4ec51a3ec57da">minor</a>, lib_ver.<a id="a46" name="a46"></a><a class="code hl_variable" href="../../d1/d44/structnnctrl__version.html#a69405a866dc8c7f6b24012fbaa0591f8">patch</a>, lib_ver.<a id="a47" name="a47"></a><a class="code hl_variable" href="../../d1/d44/structnnctrl__version.html#a0131a40dc6588ef6cad4531e95172584">mod_time</a>);</div>
<div class="line">    } <span class="keywordflow">while</span> (0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> store_file(<span class="keyword">const</span> <span class="keywordtype">char</span> *net_filename, <span class="keyword">const</span> <span class="keywordtype">char</span> *port_name,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *file_name, uint8_t *virt_addr, uint32_t one_size,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code hl_struct" href="../../db/de7/structio__dim.html">io_dim</a> *dim, <span class="keyword">struct</span> <a class="code hl_struct" href="../../d8/d06/structio__data__fmt.html">io_data_fmt</a> *data_fmt,</div>
<div class="line">    uint32_t update_pitch, uint32_t batch_num,</div>
<div class="line">    uint8_t remove_pad, uint8_t add_port_header)</div>
<div class="line">{</div>
<div class="line">    FILE *out = NULL;</div>
<div class="line">    <span class="keyword">struct </span>port_meta_header port_hdr = {0};</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> final_pitch = 0;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> no_padding_size = 0;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> size = one_size * batch_num;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        <span class="keywordflow">if</span> ((out = fopen(file_name, <span class="stringliteral">&quot;w+b&quot;</span>)) == NULL) {</div>
<div class="line">            perror(file_name);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        final_pitch = update_pitch ? update_pitch : dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a6151b90948f9409a6ad67219369dd801">pitch</a>;</div>
<div class="line">        no_padding_size = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">loop_cnt</a> * dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#afab25cb00475c5e5167bd688c8935f1d">plane</a> * dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#af3562adee51a826821063e1a6e7dcd5b">depth</a> * dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a> *</div>
<div class="line">            get_dim_width_size(dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>, data_fmt-&gt;<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ae5dc6ffcd9b7605c7787791e40cc6bb0">size</a>, data_fmt-&gt;<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#a30ac373a73f28a69e7f5036846722455">bitsize</a>) * batch_num;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (add_port_header) {</div>
<div class="line">            rval = format_meta_header(&amp;port_hdr, net_filename);</div>
<div class="line">            <span class="keywordflow">if</span> (rval) {</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            snprintf(port_hdr.port_name, <span class="keyword">sizeof</span>(port_hdr.port_name), <span class="stringliteral">&quot;%s&quot;</span>, port_name);</div>
<div class="line">            <span class="keywordflow">if</span> ((dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">loop_cnt</a> == 1) || (dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">loop_cnt</a> == 0)) {</div>
<div class="line">                port_hdr.port_size = one_size;</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                port_hdr.port_size = one_size / dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">loop_cnt</a>;</div>
<div class="line">            }</div>
<div class="line">            port_hdr.dim_plane = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#afab25cb00475c5e5167bd688c8935f1d">plane</a>;</div>
<div class="line">            port_hdr.dim_depth = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#af3562adee51a826821063e1a6e7dcd5b">depth</a>;</div>
<div class="line">            port_hdr.dim_height = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a>;</div>
<div class="line">            <span class="keywordflow">if</span> (remove_pad) {</div>
<div class="line">                port_hdr.dim_pitch = get_dim_width_size(dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>, data_fmt-&gt;<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ae5dc6ffcd9b7605c7787791e40cc6bb0">size</a>, data_fmt-&gt;<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#a30ac373a73f28a69e7f5036846722455">bitsize</a>);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                port_hdr.dim_pitch = final_pitch;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            port_hdr.bitvector = dim-&gt;<a id="a48" name="a48"></a><a class="code hl_variable" href="../../db/de7/structio__dim.html#aac4ab403272f5be55e966d2735ceb313">bitvector</a>;</div>
<div class="line">            port_hdr.dram_fmt = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a5574b64abdcb1e8455471e18f6947d04">dram_fmt</a>;</div>
<div class="line">            port_hdr.loop_cnt = dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">loop_cnt</a>;</div>
<div class="line"> </div>
<div class="line">            port_hdr.data_fmt_sign = data_fmt-&gt;<a id="a49" name="a49"></a><a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#a0e0ace816facf5d8b503eb83e8e798b8">sign</a>;</div>
<div class="line">            port_hdr.data_fmt_size = data_fmt-&gt;<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ae5dc6ffcd9b7605c7787791e40cc6bb0">size</a>;</div>
<div class="line">            port_hdr.data_fmt_expoffset = data_fmt-&gt;<a id="a50" name="a50"></a><a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#a375c68753379e89f4548d93e5e41d41d">expoffset</a>;</div>
<div class="line">            port_hdr.data_fmt_expbits = data_fmt-&gt;<a id="a51" name="a51"></a><a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ad9cd444e0d5bf7539865ca6dc194d92e">expbits</a>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (fwrite(&amp;port_hdr, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> port_meta_header), 1, out) != 1) {</div>
<div class="line">                perror(file_name);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (remove_pad &amp;&amp; (no_padding_size != size)) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Store no-padding file [%s] size [%lu]. Width: %lu, Pitch: %lu\n&quot;</span>,</div>
<div class="line">                file_name, no_padding_size, dim-&gt;<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>, final_pitch);</div>
<div class="line">            rval = store_no_padding_file(out, virt_addr, dim, data_fmt, final_pitch, batch_num);</div>
<div class="line">            <span class="keywordflow">if</span> (rval) {</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">if</span> (fwrite(virt_addr, size, 1, out) != 1) {</div>
<div class="line">                perror(file_name);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">while</span> (0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (out) {</div>
<div class="line">        fclose(out);</div>
<div class="line">        out = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Return value:  -1: err;   0: ok;   1: ok, input has set no_mem */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> load_input_io(<span class="keyword">struct</span> net_match *pnet)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>io_match *io = NULL;</div>
<div class="line">    uint32_t k = 0;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line">    uint32_t batch_num = 0;</div>
<div class="line">    batch_num = (pnet-&gt;batch_num &gt; 1) ? pnet-&gt;batch_num : 1;</div>
<div class="line"> </div>
<div class="line">    for (k = 0; k &lt; pnet-&gt;in_num; k++) {</div>
<div class="line">        io = &amp;pnet-&gt;in_pair[k];</div>
<div class="line">        <span class="keywordflow">if</span> (io-&gt;virt_addr == NULL) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Not found addr for input port [%s]\n&quot;</span>, io-&gt;port_name);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (strlen(io-&gt;file_name) &gt; 0) {</div>
<div class="line">            <span class="keywordflow">if</span> (load_file(io-&gt;file_name, io-&gt;virt_addr, io-&gt;data_size,</div>
<div class="line">                &amp;io-&gt;dim, &amp;io-&gt;data_fmt, io-&gt;update_pitch, batch_num) &lt; 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Load input port [%s] with file [%s] failed!\n&quot;</span>,</div>
<div class="line">                    io-&gt;port_name, io-&gt;file_name);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/* always sync input cache avoid libnnctrl load default data for const port */</span></div>
<div class="line">        sync_cache_mem(io-&gt;data_size * batch_num, io-&gt;dram_offset, io-&gt;dram_addr_fd, 1, 0);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> clean_output_mem(<span class="keyword">struct</span> net_match *pnet)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>io_match *io = NULL;</div>
<div class="line">    uint32_t k = 0;</div>
<div class="line">    uint32_t batch_num = 0;</div>
<div class="line">    batch_num = (pnet-&gt;batch_num &gt; 1) ? pnet-&gt;batch_num : 1;</div>
<div class="line"> </div>
<div class="line">    for (k = 0; k &lt; pnet-&gt;out_num; k ++) {</div>
<div class="line">        io = &amp;pnet-&gt;out_pair[k];</div>
<div class="line">        memset(io-&gt;virt_addr, 0, io-&gt;data_size * batch_num);</div>
<div class="line">        sync_cache_mem(io-&gt;data_size * batch_num, io-&gt;dram_offset, io-&gt;dram_addr_fd, 1, 0);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> invalid_output_mem(<span class="keyword">struct</span> net_match *pnet)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>io_match *io = NULL;</div>
<div class="line">    uint32_t k = 0;</div>
<div class="line">    uint32_t batch_num = 0;</div>
<div class="line">    batch_num = (pnet-&gt;batch_num &gt; 1) ? pnet-&gt;batch_num : 1;</div>
<div class="line"> </div>
<div class="line">    for (k = 0; k &lt; pnet-&gt;out_num; k ++) {</div>
<div class="line">        io = &amp;pnet-&gt;out_pair[k];</div>
<div class="line">        sync_cache_mem(io-&gt;data_size * batch_num, io-&gt;dram_offset, io-&gt;dram_addr_fd, 0, 1);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> clean_output_padding(<span class="keyword">struct</span> net_match *pnet)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>io_match *io = NULL;</div>
<div class="line">    uint8_t *virt = NULL;</div>
<div class="line">    uint32_t k = 0, c = 0, i = 0, <a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a> = 0;</div>
<div class="line">    uint32_t padding_size = 0, one_line = 0, column = 0;</div>
<div class="line">    uint8_t bit_num = 0, bit_gap = 0, bit_mask = 0;</div>
<div class="line">    uint32_t batch_num = 0;</div>
<div class="line">    batch_num = (pnet-&gt;batch_num &gt; 1) ? pnet-&gt;batch_num : 1;</div>
<div class="line"> </div>
<div class="line">    for (k = 0; k &lt; pnet-&gt;out_num; k ++) {</div>
<div class="line">        io = &amp;pnet-&gt;out_pair[k];</div>
<div class="line">        <span class="keywordflow">if</span> ((io-&gt;data_fmt.size == DATASIZE_INVALID) || (io-&gt;dim.dram_fmt)) {</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line">        virt = io-&gt;virt_addr;</div>
<div class="line">        column = io-&gt;dim.loop_cnt * io-&gt;dim.plane * io-&gt;dim.depth * io-&gt;dim.height;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (!io-&gt;dim.bitvector) {</div>
<div class="line">            one_line = io-&gt;dim.width * (1 &lt;&lt; io-&gt;data_fmt.size);</div>
<div class="line">            virt += one_line;</div>
<div class="line">            padding_size = io-&gt;dim.pitch - one_line;</div>
<div class="line">            <span class="keywordflow">if</span> (padding_size &gt; 0) {</div>
<div class="line">                <span class="keywordflow">for</span> (<a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a> = 0; <a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a> &lt; batch_num; <a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a>++) {</div>
<div class="line">                    <span class="keywordflow">for</span> (c = 0; c &lt; column; c++) {</div>
<div class="line">                        memset(virt, 0, padding_size);</div>
<div class="line">                        virt += io-&gt;dim.pitch;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">                #ifndef DMABUF_SYNC</span></div>
<div class="line">                sync_cache_mem(io-&gt;data_size * batch_num, io-&gt;dram_offset, pnet-&gt;net_m.fd, 1, 0);</div>
<div class="line"><span class="preprocessor">                #endif</span></div>
<div class="line">            }</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            one_line = io-&gt;dim.width / 8;</div>
<div class="line">            bit_num = io-&gt;dim.width - one_line * 8;</div>
<div class="line">            <span class="keywordflow">for</span> (i = 0; i &lt; bit_num; i++) {</div>
<div class="line">                bit_mask = bit_mask | (1 &lt;&lt; (7 - i));</div>
<div class="line">            }</div>
<div class="line">            virt += one_line;</div>
<div class="line">            bit_gap = bit_num ? 1 : 0;</div>
<div class="line">            padding_size = io-&gt;dim.pitch - one_line - bit_gap;</div>
<div class="line">            printf (<span class="stringliteral">&quot;clean_padding for bitvector, &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;bit_num: %u, bit_mask: 0x%x, one_bit: %u, padding_size: %u\n&quot;</span>,</div>
<div class="line">                bit_num, bit_mask, bit_gap, padding_size);</div>
<div class="line">            <span class="keywordflow">if</span> (padding_size &gt; 0) {</div>
<div class="line">                <span class="keywordflow">for</span> (<a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a> = 0; <a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a> &lt; batch_num; <a class="code hl_variable" href="../../d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a>++) {</div>
<div class="line">                    <span class="keywordflow">for</span> (c = 0; c &lt; column; c++) {</div>
<div class="line">                        <span class="keywordflow">if</span> (bit_gap) {</div>
<div class="line">                            *virt = (*virt) &amp; bit_mask;</div>
<div class="line">                        }</div>
<div class="line">                        memset(virt + bit_gap, 0, padding_size);</div>
<div class="line">                        virt += io-&gt;dim.pitch;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">                #ifndef DMABUF_SYNC</span></div>
<div class="line">                sync_cache_mem(io-&gt;data_size * batch_num, io-&gt;dram_offset, pnet-&gt;net_m.fd, 1, 0);</div>
<div class="line"><span class="preprocessor">                #endif</span></div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> process_output_mem(<span class="keyword">struct</span> net_match *pnet)</div>
<div class="line">{</div>
<div class="line"><span class="preprocessor">#define EXT_LEN (32)</span></div>
<div class="line">    <span class="keyword">struct </span>nnctrl_param *pctrl = &amp;G_nnctrl;</div>
<div class="line">    <span class="keyword">struct </span>io_match *io = NULL;</div>
<div class="line">    <span class="keywordtype">char</span> file_bad[FILENAME_LENGTH + EXT_LEN] = {0};</div>
<div class="line">    uint32_t cksum = 0, cksum_again = 0;</div>
<div class="line">    uint32_t batch_num = 0;</div>
<div class="line">    uint32_t k = 0;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    batch_num = (pnet-&gt;batch_num &gt; 1) ? pnet-&gt;batch_num : 1;</div>
<div class="line"> </div>
<div class="line">    for (k = 0; k &lt; pnet-&gt;out_num; k ++) {</div>
<div class="line">        io = &amp;pnet-&gt;out_pair[k];</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* CRC check */</span></div>
<div class="line">        <span class="keywordflow">if</span> (pctrl-&gt;all_check_md5) {</div>
<div class="line">            cksum = crc32(io-&gt;virt_addr, io-&gt;data_size * batch_num);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (io-&gt;crc_inited == 0) {</div>
<div class="line">                io-&gt;crc_result = cksum;</div>
<div class="line">                io-&gt;crc_inited = 1;</div>
<div class="line">                printf(<span class="stringliteral">&quot;Port [%s] CRC: %08x\n&quot;</span>, io-&gt;port_name, io-&gt;crc_result);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="keywordflow">if</span> (cksum != io-&gt;crc_result) {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;Check [%s] CRC err, real: %08x, expect: %08x\n&quot;</span>,</div>
<div class="line">                        io-&gt;port_name, cksum, io-&gt;crc_result);</div>
<div class="line">                    rval = -1;</div>
<div class="line">                    <span class="keywordflow">if</span> (strlen(io-&gt;file_name) &gt; 0) {</div>
<div class="line">                        snprintf(file_bad, <span class="keyword">sizeof</span>(file_bad), <span class="stringliteral">&quot;%s_%08x_crc&quot;</span>,</div>
<div class="line">                            io-&gt;file_name, cksum);</div>
<div class="line">                        <span class="keywordflow">if</span> (store_file(pnet-&gt;net_name, io-&gt;port_name,</div>
<div class="line">                            file_bad, io-&gt;virt_addr, io-&gt;data_size,</div>
<div class="line">                            &amp;io-&gt;dim, &amp;io-&gt;data_fmt,</div>
<div class="line">                            io-&gt;update_pitch, batch_num,</div>
<div class="line">                            pnet-&gt;remove_pad, pnet-&gt;add_port_meta_header) &lt; 0) {</div>
<div class="line">                            printf(<span class="stringliteral">&quot;Store output port [%s] to file [%s] failed\n&quot;</span>,</div>
<div class="line">                                io-&gt;port_name, file_bad);</div>
<div class="line">                            rval = -1;</div>
<div class="line">                        }</div>
<div class="line">                        printf(<span class="stringliteral">&quot;Store output %s for CRC check\n&quot;</span>, file_bad);</div>
<div class="line">                    }</div>
<div class="line"> </div>
<div class="line">                    cksum_again = crc32(io-&gt;virt_addr, io-&gt;data_size * batch_num);</div>
<div class="line">                    <span class="keywordflow">if</span> (cksum_again != io-&gt;crc_result) {</div>
<div class="line">                        printf(<span class="stringliteral">&quot;Check [%s] CRC err again, real: %08x, expect: %08x\n&quot;</span>,</div>
<div class="line">                        io-&gt;port_name, cksum_again, io-&gt;crc_result);</div>
<div class="line">                        rval = -1;</div>
<div class="line">                        <span class="keywordflow">if</span> (cksum_again != cksum) {</div>
<div class="line">                            <span class="keywordflow">if</span> (strlen(io-&gt;file_name) &gt; 0) {</div>
<div class="line">                                snprintf(file_bad, <span class="keyword">sizeof</span>(file_bad), <span class="stringliteral">&quot;%s_%08x_crc_again&quot;</span>,</div>
<div class="line">                                    io-&gt;file_name, cksum_again);</div>
<div class="line">                                <span class="keywordflow">if</span> (store_file(pnet-&gt;net_name, io-&gt;port_name,</div>
<div class="line">                                    file_bad, io-&gt;virt_addr, io-&gt;data_size,</div>
<div class="line">                                    &amp;io-&gt;dim, &amp;io-&gt;data_fmt,</div>
<div class="line">                                    io-&gt;update_pitch, batch_num,</div>
<div class="line">                                    pnet-&gt;remove_pad, pnet-&gt;add_port_meta_header) &lt; 0) {</div>
<div class="line">                                    printf(<span class="stringliteral">&quot;Store output port [%s] to file [%s] failed\n&quot;</span>,</div>
<div class="line">                                        io-&gt;port_name, file_bad);</div>
<div class="line">                                    rval = -1;</div>
<div class="line">                                }</div>
<div class="line">                                printf(<span class="stringliteral">&quot;Store output %s for CRC check\n&quot;</span>, file_bad);</div>
<div class="line">                            }</div>
<div class="line">                        }</div>
<div class="line">                    } <span class="keywordflow">else</span> {</div>
<div class="line">                        printf(<span class="stringliteral">&quot;CRC: %08x recovers from first fail\n&quot;</span>, cksum_again);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* STORE output blob */</span></div>
<div class="line">        <span class="keywordflow">if</span> (strlen(io-&gt;file_name) &gt; 0) {</div>
<div class="line">            <span class="keywordflow">if</span> (io-&gt;out_stored == 0) {</div>
<div class="line">                <span class="keywordflow">if</span> (store_file(pnet-&gt;net_name, io-&gt;port_name,</div>
<div class="line">                    io-&gt;file_name, io-&gt;virt_addr, io-&gt;data_size,</div>
<div class="line">                    &amp;io-&gt;dim, &amp;io-&gt;data_fmt,</div>
<div class="line">                    io-&gt;update_pitch, batch_num,</div>
<div class="line">                    pnet-&gt;remove_pad, pnet-&gt;add_port_meta_header) &lt; 0) {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;Store output port [%s] to file [%s] failed\n&quot;</span>,</div>
<div class="line">                        io-&gt;port_name, io-&gt;file_name);</div>
<div class="line">                    rval = -1;</div>
<div class="line">                }</div>
<div class="line">                io-&gt;out_stored = 1;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> set_net_io_no_mem(<span class="keyword">struct</span> net_match *pnet,</div>
<div class="line">    <span class="keyword">struct</span> <a id="_a52" name="_a52"></a><a class="code hl_struct" href="../../d3/d35/structnet__input__mfd__cfg.html">net_input_mfd_cfg</a> *net_in, <span class="keyword">struct</span> <a id="_a53" name="_a53"></a><a class="code hl_struct" href="../../d8/d85/structnet__output__mfd__cfg.html">net_output_mfd_cfg</a> *net_out)</div>
<div class="line">{</div>
<div class="line">    uint32_t i = 0;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    net_in-&gt;<a id="a54" name="a54"></a><a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a88b08f224c035fa5cae2217e6d67afda">in_num</a> = pnet-&gt;in_num;</div>
<div class="line">    net_out-&gt;<a id="a55" name="a55"></a><a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a17afdb10821678afccc3bec8d83e1625">out_num</a> = pnet-&gt;out_num;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a88b08f224c035fa5cae2217e6d67afda">in_num</a>; i++) {</div>
<div class="line">        net_in-&gt;<a id="a56" name="a56"></a><a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a id="a57" name="a57"></a><a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">name</a> = pnet-&gt;in_pair[i].port_name;</div>
<div class="line">        <span class="keywordflow">if</span> (pnet-&gt;in_pair[i].no_mem) {</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a id="a58" name="a58"></a><a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a05b251f6f4721e4b738a9439a7eda472">no_mem</a> = 1;</div>
<div class="line">        }</div>
<div class="line">        net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a id="a59" name="a59"></a><a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a8df7d51bc3df84df92cf0b247af8d909">rotate_flip_bitmap</a> = pnet-&gt;in_pair[i].rotate_flip_bitmap;</div>
<div class="line">        <span class="keywordflow">if</span> (pnet-&gt;in_pair[i].update_pitch) { <span class="comment">//Do not update_pitch if it&#39;s zero</span></div>
<div class="line">            <span class="keywordflow">if</span> (pnet-&gt;in_pair[i].no_mem == 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Should set no_mem when set update_pitch for input [%s]\n&quot;</span>,</div>
<div class="line">                    net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">name</a>);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a id="a60" name="a60"></a><a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#abdb7d98eb79205cdc90022a4c4b75d16">update_pitch</a> = pnet-&gt;in_pair[i].update_pitch;</div>
<div class="line">            printf(<span class="stringliteral">&quot;Set input [%s] update_pitch: %lu\n&quot;</span>,</div>
<div class="line">                net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">name</a>, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#abdb7d98eb79205cdc90022a4c4b75d16">update_pitch</a>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a17afdb10821678afccc3bec8d83e1625">out_num</a>; i++) {</div>
<div class="line">        net_out-&gt;<a id="a61" name="a61"></a><a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a id="a62" name="a62"></a><a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">name</a> = pnet-&gt;out_pair[i].port_name;</div>
<div class="line">        <span class="keywordflow">if</span> (pnet-&gt;out_pair[i].no_mem) {</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a id="a63" name="a63"></a><a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a05b251f6f4721e4b738a9439a7eda472">no_mem</a> = 1;</div>
<div class="line">        }</div>
<div class="line">        net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a id="a64" name="a64"></a><a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a8df7d51bc3df84df92cf0b247af8d909">rotate_flip_bitmap</a> = pnet-&gt;out_pair[i].rotate_flip_bitmap;</div>
<div class="line">        <span class="keywordflow">if</span> (pnet-&gt;out_pair[i].update_pitch) { <span class="comment">//Do not update_pitch if it&#39;s zero</span></div>
<div class="line">            <span class="keywordflow">if</span> (pnet-&gt;out_pair[i].no_mem == 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Should set no_mem when set update_pitch for output [%s]\n&quot;</span>,</div>
<div class="line">                    net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">name</a>);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a id="a65" name="a65"></a><a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#abdb7d98eb79205cdc90022a4c4b75d16">update_pitch</a> = pnet-&gt;out_pair[i].update_pitch;</div>
<div class="line">            printf(<span class="stringliteral">&quot;Set output [%s] update_pitch: %lu\n&quot;</span>,</div>
<div class="line">                net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">name</a>, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#abdb7d98eb79205cdc90022a4c4b75d16">update_pitch</a>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> get_net_io_size_no_mem(<span class="keyword">struct</span> net_match *pnet,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code hl_struct" href="../../d3/d35/structnet__input__mfd__cfg.html">net_input_mfd_cfg</a> *net_in, <span class="keyword">struct</span> <a class="code hl_struct" href="../../d8/d85/structnet__output__mfd__cfg.html">net_output_mfd_cfg</a> *net_out)</div>
<div class="line">{</div>
<div class="line">    uint32_t batch_num = 0;</div>
<div class="line">    uint32_t i = 0;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    batch_num = (pnet-&gt;batch_num &gt; 1) ? pnet-&gt;batch_num : 1;</div>
<div class="line"> </div>
<div class="line">    for (i = 0; i &lt; net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a88b08f224c035fa5cae2217e6d67afda">in_num</a>; i++) {</div>
<div class="line">        pnet-&gt;in_pair[i].dim = net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a id="a66" name="a66"></a><a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (pnet-&gt;in_pair[i].update_pitch) {</div>
<div class="line">            pnet-&gt;in_pair[i].data_size = net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">loop_cnt</a> *</div>
<div class="line">                net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#afab25cb00475c5e5167bd688c8935f1d">plane</a> * net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#af3562adee51a826821063e1a6e7dcd5b">depth</a> *</div>
<div class="line">                net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a> * pnet-&gt;in_pair[i].update_pitch;</div>
<div class="line">            printf(<span class="stringliteral">&quot;Set input [%s] update size: %lu\n&quot;</span>,</div>
<div class="line">                pnet-&gt;in_pair[i].port_name, pnet-&gt;in_pair[i].data_size);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            pnet-&gt;in_pair[i].data_size = net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">loop_cnt</a> *</div>
<div class="line">                net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a id="a67" name="a67"></a><a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#abe4e3181b6f9f9243f03829322d3e235">size</a>;</div>
<div class="line">        }</div>
<div class="line">        pnet-&gt;in_pair[i].dram_size = pnet-&gt;in_pair[i].data_size * batch_num;</div>
<div class="line">        <span class="keywordflow">if</span> (net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#abe4e3181b6f9f9243f03829322d3e235">size</a> == 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Input [%u] [%s] get invalid size: 0x%lx\n&quot;</span>,</div>
<div class="line">                i, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">name</a>, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#abe4e3181b6f9f9243f03829322d3e235">size</a>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (pnet-&gt;in_pair[i].no_mem) {</div>
<div class="line">            <span class="keywordflow">if</span> (alloc_cv_mem(&amp;pnet-&gt;in_pair[i].dram_size,</div>
<div class="line">                &amp;pnet-&gt;in_pair[i].dram_addr_fd, &amp;pnet-&gt;in_pair[i].virt_addr) &lt; 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;alloc_cv_mem err\n&quot;</span>);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a id="a68" name="a68"></a><a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a526e36643f6467051f6e6ba512bcf963">fd_offset</a> = pnet-&gt;in_pair[i].dram_offset;</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a id="a69" name="a69"></a><a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#afbc217e9e58aab57dacc70a1f54d938f">mem_fd</a> = pnet-&gt;in_pair[i].dram_addr_fd;</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a id="a70" name="a70"></a><a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a532e610b0794e9d695c04dee8b22162f">virt</a> = pnet-&gt;in_pair[i].virt_addr;</div>
<div class="line">            printf(<span class="stringliteral">&quot;Input_ext fd: %u, offset: 0x%lx, dram_size: %lu, size: %lu, virt: %p\n&quot;</span>,</div>
<div class="line">                pnet-&gt;in_pair[i].dram_addr_fd,</div>
<div class="line">                pnet-&gt;in_pair[i].dram_offset, pnet-&gt;in_pair[i].dram_size,</div>
<div class="line">                pnet-&gt;in_pair[i].data_size, pnet-&gt;in_pair[i].virt_addr);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a17afdb10821678afccc3bec8d83e1625">out_num</a>; i++) {</div>
<div class="line">        pnet-&gt;out_pair[i].dim = net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a id="a71" name="a71"></a><a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (pnet-&gt;out_pair[i].update_pitch) {</div>
<div class="line">            pnet-&gt;out_pair[i].data_size = net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">loop_cnt</a> *</div>
<div class="line">                net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#afab25cb00475c5e5167bd688c8935f1d">plane</a> * net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#af3562adee51a826821063e1a6e7dcd5b">depth</a> *</div>
<div class="line">                net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a> * pnet-&gt;out_pair[i].update_pitch;</div>
<div class="line">            printf(<span class="stringliteral">&quot;Set output [%s] update size: %lu\n&quot;</span>,</div>
<div class="line">                pnet-&gt;out_pair[i].port_name, pnet-&gt;out_pair[i].data_size);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            pnet-&gt;out_pair[i].data_size = net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">loop_cnt</a> *</div>
<div class="line">                net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a id="a72" name="a72"></a><a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#abe4e3181b6f9f9243f03829322d3e235">size</a>;</div>
<div class="line">        }</div>
<div class="line">        pnet-&gt;out_pair[i].dram_size = pnet-&gt;out_pair[i].data_size * batch_num;</div>
<div class="line">        <span class="keywordflow">if</span> (net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#abe4e3181b6f9f9243f03829322d3e235">size</a> == 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Output [%u] [%s] get invalid size: 0x%lx\n&quot;</span>,</div>
<div class="line">                i, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">name</a>, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#abe4e3181b6f9f9243f03829322d3e235">size</a>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (pnet-&gt;out_pair[i].no_mem) {</div>
<div class="line">            <span class="keywordflow">if</span> (alloc_cv_mem(&amp;pnet-&gt;out_pair[i].dram_size,</div>
<div class="line">                &amp;pnet-&gt;out_pair[i].dram_addr_fd, &amp;pnet-&gt;out_pair[i].virt_addr) &lt; 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;alloc_cv_mem err\n&quot;</span>);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a id="a73" name="a73"></a><a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a526e36643f6467051f6e6ba512bcf963">fd_offset</a> = pnet-&gt;out_pair[i].dram_offset;</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a id="a74" name="a74"></a><a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#afbc217e9e58aab57dacc70a1f54d938f">mem_fd</a> = pnet-&gt;out_pair[i].dram_addr_fd;</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a id="a75" name="a75"></a><a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a532e610b0794e9d695c04dee8b22162f">virt</a> = pnet-&gt;out_pair[i].virt_addr;</div>
<div class="line">            printf(<span class="stringliteral">&quot;Output_ext fd: %u, offset: 0x%lx, dram_size: %lu, size: %lu, virt: %p\n&quot;</span>,</div>
<div class="line">                pnet-&gt;out_pair[i].dram_addr_fd,</div>
<div class="line">                pnet-&gt;out_pair[i].dram_offset, pnet-&gt;out_pair[i].dram_size,</div>
<div class="line">                pnet-&gt;out_pair[i].data_size, pnet-&gt;out_pair[i].virt_addr);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> get_net_io_cfg(<span class="keyword">struct</span> net_match *pnet, <span class="keyword">struct</span> <a class="code hl_struct" href="../../d3/d35/structnet__input__mfd__cfg.html">net_input_mfd_cfg</a> *net_in,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code hl_struct" href="../../d8/d85/structnet__output__mfd__cfg.html">net_output_mfd_cfg</a> *net_out)</div>
<div class="line">{</div>
<div class="line">    uint32_t i = 0;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a88b08f224c035fa5cae2217e6d67afda">in_num</a>; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (pnet-&gt;in_pair[i].no_mem == 0) {</div>
<div class="line">            <span class="comment">/* Both are ok for get virt_addr by libnnctrl or calculate by app.</span></div>
<div class="line"><span class="comment">             * pnet-&gt;in_pair[i].virt_addr = pnet-&gt;net_m.virt_addr +</span></div>
<div class="line"><span class="comment">             *  pnet-&gt;in_pair[i].dram_addr - pnet-&gt;net_m.phy_addr; */</span></div>
<div class="line">            pnet-&gt;in_pair[i].virt_addr = net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a532e610b0794e9d695c04dee8b22162f">virt</a>;</div>
<div class="line">            pnet-&gt;in_pair[i].dram_offset = net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a526e36643f6467051f6e6ba512bcf963">fd_offset</a>;</div>
<div class="line">            pnet-&gt;in_pair[i].dram_addr_fd = net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#afbc217e9e58aab57dacc70a1f54d938f">mem_fd</a>;</div>
<div class="line">            <span class="keywordflow">if</span> ((net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#afbc217e9e58aab57dacc70a1f54d938f">mem_fd</a> &lt; 0) || (net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#abe4e3181b6f9f9243f03829322d3e235">size</a> == 0)) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Input [%u] [%s] get invalid addr fd: %d, size: 0x%lx\n&quot;</span>,</div>
<div class="line">                    i, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">name</a>,</div>
<div class="line">                    net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#afbc217e9e58aab57dacc70a1f54d938f">mem_fd</a>, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#abe4e3181b6f9f9243f03829322d3e235">size</a>);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        pnet-&gt;in_pair[i].dim = net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>;</div>
<div class="line">        pnet-&gt;in_pair[i].data_fmt = net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a id="a76" name="a76"></a><a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>;</div>
<div class="line"> </div>
<div class="line">        printf(<span class="stringliteral">&quot;Input: %u [%s] dim: (%lu, %lu, %lu, %lu), pitch: %lu, &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;dram_fmt: %u, bitvector: %d, data_fmt: (%d, %d, %d, %d), &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;loop_cnt: %u, size: %lu, fd: %d, offset: 0x%lx, virt: %p\n&quot;</span>,</div>
<div class="line">            i, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">name</a>,</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#afab25cb00475c5e5167bd688c8935f1d">plane</a>, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#af3562adee51a826821063e1a6e7dcd5b">depth</a>,</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a>, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>,</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a6151b90948f9409a6ad67219369dd801">pitch</a>,</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a5574b64abdcb1e8455471e18f6947d04">dram_fmt</a>, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#aac4ab403272f5be55e966d2735ceb313">bitvector</a>,</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>.<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#a0e0ace816facf5d8b503eb83e8e798b8">sign</a>, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>.<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ae5dc6ffcd9b7605c7787791e40cc6bb0">size</a>,</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>.<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#a375c68753379e89f4548d93e5e41d41d">expoffset</a>, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>.<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ad9cd444e0d5bf7539865ca6dc194d92e">expbits</a>,</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">loop_cnt</a>, pnet-&gt;in_pair[i].data_size,</div>
<div class="line">            pnet-&gt;in_pair[i].dram_addr_fd, pnet-&gt;in_pair[i].dram_offset,</div>
<div class="line">            pnet-&gt;in_pair[i].virt_addr);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a17afdb10821678afccc3bec8d83e1625">out_num</a>; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (pnet-&gt;out_pair[i].no_mem == 0) {</div>
<div class="line">            <span class="comment">/* Both are ok for get virt_addr by libnnctrl or calculate by app.</span></div>
<div class="line"><span class="comment">             * pnet-&gt;out_pair[i].virt_addr = pnet-&gt;net_m.virt_addr +</span></div>
<div class="line"><span class="comment">             *  pnet-&gt;out_pair[i].dram_addr - pnet-&gt;net_m.phy_addr; */</span></div>
<div class="line">            pnet-&gt;out_pair[i].virt_addr = net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a532e610b0794e9d695c04dee8b22162f">virt</a>;</div>
<div class="line">            pnet-&gt;out_pair[i].dram_offset = net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a526e36643f6467051f6e6ba512bcf963">fd_offset</a>;</div>
<div class="line">            pnet-&gt;out_pair[i].dram_addr_fd = net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#afbc217e9e58aab57dacc70a1f54d938f">mem_fd</a>;</div>
<div class="line">            <span class="keywordflow">if</span> ((net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#afbc217e9e58aab57dacc70a1f54d938f">mem_fd</a> &lt; 0) || (net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#abe4e3181b6f9f9243f03829322d3e235">size</a> == 0)) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Output [%u] [%s] get invalid addr fd: %u, size: 0x%lx\n&quot;</span>,</div>
<div class="line">                    i, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">name</a>,</div>
<div class="line">                    net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#afbc217e9e58aab57dacc70a1f54d938f">mem_fd</a>, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#abe4e3181b6f9f9243f03829322d3e235">size</a>);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        pnet-&gt;out_pair[i].dim = net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>;</div>
<div class="line">        pnet-&gt;out_pair[i].data_fmt = net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a id="a77" name="a77"></a><a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>;</div>
<div class="line"> </div>
<div class="line">        printf(<span class="stringliteral">&quot;Output: %u [%s] dim: (%lu, %lu, %lu, %lu), pitch: %lu, &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;dram_fmt: %u, bitvector: %d, data_fmt: (%d, %d, %d, %d), &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;loop_cnt: %u, size: %lu, fd: %d, offset: 0x%lx, virt: %p\n&quot;</span>,</div>
<div class="line">            i, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">name</a>,</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#afab25cb00475c5e5167bd688c8935f1d">plane</a>, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#af3562adee51a826821063e1a6e7dcd5b">depth</a>,</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a>, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>,</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a6151b90948f9409a6ad67219369dd801">pitch</a>,</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a5574b64abdcb1e8455471e18f6947d04">dram_fmt</a>, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#aac4ab403272f5be55e966d2735ceb313">bitvector</a>,</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>.<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#a0e0ace816facf5d8b503eb83e8e798b8">sign</a>, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>.<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ae5dc6ffcd9b7605c7787791e40cc6bb0">size</a>,</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>.<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#a375c68753379e89f4548d93e5e41d41d">expoffset</a>, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>.<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ad9cd444e0d5bf7539865ca6dc194d92e">expbits</a>,</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">loop_cnt</a>, pnet-&gt;out_pair[i].data_size,</div>
<div class="line">            pnet-&gt;out_pair[i].dram_addr_fd, pnet-&gt;out_pair[i].dram_offset,</div>
<div class="line">            pnet-&gt;out_pair[i].virt_addr);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> update_net_io_pitch_by_rotate(<span class="keyword">struct</span> <a class="code hl_struct" href="../../d3/d35/structnet__input__mfd__cfg.html">net_input_mfd_cfg</a> *net_in)</div>
<div class="line">{</div>
<div class="line">    uint32_t i = 0, size = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a88b08f224c035fa5cae2217e6d67afda">in_num</a>; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a> == net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>) {</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a5574b64abdcb1e8455471e18f6947d04">dram_fmt</a>) {</div>
<div class="line">            <span class="keywordflow">if</span> (net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a8df7d51bc3df84df92cf0b247af8d909">rotate_flip_bitmap</a> &amp; (0x1 &lt;&lt; <a id="a78" name="a78"></a><a class="code hl_enumvalue" href="../../d9/d50/group__nnctrl-helper.html#ggaeecd646cca3b6bbcc2f1e15a76ae5c2ea5192414668c4552c65c181ba528d9bf8">DROTATE_BIT</a>)) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Warning: DO NOT support rotate if dram_format isn&#39;t zero\n&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (!(net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a8df7d51bc3df84df92cf0b247af8d909">rotate_flip_bitmap</a> &amp; (0x1 &lt;&lt; <a class="code hl_enumvalue" href="../../d9/d50/group__nnctrl-helper.html#ggaeecd646cca3b6bbcc2f1e15a76ae5c2ea5192414668c4552c65c181ba528d9bf8">DROTATE_BIT</a>))) {</div>
<div class="line">            <span class="keywordflow">continue</span>; <span class="comment">/* auto update pitch when set rotate only */</span></div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Only poke pitch when height/width is different */</span></div>
<div class="line">        <span class="comment">/* FIXME: It&#39;s OK that pitch is 32 byte align in file mode,</span></div>
<div class="line"><span class="comment">         * should be differnt in live mode */</span></div>
<div class="line">        <span class="keywordflow">if</span> (net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a8df7d51bc3df84df92cf0b247af8d909">rotate_flip_bitmap</a> &amp; (0x1 &lt;&lt; <a class="code hl_enumvalue" href="../../d9/d50/group__nnctrl-helper.html#ggaeecd646cca3b6bbcc2f1e15a76ae5c2ea5192414668c4552c65c181ba528d9bf8">DROTATE_BIT</a>)) {</div>
<div class="line">            size = net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a>;</div>
<div class="line">        }</div>
<div class="line">        size = size * (1 &lt;&lt; net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>.<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ae5dc6ffcd9b7605c7787791e40cc6bb0">size</a>);</div>
<div class="line">        size = <a id="a79" name="a79"></a><a class="code hl_define" href="../../d3/d5a/group__iav-common-helper.html#gad1b352de3b0722699205a3021bdbb615">ROUND_UP</a>(size, CAVALRY_PORT_PITCH_ALIGN);</div>
<div class="line">        <span class="keywordflow">if</span> ((size != net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a6151b90948f9409a6ad67219369dd801">pitch</a>) &amp;&amp; (net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#abdb7d98eb79205cdc90022a4c4b75d16">update_pitch</a> == 0)) {</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#abdb7d98eb79205cdc90022a4c4b75d16">update_pitch</a> = size;</div>
<div class="line">            printf(<span class="stringliteral">&quot;Port [%s], H, W: (%lu, %lu), update_pitch: %lu for rotate\n&quot;</span>,</div>
<div class="line">                net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">name</a>, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a>,</div>
<div class="line">                net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#abdb7d98eb79205cdc90022a4c4b75d16">update_pitch</a>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> update_net_io_pitch_with_default_value(</div>
<div class="line">    <span class="keyword">struct</span> <a class="code hl_struct" href="../../d3/d35/structnet__input__mfd__cfg.html">net_input_mfd_cfg</a> *net_in, <span class="keyword">struct</span> <a class="code hl_struct" href="../../d8/d85/structnet__output__mfd__cfg.html">net_output_mfd_cfg</a> *net_out)</div>
<div class="line">{</div>
<div class="line">    uint32_t i = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a88b08f224c035fa5cae2217e6d67afda">in_num</a>; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#abdb7d98eb79205cdc90022a4c4b75d16">update_pitch</a>) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Net input [%s] already has update_pitch: %lu\n&quot;</span>,</div>
<div class="line">                net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">name</a>, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#abdb7d98eb79205cdc90022a4c4b75d16">update_pitch</a>);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#abdb7d98eb79205cdc90022a4c4b75d16">update_pitch</a> = net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a6151b90948f9409a6ad67219369dd801">pitch</a>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a17afdb10821678afccc3bec8d83e1625">out_num</a>; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#abdb7d98eb79205cdc90022a4c4b75d16">update_pitch</a>) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Net output [%s] already has update_pitch: %lu\n&quot;</span>,</div>
<div class="line">                net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">name</a>, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#abdb7d98eb79205cdc90022a4c4b75d16">update_pitch</a>);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#abdb7d98eb79205cdc90022a4c4b75d16">update_pitch</a> = net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a6151b90948f9409a6ad67219369dd801">pitch</a>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> feed_dummy_data_to_input(<span class="keyword">struct</span> <a class="code hl_struct" href="../../d3/d35/structnet__input__mfd__cfg.html">net_input_mfd_cfg</a> *net_in)</div>
<div class="line">{</div>
<div class="line">    uint32_t loop_num = 0;</div>
<div class="line">    uint32_t i = 0, j = 0;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> remainder = 0;</div>
<div class="line">    uint8_t dummy_data[DUMMY_DATA_LENGTH];</div>
<div class="line">    uint8_t *buf = NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; DUMMY_DATA_LENGTH; i++) {</div>
<div class="line">        dummy_data[i] = i;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span>(i = 0; i &lt; net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a88b08f224c035fa5cae2217e6d67afda">in_num</a>; i++) {</div>
<div class="line">        loop_num = net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#abe4e3181b6f9f9243f03829322d3e235">size</a> / DUMMY_DATA_LENGTH;</div>
<div class="line">        remainder = net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#abe4e3181b6f9f9243f03829322d3e235">size</a> % DUMMY_DATA_LENGTH;</div>
<div class="line">        buf = net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a532e610b0794e9d695c04dee8b22162f">virt</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (j = 0; j &lt; loop_num; j++) {</div>
<div class="line">            memcpy(buf, &amp;dummy_data[0], DUMMY_DATA_LENGTH);</div>
<div class="line">            buf += DUMMY_DATA_LENGTH;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (remainder) {</div>
<div class="line">            memcpy(buf, &amp;dummy_data[0], remainder);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> init_one_net(<span class="keyword">struct</span> net_match *pnet)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a id="_a80" name="_a80"></a><a class="code hl_struct" href="../../da/df5/structnet__cfg.html">net_cfg</a> net_cf;</div>
<div class="line">    <span class="keyword">struct </span><a class="code hl_struct" href="../../d3/d35/structnet__input__mfd__cfg.html">net_input_mfd_cfg</a> net_in;</div>
<div class="line">    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d85/structnet__output__mfd__cfg.html">net_output_mfd_cfg</a> net_out;</div>
<div class="line">    <span class="keyword">struct </span><a id="_a81" name="_a81"></a><a class="code hl_struct" href="../../d2/ded/structnet__dvi__cfg.html">net_dvi_cfg</a> net_dvi;</div>
<div class="line">    <span class="keywordtype">void</span> *p = NULL;</div>
<div class="line">    <span class="keywordtype">int</span> net_id = 0;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (pnet == NULL) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;start net with NULL pointer\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    memset((<span class="keywordtype">void</span> *)&amp;net_cf, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="../../da/df5/structnet__cfg.html">net_cfg</a>));</div>
<div class="line">    memset((<span class="keywordtype">void</span> *)&amp;net_in, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="../../d3/d35/structnet__input__mfd__cfg.html">net_input_mfd_cfg</a>));</div>
<div class="line">    memset((<span class="keywordtype">void</span> *)&amp;net_out, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="../../d8/d85/structnet__output__mfd__cfg.html">net_output_mfd_cfg</a>));</div>
<div class="line"> </div>
<div class="line">    net_cf.verbose = pnet-&gt;verbose;</div>
<div class="line">    net_cf.reuse_mem = pnet-&gt;reuse_mem;</div>
<div class="line">    net_cf.print_time = pnet-&gt;print_time;</div>
<div class="line">    net_cf.no_chip_check = pnet-&gt;no_chip_check;</div>
<div class="line">    net_cf.net_loop_cnt = pnet-&gt;batch_num;</div>
<div class="line">    net_cf.enable_extra_high_mem = pnet-&gt;enable_extra_high_mem;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        <span class="keywordflow">if</span> (pnet-&gt;is_encrypted_net) {</div>
<div class="line">            <span class="comment">/* certificate */</span></div>
<div class="line">            <span class="keywordflow">if</span> (!pnet-&gt;encrypt_certificate_filename) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Please provide encrypt certificate file\n&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            rval = load_file_simple(pnet-&gt;encrypt_certificate_filename,</div>
<div class="line">                &amp;pnet-&gt;encrypt_certificate, <span class="keyword">sizeof</span>(pnet-&gt;encrypt_certificate));</div>
<div class="line">            <span class="keywordflow">if</span> (rval) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Load encrypt certificate file: %s err\n&quot;</span>, pnet-&gt;encrypt_certificate_filename);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            net_cf.certificate_virt = &amp;pnet-&gt;encrypt_certificate;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* re-key */</span></div>
<div class="line">            <span class="keywordflow">if</span> (!pnet-&gt;encrypt_key_filename) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Please provide encrypt key file\n&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            rval = load_file_simple(pnet-&gt;encrypt_key_filename,</div>
<div class="line">                &amp;pnet-&gt;encrypt_key, <span class="keyword">sizeof</span>(pnet-&gt;encrypt_key));</div>
<div class="line">            <span class="keywordflow">if</span> (rval) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Load encrypt key file: %s err\n&quot;</span>, pnet-&gt;encrypt_key_filename);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            net_cf.dek_encrypt_key_virt = &amp;pnet-&gt;encrypt_key;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* digest */</span></div>
<div class="line">            <span class="keywordflow">if</span> (!pnet-&gt;encrypt_digest_filename) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Please provide encrypt digest file\n&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            rval = load_file_simple(pnet-&gt;encrypt_digest_filename,</div>
<div class="line">                pnet-&gt;encrypt_digest, <span class="keyword">sizeof</span>(pnet-&gt;encrypt_digest));</div>
<div class="line">            <span class="keywordflow">if</span> (rval) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Load encrypt digest file: %s err\n&quot;</span>, pnet-&gt;encrypt_digest_filename);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            net_cf.digest_virt = pnet-&gt;encrypt_digest;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (pnet-&gt;net_feed_mem) {</div>
<div class="line">            p = alloc_mem_for_file(pnet-&gt;net_name, NULL);</div>
<div class="line">            <span class="keywordflow">if</span> (!p) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;alloc mem for file: %s err\n&quot;</span>, pnet-&gt;net_name);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            net_cf.net_feed_virt = p;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            net_cf.net_file = pnet-&gt;net_name;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (set_net_io_no_mem(pnet, &amp;net_in, &amp;net_out) &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;set_net_io_no_mem err\n&quot;</span>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (pnet-&gt;feed_dummy_data) {</div>
<div class="line">            net_id = <a id="a82" name="a82"></a><a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#gaae87e820289102f4fb296bed8f1405df">nnctrl_init_net_by_mfd</a>(&amp;net_cf, NULL, NULL);</div>
<div class="line">            <a id="a83" name="a83"></a><a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#ga86261721b933cd5c7cf2947cd1df3e36">nnctrl_get_net_io_cfg_by_mfd</a>(net_id, &amp;net_in, &amp;net_out);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            net_id = <a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#gaae87e820289102f4fb296bed8f1405df">nnctrl_init_net_by_mfd</a>(&amp;net_cf, &amp;net_in, &amp;net_out);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (net_id &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;nnctrl_init_net err\n&quot;</span>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">if</span> (net_cf.net_mem_total == 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;nnctrl_init_net get total size is zero\n&quot;</span>);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                pnet-&gt;net_id = net_id;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        pnet-&gt;net_m.mem_size = net_cf.net_mem_total;</div>
<div class="line">        <span class="keywordflow">if</span> (alloc_cv_mem(&amp;pnet-&gt;net_m.mem_size, &amp;pnet-&gt;net_m.fd,</div>
<div class="line">            &amp;pnet-&gt;net_m.virt_addr) &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;alloc cv mem err\n&quot;</span>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">if</span> (pnet-&gt;net_m.virt_addr == NULL) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;alloc cv mem is NULL\n&quot;</span>);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (get_net_io_size_no_mem(pnet, &amp;net_in, &amp;net_out) &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;get net io size err\n&quot;</span>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (pnet-&gt;enable_extra_high_mem) {</div>
<div class="line">            pnet-&gt;net_m.extra_high_mem_phys = g_extra_high_mem_phys;</div>
<div class="line">            g_extra_high_mem_phys += net_cf.extra_high_mem_total;</div>
<div class="line">            printf(<span class="stringliteral">&quot;\n--------------------------\n&quot;</span>);</div>
<div class="line">            printf(<span class="stringliteral">&quot;[Extra High Mem Phys] Net_id: %u, Current phys at: 0x%x, Next phys at: 0x%x\n&quot;</span>,</div>
<div class="line">                net_id, pnet-&gt;net_m.extra_high_mem_phys, g_extra_high_mem_phys);</div>
<div class="line">            printf(<span class="stringliteral">&quot;--------------------------\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        update_net_io_pitch_by_rotate(&amp;net_in);</div>
<div class="line">        <span class="keywordflow">if</span> (pnet-&gt;export_all_pitch) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Update io pitch with default value\n&quot;</span>);</div>
<div class="line">            update_net_io_pitch_with_default_value(&amp;net_in, &amp;net_out);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a id="a84" name="a84"></a><a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#ga934ebe255a4d041af5d398784ce7046c">nnctrl_load_net_by_mfd</a>(net_id, &amp;pnet-&gt;net_m, &amp;net_in, &amp;net_out) &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;nnctrl load net err\n&quot;</span>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        sync_cache_mem(pnet-&gt;net_m.mem_size, 0, pnet-&gt;net_m.fd, 1, 0);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (pnet-&gt;feed_dummy_data) {</div>
<div class="line">            feed_dummy_data_to_input(&amp;net_in);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (get_net_io_cfg(pnet, &amp;net_in, &amp;net_out) &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;get net io cfg err\n&quot;</span>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (load_input_io(pnet) &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;load input err\n&quot;</span>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (pnet-&gt;query_dvi) {</div>
<div class="line">            <span class="keywordflow">if</span> (<a id="a85" name="a85"></a><a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#gaa808de738ac3a2c43d5c3cf74254c56c">nnctrl_query_dvi</a>(pnet-&gt;net_id, pnet-&gt;query_dvi_id, &amp;net_dvi) &lt; 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;query dvi err\n&quot;</span>);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Net: %u, dvi_id: %u, phys: 0x%lx, virt: %p, size: %lu\n&quot;</span>,</div>
<div class="line">                    pnet-&gt;net_id, pnet-&gt;query_dvi_id,</div>
<div class="line">                    (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)net_dvi.addr, net_dvi.virt, net_dvi.size);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">while</span> (0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (rval == 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Network [%d] [%s] total memory size: %lu, dvi: %lu, blob: %lu. &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;Bandwidth size: %lu. Extra_high_mem size: %lu\n&quot;</span>,</div>
<div class="line">            pnet-&gt;net_id, pnet-&gt;net_name, net_cf.net_mem_total,</div>
<div class="line">            net_cf.dvi_mem_total, net_cf.blob_mem_total,</div>
<div class="line">            net_cf.bandwidth_total, net_cf.extra_high_mem_total);</div>
<div class="line">        pnet-&gt;net_bw_sz = net_cf.bandwidth_total;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (net_cf.net_feed_virt) {</div>
<div class="line">        p = (<span class="keywordtype">void</span> *)net_cf.net_feed_virt;</div>
<div class="line">        free(p);</div>
<div class="line">        net_cf.net_feed_virt = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> *run_one_net(<span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>net_match *pnet = (<span class="keyword">struct </span>net_match *)arg;</div>
<div class="line">    <span class="keyword">struct </span><a id="_a86" name="_a86"></a><a class="code hl_struct" href="../../df/da8/structnet__hw__affinity.html">net_hw_affinity</a> affinity;</div>
<div class="line">    <span class="keyword">struct </span><a id="_a87" name="_a87"></a><a class="code hl_struct" href="../../d8/df3/structnet__result.html">net_result</a> net_ret;</div>
<div class="line">    <span class="keyword">struct </span>timeval tv1, tv2;</div>
<div class="line">    <span class="keywordtype">char</span> dump_net_crc_bad[FILENAME_LENGTH + 16];</div>
<div class="line">    <span class="keywordtype">void</span> *ret = NULL;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> tv_diff = 0, total_tv_diff = 0;</div>
<div class="line">    <span class="keywordtype">double</span> total_vp_us = 0, one_vp_us = 0;</div>
<div class="line">    <span class="keywordtype">double</span> total_real_us = 0, one_real_us = 0;</div>
<div class="line">    uint32_t cnt = 0, max_cnt = 0;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0, result = 0;</div>
<div class="line"><span class="preprocessor">    #if defined(DMABUF_SYNC)</span></div>
<div class="line">    <span class="keyword">struct </span>dma_buf_sync sync = {0};</div>
<div class="line"><span class="preprocessor">    #endif</span></div>
<div class="line"> </div>
<div class="line">    max_cnt = pnet-&gt;iter_num;</div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        <span class="keywordflow">if</span> (pnet-&gt;set_hw_affinity) {</div>
<div class="line">            memset(&amp;affinity, 0, <span class="keyword">sizeof</span>(affinity));</div>
<div class="line">            affinity.nvp_affinity = pnet-&gt;nvp_affinity;</div>
<div class="line">            affinity.gvp_affinity = pnet-&gt;gvp_affinity;</div>
<div class="line">            printf(<span class="stringliteral">&quot;Set net_id: %u hw affinity, NVP: 0x%x, GVP: 0x%x\n&quot;</span>,</div>
<div class="line">                pnet-&gt;net_id, affinity.nvp_affinity, affinity.gvp_affinity);</div>
<div class="line">            rval = <a id="a88" name="a88"></a><a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#ga989220e6dceaee74278f20caa2c51873">nnctrl_set_hw_affinity</a>(pnet-&gt;net_id, &amp;affinity);</div>
<div class="line">            <span class="keywordflow">if</span> (rval) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;nnctrl_set_hw_affinity err\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">for</span> (cnt = 0; G_nnctrl.all_run_loop &amp;&amp; cnt &lt; max_cnt; cnt++) {</div>
<div class="line">            clean_output_mem(pnet);</div>
<div class="line">            one_vp_us = 0;</div>
<div class="line">            <span class="keywordflow">if</span> (pnet-&gt;spilt_num &gt; 1) {</div>
<div class="line">                pnet-&gt;net_run.split_num_run = pnet-&gt;spilt_num;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (pnet-&gt;batch_num &gt; 1) {</div>
<div class="line">                pnet-&gt;net_run.net_loop_cnt = pnet-&gt;batch_num;</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">/* Always use the same input/output addr */</span></div>
<div class="line">            gettimeofday(&amp;tv1, NULL);</div>
<div class="line">            result = <a id="a89" name="a89"></a><a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#ga2a3ae257681f835bf13fbe7c43266c86">nnctrl_run_net_by_mfd</a>(pnet-&gt;net_id, &amp;net_ret, &amp;pnet-&gt;net_run, NULL, NULL);</div>
<div class="line">            one_vp_us += net_ret.vp_time_us;</div>
<div class="line">            one_real_us += net_ret.real_time_us;</div>
<div class="line"><span class="preprocessor">            #if 0</span></div>
<div class="line">            <span class="keywordflow">if</span> (result &lt; 0) {</div>
<div class="line">                <span class="keywordflow">if</span> (result == -EAGAIN) {</div>
<div class="line">                    <span class="keywordflow">do</span> {</div>
<div class="line">                        result = <a id="a90" name="a90"></a><a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#ga12db598f56dd9956a8bd54ea4533c95c">nnctrl_resume_net</a>(pnet-&gt;net_id, &amp;net_ret);</div>
<div class="line">                        one_vp_us += net_ret.vp_time_us;</div>
<div class="line">                        <span class="keywordflow">if</span> (result == -EINTR) {</div>
<div class="line">                            printf(<span class="stringliteral">&quot;interrupt by signal in resume\n&quot;</span>);</div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                        }</div>
<div class="line">                    } <span class="keywordflow">while</span> (result == -EAGAIN);</div>
<div class="line">                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (result == -EINTR) {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;interrupt by signal in run\n&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                } <span class="keywordflow">else</span> {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;nnctrl_run_net failed at iteration [%d], ret: %d\n&quot;</span>, cnt, result);</div>
<div class="line">                    rval = -1;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"><span class="preprocessor">            #else</span></div>
<div class="line">            <span class="keywordflow">if</span> (result) {</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"><span class="preprocessor">            #endif</span></div>
<div class="line">            gettimeofday(&amp;tv2, NULL);</div>
<div class="line">            tv_diff = (<span class="keywordtype">unsigned</span> long) 1000000 * (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) (tv2.tv_sec - tv1.tv_sec) +</div>
<div class="line">                (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) (tv2.tv_usec - tv1.tv_usec);</div>
<div class="line">            total_tv_diff += tv_diff;</div>
<div class="line">            total_vp_us += one_vp_us;</div>
<div class="line">            total_real_us += one_real_us;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">            #if defined(DMABUF_SYNC)</span></div>
<div class="line">            sync.flags = DMA_BUF_SYNC_RW | DMA_BUF_SYNC_START;</div>
<div class="line">            ioctl(pnet-&gt;net_m.mem_fd, DMA_BUF_IOCTL_SYNC, &amp;sync);</div>
<div class="line"><span class="preprocessor">            #else</span></div>
<div class="line">            invalid_output_mem(pnet);</div>
<div class="line"><span class="preprocessor">            #endif</span></div>
<div class="line">            clean_output_padding(pnet);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (process_output_mem(pnet) &lt; 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;process output mem err at iteration [%d]\n&quot;</span>, cnt);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">if</span> (!pnet-&gt;dump_net_en) {</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">            #if defined(DMABUF_SYNC)</span></div>
<div class="line">            sync.flags = DMA_BUF_SYNC_RW | DMA_BUF_SYNC_END;</div>
<div class="line">            ioctl(pnet-&gt;net_m.mem_fd, DMA_BUF_IOCTL_SYNC, &amp;sync);</div>
<div class="line"><span class="preprocessor">            #endif</span></div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (pnet-&gt;dump_net_en) {</div>
<div class="line">                <span class="keywordflow">if</span> (!pnet-&gt;dump_net_done) {</div>
<div class="line"><span class="preprocessor">                    #ifndef DMABUF_SYNC</span></div>
<div class="line">                    sync_cache_mem(pnet-&gt;net_m.mem_size, 0, pnet-&gt;net_m.fd, 0, 1);</div>
<div class="line"><span class="preprocessor">                    #endif</span></div>
<div class="line">                    <span class="keywordflow">if</span> (<a id="a91" name="a91"></a><a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#ga964c3b506357a71707479d55a0af66f6">nnctrl_dump_net</a>(pnet-&gt;net_id, pnet-&gt;path_dump) &lt; 0) {</div>
<div class="line">                        printf(<span class="stringliteral">&quot;dump blob and dvi err\n&quot;</span>);</div>
<div class="line">                        rval = -1;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                    pnet-&gt;dump_net_done = 1;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (rval &lt; 0) { <span class="comment">/* process_output_mem return err, maybe caused by crc check failed */</span></div>
<div class="line"><span class="preprocessor">                    #ifndef DMABUF_SYNC</span></div>
<div class="line">                    sync_cache_mem(pnet-&gt;net_m.mem_size, 0, pnet-&gt;net_m.fd, 0, 1);</div>
<div class="line"><span class="preprocessor">                    #endif</span></div>
<div class="line">                    snprintf(dump_net_crc_bad, <span class="keyword">sizeof</span>(dump_net_crc_bad), <span class="stringliteral">&quot;%s_%s&quot;</span>,</div>
<div class="line">                        pnet-&gt;path_dump, <span class="stringliteral">&quot;crc_bad&quot;</span>);</div>
<div class="line">                    printf(<span class="stringliteral">&quot;Dump net path for crc check failed: %s\n&quot;</span>, dump_net_crc_bad);</div>
<div class="line">                    <span class="keywordflow">if</span> (mkdir(dump_net_crc_bad, 0755) &lt; 0) {</div>
<div class="line">                        perror(dump_net_crc_bad);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#ga964c3b506357a71707479d55a0af66f6">nnctrl_dump_net</a>(pnet-&gt;net_id, dump_net_crc_bad) &lt; 0) {</div>
<div class="line">                        printf(<span class="stringliteral">&quot;dump blob and dvi err\n&quot;</span>);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (rval &lt; 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;nnctrl_run_net err at iteration: %u\n&quot;</span>, cnt);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">while</span> (0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (max_cnt &gt; 1) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Network [%d] [%s] iteration: %u / %u.&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot; AVG: vp time: %0.2f us, arm time: %lu us\n&quot;</span>,</div>
<div class="line">            pnet-&gt;net_id, pnet-&gt;net_name, cnt, max_cnt,</div>
<div class="line">            total_vp_us / cnt, total_tv_diff / cnt);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (rval &lt; 0) {</div>
<div class="line">        ret = NULL;</div>
<div class="line">        G_nnctrl.all_run_loop = 0;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        pnet-&gt;net_bw_us = total_vp_us / cnt;</div>
<div class="line">        ret = arg;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> run_all_nets_serial(<span class="keyword">struct</span> nnctrl_param *pctrl)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">void</span> *ret = NULL;</div>
<div class="line">    uint32_t net_num = 0, idx = 0;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    net_num = pctrl-&gt;net_num;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (idx = 0; idx &lt; net_num; idx++) {</div>
<div class="line">        ret = run_one_net(&amp;pctrl-&gt;net_pair[idx]);</div>
<div class="line">        <span class="keywordflow">if</span> (ret == NULL) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;serial run one net idx: %d err\n&quot;</span>, idx);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> run_all_nets_parallel(<span class="keyword">struct</span> nnctrl_param *pctrl)</div>
<div class="line">{</div>
<div class="line">    pthread_t tid[pctrl-&gt;net_num];</div>
<div class="line">    uint32_t net_num = 0, done_num = 0, idx= 0;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0, ret = 0;</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Run mode: Parallel\n&quot;</span>);</div>
<div class="line">    net_num = pctrl-&gt;net_num;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (idx = 0; idx &lt; net_num; idx++) {</div>
<div class="line">        ret = pthread_create(&amp;tid[idx], NULL, run_one_net, &amp;pctrl-&gt;net_pair[idx]);</div>
<div class="line">        <span class="keywordflow">if</span> (ret) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;parallel run one net idx [%u] err\n&quot;</span>, idx);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            done_num++;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (done_num &gt; 0) {</div>
<div class="line">        <span class="keywordflow">for</span> (idx = 0; idx &lt; done_num; idx++) {</div>
<div class="line">            pthread_join(tid[idx], NULL);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> run_all_nets_random(<span class="keyword">struct</span> nnctrl_param *pctrl)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">void</span> *ret = NULL;</div>
<div class="line">    uint32_t net_num = 0;</div>
<div class="line">    uint32_t cnt = 0, idx = 0;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Run mode: Random\n&quot;</span>);</div>
<div class="line">    net_num = pctrl-&gt;net_num;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (pctrl-&gt;all_run_loop &amp;&amp; (cnt &lt; pctrl-&gt;all_inter_num)) {</div>
<div class="line">        srand((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)time(NULL));</div>
<div class="line">        idx = rand() % net_num;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* random pick one net and run once */</span></div>
<div class="line">        pctrl-&gt;net_pair[idx].iter_num = 1;</div>
<div class="line">        ret = run_one_net(&amp;pctrl-&gt;net_pair[idx]);</div>
<div class="line">        <span class="keywordflow">if</span> (ret == NULL) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;random run one net idx: %d at count: %u err\n&quot;</span>, idx, cnt);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        cnt++;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> start_all_nets(<span class="keyword">struct</span> nnctrl_param *pctrl)</div>
<div class="line">{</div>
<div class="line">    uint32_t done_num = 0;</div>
<div class="line">    uint32_t net_num = 0;</div>
<div class="line">    uint32_t idx = 0;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0, i = 0;</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Total neural network num: %d\n&quot;</span>, pctrl-&gt;net_num);</div>
<div class="line">    <span class="keywordflow">if</span> (pctrl-&gt;all_net_feed_mem) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Feed Net from memory\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    net_num = pctrl-&gt;net_num;</div>
<div class="line">    <span class="keywordflow">for</span> (idx = 0; idx &lt; net_num; idx++) {</div>
<div class="line">        pctrl-&gt;net_pair[idx].net_feed_mem = pctrl-&gt;all_net_feed_mem;</div>
<div class="line">        pctrl-&gt;net_pair[idx].enable_extra_high_mem = pctrl-&gt;all_en_extra_high_mem;</div>
<div class="line">        pctrl-&gt;net_pair[idx].print_time = pctrl-&gt;all_print_time;</div>
<div class="line">        pctrl-&gt;net_pair[idx].remove_pad = pctrl-&gt;all_remove_pad;</div>
<div class="line">        pctrl-&gt;net_pair[idx].add_port_meta_header = pctrl-&gt;all_add_port_meta_header;</div>
<div class="line">        pctrl-&gt;net_pair[idx].iter_num = pctrl-&gt;all_inter_num;</div>
<div class="line">        pctrl-&gt;net_pair[idx].net_run.single_dag_run = pctrl-&gt;all_single_run_dag;</div>
<div class="line">        <span class="keywordflow">if</span> (init_one_net(&amp;pctrl-&gt;net_pair[idx]) &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;start one net idx [%u] err\n&quot;</span>, idx);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        done_num++;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (rval == 0) {</div>
<div class="line">        <span class="keywordflow">switch</span> (pctrl-&gt;mode) {</div>
<div class="line">        <span class="keywordflow">case</span> MODE_SERIAL:</div>
<div class="line">            rval = run_all_nets_serial(pctrl);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> MODE_PARALLEL:</div>
<div class="line">            rval = run_all_nets_parallel(pctrl);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> MODE_RANDOM:</div>
<div class="line">            rval = run_all_nets_random(pctrl);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            printf(<span class="stringliteral">&quot;Unsupport mode\n&quot;</span>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Init network num not finished %d/%d\n&quot;</span>, done_num, net_num);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (done_num &gt; 0) {</div>
<div class="line">        <span class="keywordflow">for</span> (i = (done_num -1); i &gt;= 0; i--) {</div>
<div class="line">            <span class="keywordflow">if</span> (<a id="a92" name="a92"></a><a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#gaa2441a5c368143831d587ed6a4412549">nnctrl_exit_net</a>(pctrl-&gt;net_pair[i].net_id) &lt; 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;exit net idx [%d] err\n&quot;</span>, i);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> check_bw_all_nets(<span class="keyword">struct</span> nnctrl_param *pctrl)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">void</span> *ret = NULL;</div>
<div class="line">    uint32_t vp_bw = 0, dag_loop_cnt = 0;</div>
<div class="line">    uint32_t net_bw[pctrl-&gt;net_num];</div>
<div class="line">    uint32_t net_bw_with_margin = 0;</div>
<div class="line">    uint32_t net_num = 0, done_num = 0;</div>
<div class="line">    uint32_t idx = 0;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0, i = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        <span class="keywordflow">if</span> (pctrl-&gt;update_inter_num_flag) {</div>
<div class="line">            dag_loop_cnt = pctrl-&gt;all_inter_num; <span class="comment">/* user specified cnt */</span></div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            dag_loop_cnt = CK_BW_COUNT;  <span class="comment">/* default cnt */</span></div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (get_vp_bw(pctrl-&gt;fd_cav, dag_loop_cnt, &amp;vp_bw, pctrl-&gt;all_nvp_affinity) &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;get_vp_bw err\n&quot;</span>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* The real netwrok */</span></div>
<div class="line">        net_num = pctrl-&gt;net_num;</div>
<div class="line">        <span class="keywordflow">for</span> (idx = 0; idx &lt; net_num; idx++) {</div>
<div class="line">            pctrl-&gt;net_pair[idx].print_time= pctrl-&gt;all_print_time;</div>
<div class="line">            pctrl-&gt;net_pair[idx].iter_num = pctrl-&gt;all_inter_num;</div>
<div class="line">            <span class="keywordflow">if</span> (init_one_net(&amp;pctrl-&gt;net_pair[idx]) &lt; 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;init one net idx: %u err\n&quot;</span>, idx);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            done_num++;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">for</span> (idx = 0; idx &lt; net_num; idx++) {</div>
<div class="line">            ret = run_one_net(&amp;pctrl-&gt;net_pair[idx]);</div>
<div class="line">            <span class="keywordflow">if</span> (ret == NULL) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;run one net idx: %d err\n&quot;</span>, idx);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (rval == 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;==== Check Bandwidth ====\n&quot;</span>);</div>
<div class="line">            net_bw_with_margin = (vp_bw * (100 - CK_BW_MARGIN) / 100);</div>
<div class="line">            printf(<span class="stringliteral">&quot;Total VP Margin BW: %u MB/s = %u MB x (100 - %u)%%\n&quot;</span>,</div>
<div class="line">                net_bw_with_margin, vp_bw, CK_BW_MARGIN);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (idx = 0; idx &lt; net_num; idx++) {</div>
<div class="line">                net_bw[idx] = (pctrl-&gt;net_pair[idx].net_bw_sz * 1000000 &gt;&gt; 20) / pctrl-&gt;net_pair[idx].net_bw_us;</div>
<div class="line">                printf(<span class="stringliteral">&quot;Net [%d] BW : %u MB/s = %lu B / %u us\n&quot;</span>, idx, net_bw[idx],</div>
<div class="line">                    pctrl-&gt;net_pair[idx].net_bw_sz, pctrl-&gt;net_pair[idx].net_bw_us);</div>
<div class="line">                <span class="keywordflow">if</span> (net_bw[idx] &gt;= net_bw_with_margin) {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;Check BW Result: failed at Net [%d] %u &gt;= %u\n&quot;</span>,</div>
<div class="line">                        idx, net_bw[idx], net_bw_with_margin);</div>
<div class="line">                    rval = -1;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> ((rval == 0) &amp;&amp; (net_num &gt; 0)) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Check BW Result: pass\n&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">while</span> (0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (done_num &gt; 0) {</div>
<div class="line">        <span class="keywordflow">for</span> (i = (done_num -1); i &gt;= 0; i--) {</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#gaa2441a5c368143831d587ed6a4412549">nnctrl_exit_net</a>(pctrl-&gt;net_pair[i].net_id) &lt; 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;exit net idx [%d] err\n&quot;</span>, i);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> get_net_encrypt_state(<span class="keyword">const</span> <span class="keywordtype">char</span> *net_file, uint32_t *state)</div>
<div class="line">{</div>
<div class="line">    cavalry_gen_header_t header;</div>
<div class="line">    FILE *net_fp;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        net_fp = fopen(net_file, <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (net_fp == NULL) {</div>
<div class="line">            perror(net_file);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (fread(&amp;header, <span class="keyword">sizeof</span>(header), 1, net_fp) != 1) {</div>
<div class="line">            perror(<span class="stringliteral">&quot;fread cavalry head&quot;</span>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        *state = header.encrypt_state;</div>
<div class="line">    } <span class="keywordflow">while</span> (0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (net_fp) {</div>
<div class="line">        fclose(net_fp);</div>
<div class="line">        net_fp = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> show_all_net_encrypt_state(<span class="keyword">struct</span> nnctrl_param *pctrl)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line">    uint32_t i = 0, state = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pctrl-&gt;net_num) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Not found net bin, please specify it by -b option\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; pctrl-&gt;net_num; i++) {</div>
<div class="line">        rval = get_net_encrypt_state(pctrl-&gt;net_pair[i].net_name, &amp;state);</div>
<div class="line">        <span class="keywordflow">if</span> (rval) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;get encrypt state from net_file: %s err\n&quot;</span>, pctrl-&gt;net_pair[i].net_name);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        printf(<span class="stringliteral">&quot;Net_file: %s, Encrypt State: %u\n&quot;</span>, pctrl-&gt;net_pair[i].net_name, state);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> show_net_io_info(<span class="keyword">struct</span> <a class="code hl_struct" href="../../d3/d35/structnet__input__mfd__cfg.html">net_input_mfd_cfg</a> *net_in,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code hl_struct" href="../../d8/d85/structnet__output__mfd__cfg.html">net_output_mfd_cfg</a> *net_out)</div>
<div class="line">{</div>
<div class="line">    uint32_t i = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a88b08f224c035fa5cae2217e6d67afda">in_num</a>; i++) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Input: %u [%s] dim: (%lu, %lu, %lu, %lu), pitch: %lu, &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;dram_fmt: %u, bitvector: %d, data_fmt: (%d, %d, %d, %d), &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;loop_cnt: %u, size: %lu\n&quot;</span>,</div>
<div class="line">            i, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">name</a>,</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#afab25cb00475c5e5167bd688c8935f1d">plane</a>, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#af3562adee51a826821063e1a6e7dcd5b">depth</a>,</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a>, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>,</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a6151b90948f9409a6ad67219369dd801">pitch</a>,</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a5574b64abdcb1e8455471e18f6947d04">dram_fmt</a>, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#aac4ab403272f5be55e966d2735ceb313">bitvector</a>,</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>.<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#a0e0ace816facf5d8b503eb83e8e798b8">sign</a>, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>.<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ae5dc6ffcd9b7605c7787791e40cc6bb0">size</a>,</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>.<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#a375c68753379e89f4548d93e5e41d41d">expoffset</a>, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>.<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ad9cd444e0d5bf7539865ca6dc194d92e">expbits</a>,</div>
<div class="line">            net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">loop_cnt</a>, net_in-&gt;<a class="code hl_variable" href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">in_desc</a>[i].<a class="code hl_variable" href="../../d8/d1f/structinput__mfd__desc.html#abe4e3181b6f9f9243f03829322d3e235">size</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a17afdb10821678afccc3bec8d83e1625">out_num</a>; i++) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Output: %u [%s] dim: (%lu, %lu, %lu, %lu), pitch: %lu, &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;dram_fmt: %u, bitvector: %d, data_fmt: (%d, %d, %d, %d), &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;loop_cnt: %u, size: %lu\n&quot;</span>,</div>
<div class="line">            i, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">name</a>,</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#afab25cb00475c5e5167bd688c8935f1d">plane</a>, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#af3562adee51a826821063e1a6e7dcd5b">depth</a>,</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">height</a>, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">width</a>,</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a6151b90948f9409a6ad67219369dd801">pitch</a>,</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a5574b64abdcb1e8455471e18f6947d04">dram_fmt</a>, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#aac4ab403272f5be55e966d2735ceb313">bitvector</a>,</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>.<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#a0e0ace816facf5d8b503eb83e8e798b8">sign</a>, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>.<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ae5dc6ffcd9b7605c7787791e40cc6bb0">size</a>,</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>.<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#a375c68753379e89f4548d93e5e41d41d">expoffset</a>, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">data_fmt</a>.<a class="code hl_variable" href="../../d8/d06/structio__data__fmt.html#ad9cd444e0d5bf7539865ca6dc194d92e">expbits</a>,</div>
<div class="line">            net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">dim</a>.<a class="code hl_variable" href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">loop_cnt</a>, net_out-&gt;<a class="code hl_variable" href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">out_desc</a>[i].<a class="code hl_variable" href="../../d7/d3f/structoutput__mfd__desc.html#abe4e3181b6f9f9243f03829322d3e235">size</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> show_all_net_io_info(<span class="keyword">struct</span> nnctrl_param *pctrl)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code hl_struct" href="../../da/df5/structnet__cfg.html">net_cfg</a> net_cf = {0};</div>
<div class="line">    <span class="keyword">struct </span><a class="code hl_struct" href="../../d3/d35/structnet__input__mfd__cfg.html">net_input_mfd_cfg</a> net_in;</div>
<div class="line">    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d85/structnet__output__mfd__cfg.html">net_output_mfd_cfg</a> net_out;</div>
<div class="line">    uint32_t done_num = 0;</div>
<div class="line">    uint32_t net_num = 0;</div>
<div class="line">    uint32_t idx = 0;</div>
<div class="line">    <span class="keywordtype">int</span> net_id, rval = 0, i = 0;</div>
<div class="line"> </div>
<div class="line">    net_num = pctrl-&gt;net_num;</div>
<div class="line">    <span class="keywordflow">for</span> (idx = 0; idx &lt; net_num; idx++) {</div>
<div class="line">        net_cf.<a id="a93" name="a93"></a><a class="code hl_variable" href="../../da/df5/structnet__cfg.html#a63cde667c15df0743427416708b7a45c">net_file</a> = pctrl-&gt;net_pair[idx].net_name;</div>
<div class="line">        net_cf.<a id="a94" name="a94"></a><a class="code hl_variable" href="../../da/df5/structnet__cfg.html#a472dc082397949cb2effd786d8918fcf">no_chip_check</a> = pctrl-&gt;net_pair[idx].no_chip_check;</div>
<div class="line">        net_id = <a id="a95" name="a95"></a><a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#ga1979e4b7a487fba5776122920fa01a0d">nnctrl_init_net</a>(&amp;net_cf, NULL, NULL);</div>
<div class="line">        <span class="keywordflow">if</span> (net_id &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;init net idx [%u] err\n&quot;</span>, idx);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        pctrl-&gt;net_pair[idx].net_id = net_id;</div>
<div class="line">        done_num++;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (rval == 0) {</div>
<div class="line">        <span class="keywordflow">for</span> (idx = 0; idx &lt; net_num; idx++) {</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#ga86261721b933cd5c7cf2947cd1df3e36">nnctrl_get_net_io_cfg_by_mfd</a>(pctrl-&gt;net_pair[idx].net_id,</div>
<div class="line">                &amp;net_in, &amp;net_out) &lt; 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;get net idx [%u] io cfg err\n&quot;</span>, idx);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            printf(<span class="stringliteral">&quot;=======================\n&quot;</span>);</div>
<div class="line">            printf(<span class="stringliteral">&quot;Net id: %u, name: %s IO:\n&quot;</span>,</div>
<div class="line">                pctrl-&gt;net_pair[idx].net_id, pctrl-&gt;net_pair[idx].net_name);</div>
<div class="line">            show_net_io_info(&amp;net_in, &amp;net_out);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (done_num &gt; 0) {</div>
<div class="line">        <span class="keywordflow">for</span> (i = (done_num -1); i &gt;= 0; i--) {</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#gaa2441a5c368143831d587ed6a4412549">nnctrl_exit_net</a>(pctrl-&gt;net_pair[i].net_id) &lt; 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;exit net idx [%d] err\n&quot;</span>, i);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> show_version(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code hl_struct" href="../../d1/d44/structnnctrl__version.html">nnctrl_version</a> ver;</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;test_nnctrl %s\n&quot;</span>, app_ver);</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#ga945387bab991147baebaf92cf47389cd">nnctrl_get_version</a>(&amp;ver) &lt; 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;nnctrl get version err&quot;</span>);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        printf(<span class="stringliteral">&quot;%s: %u.%u.%u, mod-time: 0x%x\n&quot;</span>,</div>
<div class="line">            ver.description, ver.major, ver.minor, ver.patch, ver.mod_time);</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#gab0b85d308346a48417ca7c6a75bc0403">GET_CAVALRY_API_VER</a>(ver.cavalry_parser) &gt;= <a id="a96" name="a96"></a><a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga0667aef2a670b8f36a543913366d3044">INCLUDE_COMPAT_API_VER</a>) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Cavalry Parser Version: %u.%u.%u.%u\n&quot;</span>,</div>
<div class="line">                <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga9b8a1d5299e0f02ef59e27ef5713104b">GET_CAVALRY_MAJ_VER</a>(ver.cavalry_parser),</div>
<div class="line">                <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga3bd8b633ac23950949e26e99c402b23d">GET_CAVALRY_MIN_VER</a>(ver.cavalry_parser),</div>
<div class="line">                <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#gab0b85d308346a48417ca7c6a75bc0403">GET_CAVALRY_API_VER</a>(ver.cavalry_parser),</div>
<div class="line">                ver.cavalry_compat);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Cavalry Parser Version: %u.%u.%u\n&quot;</span>,</div>
<div class="line">                <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga9b8a1d5299e0f02ef59e27ef5713104b">GET_CAVALRY_MAJ_VER</a>(ver.cavalry_parser),</div>
<div class="line">                <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga3bd8b633ac23950949e26e99c402b23d">GET_CAVALRY_MIN_VER</a>(ver.cavalry_parser),</div>
<div class="line">                <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#gab0b85d308346a48417ca7c6a75bc0403">GET_CAVALRY_API_VER</a>(ver.cavalry_parser));</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> show_net_bin_version(<span class="keyword">struct</span> nnctrl_param *pctrl)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code hl_struct" href="../../d5/d3e/structnet__bin__version.html">net_bin_version</a> ver = {0};</div>
<div class="line">    uint32_t i = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pctrl-&gt;net_num) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Not found net bin, please specify it by -b option\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; pctrl-&gt;net_num; i++) {</div>
<div class="line">        ver.<a class="code hl_variable" href="../../d5/d3e/structnet__bin__version.html#a63cde667c15df0743427416708b7a45c">net_file</a> = pctrl-&gt;net_pair[i].net_name;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#ga2e54cd7df70002d6a5f8bee58dc5a3ba">nnctrl_get_net_bin_version</a>(&amp;ver) &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;nnctrl get net bin version err&quot;</span>);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#gab0b85d308346a48417ca7c6a75bc0403">GET_CAVALRY_API_VER</a>(ver.<a class="code hl_variable" href="../../d5/d3e/structnet__bin__version.html#aee8a17f0e8b74a97832ab1824d1aba20">cavalry_gen_version</a>) &gt;= <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga0667aef2a670b8f36a543913366d3044">INCLUDE_COMPAT_API_VER</a>) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;[%s] Net Binary Cavalry Gen Version: %u.%u.%u.%u\n&quot;</span>, ver.<a class="code hl_variable" href="../../d5/d3e/structnet__bin__version.html#a63cde667c15df0743427416708b7a45c">net_file</a>,</div>
<div class="line">                <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga9b8a1d5299e0f02ef59e27ef5713104b">GET_CAVALRY_MAJ_VER</a>(ver.<a class="code hl_variable" href="../../d5/d3e/structnet__bin__version.html#aee8a17f0e8b74a97832ab1824d1aba20">cavalry_gen_version</a>),</div>
<div class="line">                <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga3bd8b633ac23950949e26e99c402b23d">GET_CAVALRY_MIN_VER</a>(ver.<a class="code hl_variable" href="../../d5/d3e/structnet__bin__version.html#aee8a17f0e8b74a97832ab1824d1aba20">cavalry_gen_version</a>),</div>
<div class="line">                <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#gab0b85d308346a48417ca7c6a75bc0403">GET_CAVALRY_API_VER</a>(ver.<a class="code hl_variable" href="../../d5/d3e/structnet__bin__version.html#aee8a17f0e8b74a97832ab1824d1aba20">cavalry_gen_version</a>),</div>
<div class="line">                ver.<a class="code hl_variable" href="../../d5/d3e/structnet__bin__version.html#ac86996e2075c6c7db5004ecfc6777157">cavalry_compat_version</a>);</div>
<div class="line">            printf(<span class="stringliteral">&quot;VDG Chip Arch: %s\n&quot;</span>, get_arch_name_by_id(ver.<a class="code hl_variable" href="../../d5/d3e/structnet__bin__version.html#ad58fa20ade994ca3ac378e6dc8e809f0">vdg_arch</a>));</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            printf(<span class="stringliteral">&quot;[%s] Net Binary Cavalry Gen Version: %u.%u.%u\n&quot;</span>, ver.<a class="code hl_variable" href="../../d5/d3e/structnet__bin__version.html#a63cde667c15df0743427416708b7a45c">net_file</a>,</div>
<div class="line">                <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga9b8a1d5299e0f02ef59e27ef5713104b">GET_CAVALRY_MAJ_VER</a>(ver.<a class="code hl_variable" href="../../d5/d3e/structnet__bin__version.html#aee8a17f0e8b74a97832ab1824d1aba20">cavalry_gen_version</a>),</div>
<div class="line">                <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#ga3bd8b633ac23950949e26e99c402b23d">GET_CAVALRY_MIN_VER</a>(ver.<a class="code hl_variable" href="../../d5/d3e/structnet__bin__version.html#aee8a17f0e8b74a97832ab1824d1aba20">cavalry_gen_version</a>),</div>
<div class="line">                <a class="code hl_define" href="../../d9/d50/group__nnctrl-helper.html#gab0b85d308346a48417ca7c6a75bc0403">GET_CAVALRY_API_VER</a>(ver.<a class="code hl_variable" href="../../d5/d3e/structnet__bin__version.html#aee8a17f0e8b74a97832ab1824d1aba20">cavalry_gen_version</a>));</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> sigstop()</div>
<div class="line">{</div>
<div class="line">    G_nnctrl.all_run_loop = 0;</div>
<div class="line">    printf(<span class="stringliteral">&quot;sigstop msg\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a id="a97" name="a97"></a><a class="code hl_function" href="../../dc/d60/test__smartfb_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>nnctrl_param *pctrl = &amp;G_nnctrl;</div>
<div class="line">    <span class="keywordtype">int</span> rval = 0;</div>
<div class="line"> </div>
<div class="line">    signal(SIGINT, sigstop);</div>
<div class="line">    signal(SIGQUIT, sigstop);</div>
<div class="line">    signal(SIGTERM, sigstop);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (argc &lt; 2) {</div>
<div class="line">        <a class="code hl_function" href="../../dc/d60/test__smartfb_8c.html#ad96d407a911fbb914fa8e4cfbf2faf0f">usage</a>();</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    memset((<span class="keywordtype">void</span> *)pctrl, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> nnctrl_param));</div>
<div class="line">    pctrl-&gt;all_inter_num = 1; <span class="comment">/* Set iteration to 1 by default */</span></div>
<div class="line">    pctrl-&gt;all_batch_num = 1;</div>
<div class="line">    pctrl-&gt;all_run_loop = 1;</div>
<div class="line">    pctrl-&gt;all_remove_pad = 1;  <span class="comment">/* default is remove padding on output bin */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (init_param(argc, argv) &lt; 0) {</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (pctrl-&gt;show_version_flag) {</div>
<div class="line">        show_version();</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pctrl-&gt;show_net_bin_version_flag) {</div>
<div class="line">        show_net_bin_version(pctrl);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pctrl-&gt;show_net_encrypt_state_flag) {</div>
<div class="line">        show_all_net_encrypt_state(pctrl);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    } <span class="keywordflow">else</span> {;}</div>
<div class="line"> </div>
<div class="line">    pctrl-&gt;fd_cav = open(CAVALRY_DEV_NODE, O_RDWR, 0);</div>
<div class="line">    <span class="keywordflow">if</span> (pctrl-&gt;fd_cav &lt; 0) {</div>
<div class="line">        perror(CAVALRY_DEV_NODE);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        <span class="keywordflow">if</span> (pctrl-&gt;set_log_level_flag) {</div>
<div class="line">            <a id="a98" name="a98"></a><a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#ga13799f7d2903a17a86994811827ae82e">nnctrl_set_log_level</a>(pctrl-&gt;libnn_log_level);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a id="a99" name="a99"></a><a class="code hl_function" href="../../dd/da5/group__nnctrl-api-details.html#ga91383318499db0b0e6a998e6608a8916">nnctrl_init</a>(pctrl-&gt;fd_cav, pctrl-&gt;verbose) &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;nnctrl_init err\n&quot;</span>);</div>
<div class="line">            rval = -1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (pctrl-&gt;show_net_io_flag) {</div>
<div class="line">            show_all_net_io_info(pctrl);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">if</span> (<a id="a100" name="a100"></a><a class="code hl_function" href="../../d3/dbf/group__cavalry__mem-api-details.html#ga201938043385c5764ad3e2f4df21343d">cavalry_mem_init</a>(pctrl-&gt;fd_cav, (uint8_t)pctrl-&gt;verbose) &lt; 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;cavalry_mem_init err\n&quot;</span>);</div>
<div class="line">                rval = -1;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (pctrl-&gt;ck_bw_flag) {</div>
<div class="line">                <span class="keywordflow">if</span> (check_bw_all_nets(pctrl) &lt; 0) {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;check bw of all nets err\n&quot;</span>);</div>
<div class="line">                    rval = -1;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="keywordflow">if</span> (start_all_nets(pctrl) &lt; 0) {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;start all nets err\n&quot;</span>);</div>
<div class="line">                    rval = -1;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">while</span> (0);</div>
<div class="line"> </div>
<div class="line">    free_all_cv_mem(pctrl);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (pctrl-&gt;net_pair) {</div>
<div class="line">        free(pctrl-&gt;net_pair);</div>
<div class="line">        pctrl-&gt;net_pair = NULL;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (pctrl-&gt;fd_cav &gt;= 0) {</div>
<div class="line">        close(pctrl-&gt;fd_cav);</div>
<div class="line">        pctrl-&gt;fd_cav = -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rval;</div>
<div class="line">}</div>
<div class="ttc" id="acJSON_8h_html_a1a175e87536301df98c805ac0636ad7c"><div class="ttname"><a href="../../d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a></div><div class="ttdeci">const cJSON *const b</div><div class="ttdef"><b>Definition:</b> cJSON.h:255</div></div>
<div class="ttc" id="acJSON_8h_html_a25d22ecc7e656d2c59332072684e8766"><div class="ttname"><a href="../../d1/d82/cJSON_8h.html#a25d22ecc7e656d2c59332072684e8766">name</a></div><div class="ttdeci">const char *const name</div><div class="ttdef"><b>Definition:</b> cJSON.h:264</div></div>
<div class="ttc" id="acavalry__mem_8h_html"><div class="ttname"><a href="../../de/db0/cavalry__mem_8h.html">cavalry_mem.h</a></div></div>
<div class="ttc" id="afile__io_8h_html_afaf3af3799be8b7b8b626f21d3b70167"><div class="ttname"><a href="../../db/db8/file__io_8h.html#afaf3af3799be8b7b8b626f21d3b70167">get_file_size</a></div><div class="ttdeci">unsigned int get_file_size(const char *filename)</div></div>
<div class="ttc" id="agroup__cavalry__mem-api-details_html_ga11496d15c21487b501f9a884337eb4dd"><div class="ttname"><a href="../../d3/dbf/group__cavalry__mem-api-details.html#ga11496d15c21487b501f9a884337eb4dd">cavalry_mem_alloc_mfd</a></div><div class="ttdeci">AMBA_API int cavalry_mem_alloc_mfd(IN unsigned long size, OUT int *fd, OUT void **pvirt, IN uint8_t cache_en)</div></div>
<div class="ttc" id="agroup__cavalry__mem-api-details_html_ga201938043385c5764ad3e2f4df21343d"><div class="ttname"><a href="../../d3/dbf/group__cavalry__mem-api-details.html#ga201938043385c5764ad3e2f4df21343d">cavalry_mem_init</a></div><div class="ttdeci">AMBA_API int cavalry_mem_init(IN int fd_cav, IN uint8_t verbose)</div></div>
<div class="ttc" id="agroup__cavalry__mem-api-details_html_gac1c19b44ff8de3191b58d623ae74f42c"><div class="ttname"><a href="../../d3/dbf/group__cavalry__mem-api-details.html#gac1c19b44ff8de3191b58d623ae74f42c">cavalry_mem_free_mfd</a></div><div class="ttdeci">AMBA_API int cavalry_mem_free_mfd(IN unsigned long size, IN int fd, IN void *virt)</div></div>
<div class="ttc" id="agroup__cavalry__mem-api-details_html_gac7c5651a00b1b00eadf9690d20b2bedd"><div class="ttname"><a href="../../d3/dbf/group__cavalry__mem-api-details.html#gac7c5651a00b1b00eadf9690d20b2bedd">cavalry_mem_sync_cache_mfd</a></div><div class="ttdeci">AMBA_API int cavalry_mem_sync_cache_mfd(IN unsigned long size, IN unsigned long offset, IN int fd, IN uint8_t clean, IN uint8_t invalid)</div></div>
<div class="ttc" id="agroup__iav-common-helper_html_gad1b352de3b0722699205a3021bdbb615"><div class="ttname"><a href="../../d3/d5a/group__iav-common-helper.html#gad1b352de3b0722699205a3021bdbb615">ROUND_UP</a></div><div class="ttdeci">#define ROUND_UP(x, n)</div><div class="ttdoc">round up func.</div><div class="ttdef"><b>Definition:</b> iav_common.h:505</div></div>
<div class="ttc" id="agroup__nnctrl-api-details_html_ga12db598f56dd9956a8bd54ea4533c95c"><div class="ttname"><a href="../../dd/da5/group__nnctrl-api-details.html#ga12db598f56dd9956a8bd54ea4533c95c">nnctrl_resume_net</a></div><div class="ttdeci">AMBA_API int nnctrl_resume_net(IN int net_id, OUT struct net_result *net_ret)</div></div>
<div class="ttc" id="agroup__nnctrl-api-details_html_ga13799f7d2903a17a86994811827ae82e"><div class="ttname"><a href="../../dd/da5/group__nnctrl-api-details.html#ga13799f7d2903a17a86994811827ae82e">nnctrl_set_log_level</a></div><div class="ttdeci">AMBA_API void nnctrl_set_log_level(IN uint32_t log_level)</div></div>
<div class="ttc" id="agroup__nnctrl-api-details_html_ga1979e4b7a487fba5776122920fa01a0d"><div class="ttname"><a href="../../dd/da5/group__nnctrl-api-details.html#ga1979e4b7a487fba5776122920fa01a0d">nnctrl_init_net</a></div><div class="ttdeci">AMBA_API int nnctrl_init_net(INOUT struct net_cfg *net_cf, INOUT struct net_input_cfg *net_in, INOUT struct net_output_cfg *net_out)</div></div>
<div class="ttc" id="agroup__nnctrl-api-details_html_ga2a3ae257681f835bf13fbe7c43266c86"><div class="ttname"><a href="../../dd/da5/group__nnctrl-api-details.html#ga2a3ae257681f835bf13fbe7c43266c86">nnctrl_run_net_by_mfd</a></div><div class="ttdeci">AMBA_API int nnctrl_run_net_by_mfd(IN int net_id, OUT struct net_result *net_ret, IN struct net_run_cfg *net_run, IN struct net_input_mfd_cfg *net_in, IN struct net_output_mfd_cfg *net_out)</div></div>
<div class="ttc" id="agroup__nnctrl-api-details_html_ga2e54cd7df70002d6a5f8bee58dc5a3ba"><div class="ttname"><a href="../../dd/da5/group__nnctrl-api-details.html#ga2e54cd7df70002d6a5f8bee58dc5a3ba">nnctrl_get_net_bin_version</a></div><div class="ttdeci">AMBA_API int nnctrl_get_net_bin_version(struct net_bin_version *bin_ver)</div></div>
<div class="ttc" id="agroup__nnctrl-api-details_html_ga86261721b933cd5c7cf2947cd1df3e36"><div class="ttname"><a href="../../dd/da5/group__nnctrl-api-details.html#ga86261721b933cd5c7cf2947cd1df3e36">nnctrl_get_net_io_cfg_by_mfd</a></div><div class="ttdeci">AMBA_API int nnctrl_get_net_io_cfg_by_mfd(IN int net_id, OUT struct net_input_mfd_cfg *net_in, OUT struct net_output_mfd_cfg *net_out)</div></div>
<div class="ttc" id="agroup__nnctrl-api-details_html_ga91383318499db0b0e6a998e6608a8916"><div class="ttname"><a href="../../dd/da5/group__nnctrl-api-details.html#ga91383318499db0b0e6a998e6608a8916">nnctrl_init</a></div><div class="ttdeci">AMBA_API int nnctrl_init(IN int fd_cav, IN uint8_t verbose)</div></div>
<div class="ttc" id="agroup__nnctrl-api-details_html_ga934ebe255a4d041af5d398784ce7046c"><div class="ttname"><a href="../../dd/da5/group__nnctrl-api-details.html#ga934ebe255a4d041af5d398784ce7046c">nnctrl_load_net_by_mfd</a></div><div class="ttdeci">AMBA_API int nnctrl_load_net_by_mfd(IN int net_id, IN struct cavalry_mfd_desc *net_m, INOUT struct net_input_mfd_cfg *net_in, INOUT struct net_output_mfd_cfg *net_out)</div></div>
<div class="ttc" id="agroup__nnctrl-api-details_html_ga945387bab991147baebaf92cf47389cd"><div class="ttname"><a href="../../dd/da5/group__nnctrl-api-details.html#ga945387bab991147baebaf92cf47389cd">nnctrl_get_version</a></div><div class="ttdeci">AMBA_API int nnctrl_get_version(OUT struct nnctrl_version *ver)</div></div>
<div class="ttc" id="agroup__nnctrl-api-details_html_ga964c3b506357a71707479d55a0af66f6"><div class="ttname"><a href="../../dd/da5/group__nnctrl-api-details.html#ga964c3b506357a71707479d55a0af66f6">nnctrl_dump_net</a></div><div class="ttdeci">AMBA_API int nnctrl_dump_net(IN int net_id, IN const char *path)</div></div>
<div class="ttc" id="agroup__nnctrl-api-details_html_ga989220e6dceaee74278f20caa2c51873"><div class="ttname"><a href="../../dd/da5/group__nnctrl-api-details.html#ga989220e6dceaee74278f20caa2c51873">nnctrl_set_hw_affinity</a></div><div class="ttdeci">AMBA_API int nnctrl_set_hw_affinity(IN int net_id, IN struct net_hw_affinity *affinity)</div></div>
<div class="ttc" id="agroup__nnctrl-api-details_html_gaa2441a5c368143831d587ed6a4412549"><div class="ttname"><a href="../../dd/da5/group__nnctrl-api-details.html#gaa2441a5c368143831d587ed6a4412549">nnctrl_exit_net</a></div><div class="ttdeci">AMBA_API int nnctrl_exit_net(IN int net_id)</div></div>
<div class="ttc" id="agroup__nnctrl-api-details_html_gaa808de738ac3a2c43d5c3cf74254c56c"><div class="ttname"><a href="../../dd/da5/group__nnctrl-api-details.html#gaa808de738ac3a2c43d5c3cf74254c56c">nnctrl_query_dvi</a></div><div class="ttdeci">AMBA_API int nnctrl_query_dvi(IN int net_id, IN uint32_t dvi_id, OUT struct net_dvi_cfg *net_dvi)</div></div>
<div class="ttc" id="agroup__nnctrl-api-details_html_gaae87e820289102f4fb296bed8f1405df"><div class="ttname"><a href="../../dd/da5/group__nnctrl-api-details.html#gaae87e820289102f4fb296bed8f1405df">nnctrl_init_net_by_mfd</a></div><div class="ttdeci">AMBA_API int nnctrl_init_net_by_mfd(INOUT struct net_cfg *net_cf, INOUT struct net_input_mfd_cfg *net_in, INOUT struct net_output_mfd_cfg *net_out)</div></div>
<div class="ttc" id="agroup__nnctrl-helper_html_ga0667aef2a670b8f36a543913366d3044"><div class="ttname"><a href="../../d9/d50/group__nnctrl-helper.html#ga0667aef2a670b8f36a543913366d3044">INCLUDE_COMPAT_API_VER</a></div><div class="ttdeci">#define INCLUDE_COMPAT_API_VER</div><div class="ttdoc">define the cavalry_gen API version that contain compat version info</div><div class="ttdef"><b>Definition:</b> nnctrl.h:82</div></div>
<div class="ttc" id="agroup__nnctrl-helper_html_ga0e2b8805187717eb546342bcea70a22a"><div class="ttname"><a href="../../d9/d50/group__nnctrl-helper.html#ga0e2b8805187717eb546342bcea70a22a">MAX_IO_NUM</a></div><div class="ttdeci">#define MAX_IO_NUM</div><div class="ttdoc">define max number of network's port (input and output)</div><div class="ttdef"><b>Definition:</b> nnctrl.h:399</div></div>
<div class="ttc" id="agroup__nnctrl-helper_html_ga39e7b53328351fc47cce0121afb434a4"><div class="ttname"><a href="../../d9/d50/group__nnctrl-helper.html#ga39e7b53328351fc47cce0121afb434a4">NN_LOG_VERBOSE</a></div><div class="ttdeci">#define NN_LOG_VERBOSE</div><div class="ttdoc">define nnctrl library log level verbose</div><div class="ttdef"><b>Definition:</b> nnctrl.h:108</div></div>
<div class="ttc" id="agroup__nnctrl-helper_html_ga3bd8b633ac23950949e26e99c402b23d"><div class="ttname"><a href="../../d9/d50/group__nnctrl-helper.html#ga3bd8b633ac23950949e26e99c402b23d">GET_CAVALRY_MIN_VER</a></div><div class="ttdeci">#define GET_CAVALRY_MIN_VER(v)</div><div class="ttdoc">define the cavalry_gen major version</div><div class="ttdef"><b>Definition:</b> nnctrl.h:72</div></div>
<div class="ttc" id="agroup__nnctrl-helper_html_ga6bdeac461478fc7f0ae51c70f7ce190c"><div class="ttname"><a href="../../d9/d50/group__nnctrl-helper.html#ga6bdeac461478fc7f0ae51c70f7ce190c">NN_LOG_ERR</a></div><div class="ttdeci">#define NN_LOG_ERR</div><div class="ttdoc">define nnctrl library log level error</div><div class="ttdef"><b>Definition:</b> nnctrl.h:88</div></div>
<div class="ttc" id="agroup__nnctrl-helper_html_ga9b8a1d5299e0f02ef59e27ef5713104b"><div class="ttname"><a href="../../d9/d50/group__nnctrl-helper.html#ga9b8a1d5299e0f02ef59e27ef5713104b">GET_CAVALRY_MAJ_VER</a></div><div class="ttdeci">#define GET_CAVALRY_MAJ_VER(v)</div><div class="ttdoc">define the cavalry_gen major version</div><div class="ttdef"><b>Definition:</b> nnctrl.h:67</div></div>
<div class="ttc" id="agroup__nnctrl-helper_html_gab0b85d308346a48417ca7c6a75bc0403"><div class="ttname"><a href="../../d9/d50/group__nnctrl-helper.html#gab0b85d308346a48417ca7c6a75bc0403">GET_CAVALRY_API_VER</a></div><div class="ttdeci">#define GET_CAVALRY_API_VER(v)</div><div class="ttdoc">define the cavalry_gen API version</div><div class="ttdef"><b>Definition:</b> nnctrl.h:77</div></div>
<div class="ttc" id="agroup__nnctrl-helper_html_ggaeecd646cca3b6bbcc2f1e15a76ae5c2ea5192414668c4552c65c181ba528d9bf8"><div class="ttname"><a href="../../d9/d50/group__nnctrl-helper.html#ggaeecd646cca3b6bbcc2f1e15a76ae5c2ea5192414668c4552c65c181ba528d9bf8">DROTATE_BIT</a></div><div class="ttdeci">@ DROTATE_BIT</div><div class="ttdef"><b>Definition:</b> nnctrl.h:271</div></div>
<div class="ttc" id="annctrl_8h_html"><div class="ttname"><a href="../../db/d9f/nnctrl_8h.html">nnctrl.h</a></div></div>
<div class="ttc" id="astructhint__s_html"><div class="ttname"><a href="../../../video/d2/d4b/structhint__s.html">hint_s</a></div></div>
<div class="ttc" id="astructhint__s_html_a2799cca21c05a4f99f4c8b3b178d0133"><div class="ttname"><a href="../../../video/d2/d4b/structhint__s.html#a2799cca21c05a4f99f4c8b3b178d0133">hint_s::str</a></div><div class="ttdeci">const char * str</div></div>
<div class="ttc" id="astructhint__s_html_aa56a50443afd9d2f7cf738fb7ffba168"><div class="ttname"><a href="../../../video/d2/d4b/structhint__s.html#aa56a50443afd9d2f7cf738fb7ffba168">hint_s::arg</a></div><div class="ttdeci">const char * arg</div></div>
<div class="ttc" id="astructinput__mfd__desc_html_a05b251f6f4721e4b738a9439a7eda472"><div class="ttname"><a href="../../d8/d1f/structinput__mfd__desc.html#a05b251f6f4721e4b738a9439a7eda472">input_mfd_desc::no_mem</a></div><div class="ttdeci">IN uint32_t no_mem</div><div class="ttdef"><b>Definition:</b> nnctrl.h:321</div></div>
<div class="ttc" id="astructinput__mfd__desc_html_a32bea48d7aa93b31ae10943c1ba552ec"><div class="ttname"><a href="../../d8/d1f/structinput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">input_mfd_desc::dim</a></div><div class="ttdeci">OUT struct io_dim dim</div><div class="ttdef"><b>Definition:</b> nnctrl.h:334</div></div>
<div class="ttc" id="astructinput__mfd__desc_html_a333fd20f0a0fe19d88d0a2ad740e9003"><div class="ttname"><a href="../../d8/d1f/structinput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">input_mfd_desc::data_fmt</a></div><div class="ttdeci">OUT struct io_data_fmt data_fmt</div><div class="ttdef"><b>Definition:</b> nnctrl.h:335</div></div>
<div class="ttc" id="astructinput__mfd__desc_html_a526e36643f6467051f6e6ba512bcf963"><div class="ttname"><a href="../../d8/d1f/structinput__mfd__desc.html#a526e36643f6467051f6e6ba512bcf963">input_mfd_desc::fd_offset</a></div><div class="ttdeci">INOUT unsigned long fd_offset</div><div class="ttdef"><b>Definition:</b> nnctrl.h:316</div></div>
<div class="ttc" id="astructinput__mfd__desc_html_a532e610b0794e9d695c04dee8b22162f"><div class="ttname"><a href="../../d8/d1f/structinput__mfd__desc.html#a532e610b0794e9d695c04dee8b22162f">input_mfd_desc::virt</a></div><div class="ttdeci">INOUT uint8_t * virt</div><div class="ttdef"><b>Definition:</b> nnctrl.h:314</div></div>
<div class="ttc" id="astructinput__mfd__desc_html_a8b1c668d1a96dde72c36f17898ae9e51"><div class="ttname"><a href="../../d8/d1f/structinput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">input_mfd_desc::name</a></div><div class="ttdeci">INOUT const char * name</div><div class="ttdef"><b>Definition:</b> nnctrl.h:312</div></div>
<div class="ttc" id="astructinput__mfd__desc_html_a8df7d51bc3df84df92cf0b247af8d909"><div class="ttname"><a href="../../d8/d1f/structinput__mfd__desc.html#a8df7d51bc3df84df92cf0b247af8d909">input_mfd_desc::rotate_flip_bitmap</a></div><div class="ttdeci">IN uint32_t rotate_flip_bitmap</div><div class="ttdef"><b>Definition:</b> nnctrl.h:324</div></div>
<div class="ttc" id="astructinput__mfd__desc_html_abdb7d98eb79205cdc90022a4c4b75d16"><div class="ttname"><a href="../../d8/d1f/structinput__mfd__desc.html#abdb7d98eb79205cdc90022a4c4b75d16">input_mfd_desc::update_pitch</a></div><div class="ttdeci">IN unsigned long update_pitch</div><div class="ttdef"><b>Definition:</b> nnctrl.h:329</div></div>
<div class="ttc" id="astructinput__mfd__desc_html_abe4e3181b6f9f9243f03829322d3e235"><div class="ttname"><a href="../../d8/d1f/structinput__mfd__desc.html#abe4e3181b6f9f9243f03829322d3e235">input_mfd_desc::size</a></div><div class="ttdeci">OUT unsigned long size</div><div class="ttdef"><b>Definition:</b> nnctrl.h:315</div></div>
<div class="ttc" id="astructinput__mfd__desc_html_afbc217e9e58aab57dacc70a1f54d938f"><div class="ttname"><a href="../../d8/d1f/structinput__mfd__desc.html#afbc217e9e58aab57dacc70a1f54d938f">input_mfd_desc::mem_fd</a></div><div class="ttdeci">INOUT int mem_fd</div><div class="ttdef"><b>Definition:</b> nnctrl.h:318</div></div>
<div class="ttc" id="astructio__data__fmt_html"><div class="ttname"><a href="../../d8/d06/structio__data__fmt.html">io_data_fmt</a></div><div class="ttdoc">The io data format description.</div><div class="ttdef"><b>Definition:</b> nnctrl.h:257</div></div>
<div class="ttc" id="astructio__data__fmt_html_a0e0ace816facf5d8b503eb83e8e798b8"><div class="ttname"><a href="../../d8/d06/structio__data__fmt.html#a0e0ace816facf5d8b503eb83e8e798b8">io_data_fmt::sign</a></div><div class="ttdeci">uint8_t sign</div><div class="ttdef"><b>Definition:</b> nnctrl.h:258</div></div>
<div class="ttc" id="astructio__data__fmt_html_a30ac373a73f28a69e7f5036846722455"><div class="ttname"><a href="../../d8/d06/structio__data__fmt.html#a30ac373a73f28a69e7f5036846722455">io_data_fmt::bitsize</a></div><div class="ttdeci">uint32_t bitsize</div><div class="ttdef"><b>Definition:</b> nnctrl.h:262</div></div>
<div class="ttc" id="astructio__data__fmt_html_a375c68753379e89f4548d93e5e41d41d"><div class="ttname"><a href="../../d8/d06/structio__data__fmt.html#a375c68753379e89f4548d93e5e41d41d">io_data_fmt::expoffset</a></div><div class="ttdeci">int8_t expoffset</div><div class="ttdef"><b>Definition:</b> nnctrl.h:260</div></div>
<div class="ttc" id="astructio__data__fmt_html_ad9cd444e0d5bf7539865ca6dc194d92e"><div class="ttname"><a href="../../d8/d06/structio__data__fmt.html#ad9cd444e0d5bf7539865ca6dc194d92e">io_data_fmt::expbits</a></div><div class="ttdeci">uint8_t expbits</div><div class="ttdef"><b>Definition:</b> nnctrl.h:261</div></div>
<div class="ttc" id="astructio__data__fmt_html_ae5dc6ffcd9b7605c7787791e40cc6bb0"><div class="ttname"><a href="../../d8/d06/structio__data__fmt.html#ae5dc6ffcd9b7605c7787791e40cc6bb0">io_data_fmt::size</a></div><div class="ttdeci">uint8_t size</div><div class="ttdef"><b>Definition:</b> nnctrl.h:259</div></div>
<div class="ttc" id="astructio__dim_html"><div class="ttname"><a href="../../db/de7/structio__dim.html">io_dim</a></div><div class="ttdoc">The io dimension description.</div><div class="ttdef"><b>Definition:</b> nnctrl.h:234</div></div>
<div class="ttc" id="astructio__dim_html_a2a80572814f32a23139da84a214f3e7e"><div class="ttname"><a href="../../db/de7/structio__dim.html#a2a80572814f32a23139da84a214f3e7e">io_dim::height</a></div><div class="ttdeci">unsigned long height</div><div class="ttdef"><b>Definition:</b> nnctrl.h:237</div></div>
<div class="ttc" id="astructio__dim_html_a3f3081bbf4aed5f1d478704ef9f0ec49"><div class="ttname"><a href="../../db/de7/structio__dim.html#a3f3081bbf4aed5f1d478704ef9f0ec49">io_dim::width</a></div><div class="ttdeci">unsigned long width</div><div class="ttdef"><b>Definition:</b> nnctrl.h:238</div></div>
<div class="ttc" id="astructio__dim_html_a5574b64abdcb1e8455471e18f6947d04"><div class="ttname"><a href="../../db/de7/structio__dim.html#a5574b64abdcb1e8455471e18f6947d04">io_dim::dram_fmt</a></div><div class="ttdeci">uint32_t dram_fmt</div><div class="ttdef"><b>Definition:</b> nnctrl.h:247</div></div>
<div class="ttc" id="astructio__dim_html_a6151b90948f9409a6ad67219369dd801"><div class="ttname"><a href="../../db/de7/structio__dim.html#a6151b90948f9409a6ad67219369dd801">io_dim::pitch</a></div><div class="ttdeci">unsigned long pitch</div><div class="ttdef"><b>Definition:</b> nnctrl.h:240</div></div>
<div class="ttc" id="astructio__dim_html_a71f8b6beb30d06e1df554118078a447e"><div class="ttname"><a href="../../db/de7/structio__dim.html#a71f8b6beb30d06e1df554118078a447e">io_dim::loop_cnt</a></div><div class="ttdeci">uint32_t loop_cnt</div><div class="ttdef"><b>Definition:</b> nnctrl.h:248</div></div>
<div class="ttc" id="astructio__dim_html_aac4ab403272f5be55e966d2735ceb313"><div class="ttname"><a href="../../db/de7/structio__dim.html#aac4ab403272f5be55e966d2735ceb313">io_dim::bitvector</a></div><div class="ttdeci">uint32_t bitvector</div><div class="ttdef"><b>Definition:</b> nnctrl.h:241</div></div>
<div class="ttc" id="astructio__dim_html_af3562adee51a826821063e1a6e7dcd5b"><div class="ttname"><a href="../../db/de7/structio__dim.html#af3562adee51a826821063e1a6e7dcd5b">io_dim::depth</a></div><div class="ttdeci">unsigned long depth</div><div class="ttdef"><b>Definition:</b> nnctrl.h:236</div></div>
<div class="ttc" id="astructio__dim_html_afab25cb00475c5e5167bd688c8935f1d"><div class="ttname"><a href="../../db/de7/structio__dim.html#afab25cb00475c5e5167bd688c8935f1d">io_dim::plane</a></div><div class="ttdeci">unsigned long plane</div><div class="ttdef"><b>Definition:</b> nnctrl.h:235</div></div>
<div class="ttc" id="astructnet__bin__version_html"><div class="ttname"><a href="../../d5/d3e/structnet__bin__version.html">net_bin_version</a></div><div class="ttdoc">The network model binary version.</div><div class="ttdef"><b>Definition:</b> nnctrl.h:123</div></div>
<div class="ttc" id="astructnet__bin__version_html_a63cde667c15df0743427416708b7a45c"><div class="ttname"><a href="../../d5/d3e/structnet__bin__version.html#a63cde667c15df0743427416708b7a45c">net_bin_version::net_file</a></div><div class="ttdeci">IN const char * net_file</div><div class="ttdef"><b>Definition:</b> nnctrl.h:124</div></div>
<div class="ttc" id="astructnet__bin__version_html_ac86996e2075c6c7db5004ecfc6777157"><div class="ttname"><a href="../../d5/d3e/structnet__bin__version.html#ac86996e2075c6c7db5004ecfc6777157">net_bin_version::cavalry_compat_version</a></div><div class="ttdeci">OUT uint32_t cavalry_compat_version</div><div class="ttdef"><b>Definition:</b> nnctrl.h:127</div></div>
<div class="ttc" id="astructnet__bin__version_html_ad58fa20ade994ca3ac378e6dc8e809f0"><div class="ttname"><a href="../../d5/d3e/structnet__bin__version.html#ad58fa20ade994ca3ac378e6dc8e809f0">net_bin_version::vdg_arch</a></div><div class="ttdeci">OUT uint8_t vdg_arch</div><div class="ttdef"><b>Definition:</b> nnctrl.h:129</div></div>
<div class="ttc" id="astructnet__bin__version_html_aee8a17f0e8b74a97832ab1824d1aba20"><div class="ttname"><a href="../../d5/d3e/structnet__bin__version.html#aee8a17f0e8b74a97832ab1824d1aba20">net_bin_version::cavalry_gen_version</a></div><div class="ttdeci">OUT uint32_t cavalry_gen_version</div><div class="ttdef"><b>Definition:</b> nnctrl.h:126</div></div>
<div class="ttc" id="astructnet__cfg_html"><div class="ttname"><a href="../../da/df5/structnet__cfg.html">net_cfg</a></div><div class="ttdoc">The network configuration in initialization.</div><div class="ttdef"><b>Definition:</b> nnctrl.h:139</div></div>
<div class="ttc" id="astructnet__cfg_html_a472dc082397949cb2effd786d8918fcf"><div class="ttname"><a href="../../da/df5/structnet__cfg.html#a472dc082397949cb2effd786d8918fcf">net_cfg::no_chip_check</a></div><div class="ttdeci">IN uint32_t no_chip_check</div><div class="ttdef"><b>Definition:</b> nnctrl.h:149</div></div>
<div class="ttc" id="astructnet__cfg_html_a63cde667c15df0743427416708b7a45c"><div class="ttname"><a href="../../da/df5/structnet__cfg.html#a63cde667c15df0743427416708b7a45c">net_cfg::net_file</a></div><div class="ttdeci">IN const char * net_file</div><div class="ttdef"><b>Definition:</b> nnctrl.h:140</div></div>
<div class="ttc" id="astructnet__dvi__cfg_html"><div class="ttname"><a href="../../d2/ded/structnet__dvi__cfg.html">net_dvi_cfg</a></div><div class="ttdoc">One of dvi configuration in network.</div><div class="ttdef"><b>Definition:</b> nnctrl.h:479</div></div>
<div class="ttc" id="astructnet__hw__affinity_html"><div class="ttname"><a href="../../df/da8/structnet__hw__affinity.html">net_hw_affinity</a></div><div class="ttdef"><b>Definition:</b> nnctrl.h:532</div></div>
<div class="ttc" id="astructnet__input__mfd__cfg_html"><div class="ttname"><a href="../../d3/d35/structnet__input__mfd__cfg.html">net_input_mfd_cfg</a></div><div class="ttdoc">Total input in network with memory fd.</div><div class="ttdef"><b>Definition:</b> nnctrl.h:415</div></div>
<div class="ttc" id="astructnet__input__mfd__cfg_html_a88b08f224c035fa5cae2217e6d67afda"><div class="ttname"><a href="../../d3/d35/structnet__input__mfd__cfg.html#a88b08f224c035fa5cae2217e6d67afda">net_input_mfd_cfg::in_num</a></div><div class="ttdeci">INOUT uint32_t in_num</div><div class="ttdef"><b>Definition:</b> nnctrl.h:416</div></div>
<div class="ttc" id="astructnet__input__mfd__cfg_html_a970ffd726a8ea53666e13f14b87a0793"><div class="ttname"><a href="../../d3/d35/structnet__input__mfd__cfg.html#a970ffd726a8ea53666e13f14b87a0793">net_input_mfd_cfg::in_desc</a></div><div class="ttdeci">struct input_mfd_desc in_desc[MAX_IO_NUM]</div><div class="ttdef"><b>Definition:</b> nnctrl.h:418</div></div>
<div class="ttc" id="astructnet__output__mfd__cfg_html"><div class="ttname"><a href="../../d8/d85/structnet__output__mfd__cfg.html">net_output_mfd_cfg</a></div><div class="ttdoc">Total output in network with memory fd.</div><div class="ttdef"><b>Definition:</b> nnctrl.h:437</div></div>
<div class="ttc" id="astructnet__output__mfd__cfg_html_a17afdb10821678afccc3bec8d83e1625"><div class="ttname"><a href="../../d8/d85/structnet__output__mfd__cfg.html#a17afdb10821678afccc3bec8d83e1625">net_output_mfd_cfg::out_num</a></div><div class="ttdeci">INOUT uint32_t out_num</div><div class="ttdef"><b>Definition:</b> nnctrl.h:438</div></div>
<div class="ttc" id="astructnet__output__mfd__cfg_html_a6c1340e32999ab4bd6631259c980a51f"><div class="ttname"><a href="../../d8/d85/structnet__output__mfd__cfg.html#a6c1340e32999ab4bd6631259c980a51f">net_output_mfd_cfg::out_desc</a></div><div class="ttdeci">struct output_mfd_desc out_desc[MAX_IO_NUM]</div><div class="ttdef"><b>Definition:</b> nnctrl.h:440</div></div>
<div class="ttc" id="astructnet__result_html"><div class="ttname"><a href="../../d8/df3/structnet__result.html">net_result</a></div><div class="ttdoc">The result information after network done.</div><div class="ttdef"><b>Definition:</b> nnctrl.h:542</div></div>
<div class="ttc" id="astructnet__run__cfg_html"><div class="ttname"><a href="../../d3/deb/structnet__run__cfg.html">net_run_cfg</a></div><div class="ttdoc">Run-time change network configuration.</div><div class="ttdef"><b>Definition:</b> nnctrl.h:509</div></div>
<div class="ttc" id="astructnnctrl__version_html"><div class="ttname"><a href="../../d1/d44/structnnctrl__version.html">nnctrl_version</a></div><div class="ttdoc">The version of nnctrl library.</div><div class="ttdef"><b>Definition:</b> nnctrl.h:54</div></div>
<div class="ttc" id="astructnnctrl__version_html_a0131a40dc6588ef6cad4531e95172584"><div class="ttname"><a href="../../d1/d44/structnnctrl__version.html#a0131a40dc6588ef6cad4531e95172584">nnctrl_version::mod_time</a></div><div class="ttdeci">unsigned int mod_time</div><div class="ttdef"><b>Definition:</b> nnctrl.h:60</div></div>
<div class="ttc" id="astructnnctrl__version_html_a499cd1589d0fa6e6e8a639090024c652"><div class="ttname"><a href="../../d1/d44/structnnctrl__version.html#a499cd1589d0fa6e6e8a639090024c652">nnctrl_version::cavalry_compat</a></div><div class="ttdeci">uint32_t cavalry_compat</div><div class="ttdef"><b>Definition:</b> nnctrl.h:59</div></div>
<div class="ttc" id="astructnnctrl__version_html_a6572b29c16030fbdca67e71f3c8c0233"><div class="ttname"><a href="../../d1/d44/structnnctrl__version.html#a6572b29c16030fbdca67e71f3c8c0233">nnctrl_version::cavalry_parser</a></div><div class="ttdeci">uint32_t cavalry_parser</div><div class="ttdef"><b>Definition:</b> nnctrl.h:58</div></div>
<div class="ttc" id="astructnnctrl__version_html_a69405a866dc8c7f6b24012fbaa0591f8"><div class="ttname"><a href="../../d1/d44/structnnctrl__version.html#a69405a866dc8c7f6b24012fbaa0591f8">nnctrl_version::patch</a></div><div class="ttdeci">uint32_t patch</div><div class="ttdef"><b>Definition:</b> nnctrl.h:57</div></div>
<div class="ttc" id="astructnnctrl__version_html_a7feeb248b9f5c0a309c4ec51a3ec57da"><div class="ttname"><a href="../../d1/d44/structnnctrl__version.html#a7feeb248b9f5c0a309c4ec51a3ec57da">nnctrl_version::minor</a></div><div class="ttdeci">uint32_t minor</div><div class="ttdef"><b>Definition:</b> nnctrl.h:56</div></div>
<div class="ttc" id="astructnnctrl__version_html_ac48a22b1e5a1a1c27eeef05e54529e79"><div class="ttname"><a href="../../d1/d44/structnnctrl__version.html#ac48a22b1e5a1a1c27eeef05e54529e79">nnctrl_version::description</a></div><div class="ttdeci">char description[64]</div><div class="ttdef"><b>Definition:</b> nnctrl.h:61</div></div>
<div class="ttc" id="astructnnctrl__version_html_acaa8a60018b724301b0de7b13fa449d1"><div class="ttname"><a href="../../d1/d44/structnnctrl__version.html#acaa8a60018b724301b0de7b13fa449d1">nnctrl_version::major</a></div><div class="ttdeci">uint32_t major</div><div class="ttdef"><b>Definition:</b> nnctrl.h:55</div></div>
<div class="ttc" id="astructoutput__mfd__desc_html_a05b251f6f4721e4b738a9439a7eda472"><div class="ttname"><a href="../../d7/d3f/structoutput__mfd__desc.html#a05b251f6f4721e4b738a9439a7eda472">output_mfd_desc::no_mem</a></div><div class="ttdeci">IN uint32_t no_mem</div><div class="ttdef"><b>Definition:</b> nnctrl.h:380</div></div>
<div class="ttc" id="astructoutput__mfd__desc_html_a32bea48d7aa93b31ae10943c1ba552ec"><div class="ttname"><a href="../../d7/d3f/structoutput__mfd__desc.html#a32bea48d7aa93b31ae10943c1ba552ec">output_mfd_desc::dim</a></div><div class="ttdeci">OUT struct io_dim dim</div><div class="ttdef"><b>Definition:</b> nnctrl.h:390</div></div>
<div class="ttc" id="astructoutput__mfd__desc_html_a333fd20f0a0fe19d88d0a2ad740e9003"><div class="ttname"><a href="../../d7/d3f/structoutput__mfd__desc.html#a333fd20f0a0fe19d88d0a2ad740e9003">output_mfd_desc::data_fmt</a></div><div class="ttdeci">OUT struct io_data_fmt data_fmt</div><div class="ttdef"><b>Definition:</b> nnctrl.h:391</div></div>
<div class="ttc" id="astructoutput__mfd__desc_html_a526e36643f6467051f6e6ba512bcf963"><div class="ttname"><a href="../../d7/d3f/structoutput__mfd__desc.html#a526e36643f6467051f6e6ba512bcf963">output_mfd_desc::fd_offset</a></div><div class="ttdeci">INOUT unsigned long fd_offset</div><div class="ttdef"><b>Definition:</b> nnctrl.h:375</div></div>
<div class="ttc" id="astructoutput__mfd__desc_html_a532e610b0794e9d695c04dee8b22162f"><div class="ttname"><a href="../../d7/d3f/structoutput__mfd__desc.html#a532e610b0794e9d695c04dee8b22162f">output_mfd_desc::virt</a></div><div class="ttdeci">INOUT uint8_t * virt</div><div class="ttdef"><b>Definition:</b> nnctrl.h:373</div></div>
<div class="ttc" id="astructoutput__mfd__desc_html_a8b1c668d1a96dde72c36f17898ae9e51"><div class="ttname"><a href="../../d7/d3f/structoutput__mfd__desc.html#a8b1c668d1a96dde72c36f17898ae9e51">output_mfd_desc::name</a></div><div class="ttdeci">INOUT const char * name</div><div class="ttdef"><b>Definition:</b> nnctrl.h:371</div></div>
<div class="ttc" id="astructoutput__mfd__desc_html_a8df7d51bc3df84df92cf0b247af8d909"><div class="ttname"><a href="../../d7/d3f/structoutput__mfd__desc.html#a8df7d51bc3df84df92cf0b247af8d909">output_mfd_desc::rotate_flip_bitmap</a></div><div class="ttdeci">IN uint32_t rotate_flip_bitmap</div><div class="ttdef"><b>Definition:</b> nnctrl.h:382</div></div>
<div class="ttc" id="astructoutput__mfd__desc_html_abdb7d98eb79205cdc90022a4c4b75d16"><div class="ttname"><a href="../../d7/d3f/structoutput__mfd__desc.html#abdb7d98eb79205cdc90022a4c4b75d16">output_mfd_desc::update_pitch</a></div><div class="ttdeci">IN unsigned long update_pitch</div><div class="ttdef"><b>Definition:</b> nnctrl.h:386</div></div>
<div class="ttc" id="astructoutput__mfd__desc_html_abe4e3181b6f9f9243f03829322d3e235"><div class="ttname"><a href="../../d7/d3f/structoutput__mfd__desc.html#abe4e3181b6f9f9243f03829322d3e235">output_mfd_desc::size</a></div><div class="ttdeci">OUT unsigned long size</div><div class="ttdef"><b>Definition:</b> nnctrl.h:374</div></div>
<div class="ttc" id="astructoutput__mfd__desc_html_afbc217e9e58aab57dacc70a1f54d938f"><div class="ttname"><a href="../../d7/d3f/structoutput__mfd__desc.html#afbc217e9e58aab57dacc70a1f54d938f">output_mfd_desc::mem_fd</a></div><div class="ttdeci">INOUT int mem_fd</div><div class="ttdef"><b>Definition:</b> nnctrl.h:377</div></div>
<div class="ttc" id="atest__decode_8h_html_ab5fefa6fc4abffdc4b912255ea537aae"><div class="ttname"><a href="../../../video/d0/d7d/test__decode_8h.html#ab5fefa6fc4abffdc4b912255ea537aae">numeric_short_options</a></div><div class="ttdeci">numeric_short_options</div></div>
<div class="ttc" id="atest__fb_8h_html_a2d0022791143e08a64621257f48d9739"><div class="ttname"><a href="../../../video/d3/d6c/test__fb_8h.html#a2d0022791143e08a64621257f48d9739">NO_ARG</a></div><div class="ttdeci">#define NO_ARG</div></div>
<div class="ttc" id="atest__fb_8h_html_affec572f11fcba59ce0cd49cbcd0110f"><div class="ttname"><a href="../../../video/d3/d6c/test__fb_8h.html#affec572f11fcba59ce0cd49cbcd0110f">HAS_ARG</a></div><div class="ttdeci">#define HAS_ARG</div></div>
<div class="ttc" id="atest__smartfb_8c_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="../../dc/d60/test__smartfb_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> test_smartfb.c:1009</div></div>
<div class="ttc" id="atest__smartfb_8c_html_ad96d407a911fbb914fa8e4cfbf2faf0f"><div class="ttname"><a href="../../dc/d60/test__smartfb_8c.html#ad96d407a911fbb914fa8e4cfbf2faf0f">usage</a></div><div class="ttdeci">static void usage(void)</div><div class="ttdef"><b>Definition:</b> test_smartfb.c:161</div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
