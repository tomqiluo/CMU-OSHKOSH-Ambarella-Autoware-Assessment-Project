<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Video: OTHER - Debug Option</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Video"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-ambarella.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Ambarella.png"/></td>
  <td id="projectalign">
   <div id="projectname">Video<span id="projectnumber">&#160;Cooper_1.6.0 (CV72 &amp; CV3) @ 2024.07.10 14:12:44</span>
   </div>
   <div id="projectbrief">placeholder</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.html','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dd/d0d/fs_others_debug.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">OTHER - Debug Option </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="other_disp_cfg"></a>
1. Others:  Display Current Configuration</h1>
<h2><a class="anchor" id="example_other_disp_cfg1"></a>
Example 1: Chip</h2>
<div class="fragment"><div class="line">board# init.sh --na; modprobe imx274_mipi vinc_id=8 bus_id=3  <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# init.sh --na; modprobe imx274_mipi vinc_id=8)      <span class="comment">// For CV72</span></div>
<div class="line">board# test_aaa_service -a &amp;</div>
<div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua\       <span class="comment">// For CV5 or CV52</span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua</div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua\  <span class="comment">// For CV72</span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua)</div>
<div class="line">board# test_encode --show-chip-info</div>
</div><!-- fragment --><h2><a class="anchor" id="example_other_disp_cfg2"></a>
Example 2: Image Audio Video (IAV) Driver Version</h2>
<div class="fragment"><div class="line">board# init.sh --na; modprobe imx274_mipi vinc_id=8 bus_id=3  <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# init.sh --na; modprobe imx274_mipi vinc_id=8)      <span class="comment">// For CV72</span></div>
<div class="line">board# test_aaa_service -a &amp;</div>
<div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua\       <span class="comment">// For CV5 or CV52 </span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua</div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua\  <span class="comment">// For CV72</span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua)</div>
<div class="line">board# test_encode --show-driver-info</div>
</div><!-- fragment --><h2><a class="anchor" id="example_other_disp_cfg3"></a>
Example 3: Dynamic Random-Access Memory (DRAM) Layout Information</h2>
<div class="fragment"><div class="line">board# init.sh --na; modprobe imx274_mipi vinc_id=8 bus_id=3  <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# init.sh --na; modprobe imx274_mipi vinc_id=8)      <span class="comment">// For CV72</span></div>
<div class="line">board# test_aaa_service -a &amp;</div>
<div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua\       <span class="comment">// For CV5 or CV52 </span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua</div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua\  <span class="comment">// For CV72</span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua)</div>
<div class="line">board# test_encode --show-dram-layout</div>
</div><!-- fragment --><h2><a class="anchor" id="example_other_disp_cfg4"></a>
Example 4: Encoding Resource Configuration</h2>
<div class="fragment"><div class="line">board# init.sh --na; modprobe imx274_mipi vinc_id=8 bus_id=3  <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# init.sh --na; modprobe imx274_mipi vinc_id=8)      <span class="comment">// For CV72</span></div>
<div class="line">board# test_aaa_service -a &amp;</div>
<div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua\       <span class="comment">// For CV5 or CV52 </span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua</div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua\  <span class="comment">// For CV72</span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua)</div>
<div class="line">board# test_encode --show-resource-info</div>
</div><!-- fragment --><h2><a class="anchor" id="example_other_disp_cfg5"></a>
Example 5: Channel, Canvas, and Stream Resource Configuration</h2>
<div class="fragment"><div class="line">board# init.sh --na; modprobe imx274_mipi vinc_id=8 bus_id=3  <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# init.sh --na; modprobe imx274_mipi vinc_id=8)      <span class="comment">// For CV72</span></div>
<div class="line">board# test_aaa_service -a &amp;</div>
<div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua\       <span class="comment">// For CV5 or CV52 </span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua</div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua\  <span class="comment">// For CV72</span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua)</div>
<div class="line">board# test_encode --show-resource-cfg</div>
</div><!-- fragment --><h2><a class="anchor" id="example_other_disp_cfg6"></a>
Example 6: Encode Configuration</h2>
<div class="fragment"><div class="line">board# init.sh --na; modprobe imx274_mipi vinc_id=8 bus_id=3  <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# init.sh --na; modprobe imx274_mipi vinc_id=8)      <span class="comment">// For CV72</span></div>
<div class="line">board# test_aaa_service -a &amp;</div>
<div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua\       <span class="comment">// For CV5 or CV52 </span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua</div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua\  <span class="comment">// For CV72</span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua)</div>
<div class="line">board# test_encode -A -H1080p -b0 -e</div>
<div class="line">board# test_encode --show-encode-config</div>
</div><!-- fragment --><h2><a class="anchor" id="example_other_disp_cfg7"></a>
Example 7: Stream Configuration</h2>
<div class="fragment"><div class="line">board# init.sh --na; modprobe imx274_mipi vinc_id=8 bus_id=3  <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# init.sh --na; modprobe imx274_mipi vinc_id=8)      <span class="comment">// For CV72</span></div>
<div class="line">board# test_aaa_service -a &amp;</div>
<div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua\       <span class="comment">// For CV5 or CV52 </span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua</div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua\  <span class="comment">// For CV72</span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua)</div>
<div class="line">board# test_encode -A -H1080p -b0 -e</div>
<div class="line">board# test_encode --show-stream-info</div>
</div><!-- fragment --><h2><a class="anchor" id="example_other_disp_cfg8"></a>
Example 8: Canvas State</h2>
<div class="fragment"><div class="line">board# init.sh --na; modprobe imx274_mipi vinc_id=8 bus_id=3  <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# init.sh --na; modprobe imx274_mipi vinc_id=8)      <span class="comment">// For CV72</span></div>
<div class="line">board# test_aaa_service -a &amp;</div>
<div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua\       <span class="comment">// For CV5 or CV52 </span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua</div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua\  <span class="comment">// For CV72</span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua)</div>
<div class="line">board# test_encode -A -H1080p -b0 -e</div>
<div class="line">board# test_encode --show-canvas-state</div>
</div><!-- fragment --><h2><a class="anchor" id="example_other_disp_cfg9"></a>
Example 9: All Information</h2>
<div class="fragment"><div class="line">board# init.sh --na; modprobe imx274_mipi vinc_id=8 bus_id=3  <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# init.sh --na; modprobe imx274_mipi vinc_id=8)      <span class="comment">// For CV72</span></div>
<div class="line">board# test_aaa_service -a &amp;</div>
<div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua\       <span class="comment">// For CV5 or CV52 </span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua</div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua\  <span class="comment">// For CV72</span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua)</div>
<div class="line">board# test_encode --show-all-info</div>
</div><!-- fragment --><h2><a class="anchor" id="example_other_disp_cfg10"></a>
Example 10: Supported Feature Set</h2>
<div class="fragment"><div class="line">board# init.sh --na; modprobe imx274_mipi vinc_id=8 bus_id=3  <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# init.sh --na; modprobe imx274_mipi vinc_id=8)      <span class="comment">// For CV72</span></div>
<div class="line">board# test_aaa_service -a &amp;</div>
<div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua\       <span class="comment">// For CV5 or CV52 </span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua</div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua\  <span class="comment">// For CV72</span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua)</div>
<div class="line">board# test_encode --show-feature-set</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="other_disp_lat"></a>
2. Others:  Display Pipeline Latency</h1>
<h2><a class="anchor" id="example_other_disp_lat"></a>
Example 11: Pipeline Latency from Capture to Encode</h2>
<div class="fragment"><div class="line">board# init.sh --na; modprobe imx274_mipi vinc_id=8 bus_id=3  <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# init.sh --na; modprobe imx274_mipi vinc_id=8)      <span class="comment">// For CV72</span></div>
<div class="line">board# test_aaa_service -a &amp;</div>
<div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua\       <span class="comment">// For CV5 or CV52 </span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua</div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua\  <span class="comment">// For CV72 </span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua)</div>
<div class="line">board# test_stream --nofile -v &amp;</div>
<div class="line">board# test_encode -A -h 1080p -e</div>
<div class="line"> </div>
<div class="line">(message printed by test_stream)</div>
<div class="line">stream A:       125910 frames, 30 fps,         4170898261       bytes,  7678 kbps</div>
<div class="line">type=1, is_skipped 0, size=160199, addr=0x1209728, strm_id=0, sesn_id=486509669, frame_num=60, monotonic_pts=8684650, mono_diff=3004, enc_done_pts = 8688618, enc_pipe_time = 3968, reso=1920x1080, slice_header_offset = 98</div>
<div class="line">type=3, is_skipped 0, size=4929, addr=0x1369984, strm_id=0, sesn_id=486509669, frame_num=61, monotonic_pts=8687651, mono_diff=3001, enc_done_pts = 8691529, enc_pipe_time = 3878, reso=1920x1080, slice_header_offset = 18</div>
<div class="line">type=3, is_skipped 0, size=25719, addr=0x1374976, strm_id=0, sesn_id=486509669, frame_num=62, monotonic_pts=8690651, mono_diff=3000, enc_done_pts = 8691575, enc_pipe_time = 924, reso=1920x1080, slice_header_offset = 18</div>
</div><!-- fragment --> <dl class="section see"><dt>See also</dt><dd><a class="el" href="../../dc/d27/fs_adv_pl_latency.html">ADVANCED - Pipeline Latency</a></dd></dl>
<hr  />
<h1><a class="anchor" id="mmb_function"></a>
3. Others: Debug Anonymous MMB</h1>
<p >This function is used to debug the anonymous MMB auto-recycling feature. It can help simulate customers using an anonymous MMB in multiple-thread or multiple-process cases.</p>
<h2><a class="anchor" id="example1_mmb_function"></a>
Example 16: Anonymous MMB Used in Father-and-Child Processes with the Same FD</h2>
<div class="fragment"><div class="line">board# test_mempart -a -s 0x1000 -t 0x33</div>
<div class="line">(message printed)</div>
<div class="line">Anonymous MMB test mode map: 0x33.</div>
<div class="line">anonymous mem_part[5119] has been allocated successfully.</div>
<div class="line">        Base Address: [0xA0081000], Size [       4 KB].</div>
<div class="line">global iav fd 3</div>
<div class="line">start to fork child process</div>
<div class="line">MMB[5119]: Got <span class="keyword">virtual</span> addr 0xa0081000, size 4096</div>
<div class="line">Main process not quit</div>
<div class="line">MMB[5119]: Got <span class="keyword">virtual</span> addr 0xa0081000, size 4096</div>
<div class="line">Child process not quit</div>
<div class="line">board#(another consle) cat /proc/ambarella/cma  <span class="comment">//check the MMB using state</span></div>
<div class="line">(message printed)</div>
<div class="line">ANONYMOUS_MMB    pid    ref_cnt    user_name</div>
<div class="line">buf_id: 5119</div>
<div class="line">|-               357    2          test_mempart</div>
</div><!-- fragment --><h2><a class="anchor" id="example2_mmb_function"></a>
Example 17: Anonymous MMB Used in Father-and-Child Processes with Different FD</h2>
<div class="fragment"><div class="line">board# test_mempart -a -s 0x1000 -t 0x77</div>
<div class="line">(message printed)</div>
<div class="line">Anonymous MMB test mode map: 0x77.</div>
<div class="line">anonymous mem_part[4351] has been allocated successfully.</div>
<div class="line">        Base Address: [0xA0081000], Size [       4 KB].</div>
<div class="line">global iav fd 3</div>
<div class="line">start to fork child process</div>
<div class="line">Main process create fd 4</div>
<div class="line">MMB[4351]: Got <span class="keyword">virtual</span> addr 0xa0081000, size 4096</div>
<div class="line">Main process not quit</div>
<div class="line">Child process create fd 4</div>
<div class="line">MMB[4351]: Got <span class="keyword">virtual</span> addr 0xa0081000, size 4096</div>
<div class="line">Child process not quit</div>
<div class="line">board#(another consle) cat /proc/ambarella/cma  <span class="comment">//check the MMB using state</span></div>
<div class="line">(message printed)</div>
<div class="line">ANONYMOUS_MMB    pid    ref_cnt    user_name</div>
<div class="line">buf_id: 4351</div>
<div class="line">|-               309    0          test_mempart</div>
<div class="line">|-               309    1          test_mempart</div>
<div class="line">|-               310    1          test_mempart</div>
</div><!-- fragment --><h2><a class="anchor" id="example3_mmb_function"></a>
Example 18: Anonymous MMB Used in Multiple Independent Processes</h2>
<div class="fragment"><div class="line">board#(console A) test_mempart -a -s 0x1000 -t 0x3</div>
<div class="line">(message printed)</div>
<div class="line">Anonymous MMB test mode map: 0x3.</div>
<div class="line">anonymous mem_part[5119] has been allocated successfully.</div>
<div class="line">        Base Address: [0xA0081000], Size [       4 <a class="code hl_defineRef" href="../../../driver/d6/d56/iav__utils_8h.html#a1841fd1a462d245d8c73dce55e2f45da">KB</a>].</div>
<div class="line">global iav fd 3</div>
<div class="line">MMB[5119]: Got <span class="keyword">virtual</span> addr 0xa0081000, size 4096</div>
<div class="line">Main process not quit</div>
<div class="line">board#(console B) test_mempart -m 5119 --test_mode 0x3</div>
<div class="line">(message printed)</div>
<div class="line">Anonymous MMB test mode map: 0x3.</div>
<div class="line">global iav fd 3</div>
<div class="line">MMB[5119]:No map size specified, map total mmb. Size 4096.</div>
<div class="line">MMB[5119]: Got <span class="keyword">virtual</span> addr 0xa0081000, size 4096</div>
<div class="line">Main process not quit</div>
<div class="line">board#(console C) cat /proc/ambarella/cma  <span class="comment">//check the MMB using state</span></div>
<div class="line">(message printed)</div>
<div class="line">ANONYMOUS_MMB    pid    ref_cnt    user_name</div>
<div class="line">buf_id: 5119</div>
<div class="line">|-               348    1          test_mempart</div>
<div class="line">|-               349    1          test_mempart</div>
<div class="line">board#(console C) kill 348 <span class="comment">//kill test_mempart in console A</span></div>
<div class="line">board#(console C) cat /proc/ambarella/cma  <span class="comment">//check the MMB using state</span></div>
<div class="line">(message printed)</div>
<div class="line">ANONYMOUS_MMB    pid    ref_cnt    user_name</div>
<div class="line">buf_id: 5119</div>
<div class="line">|-               349    1          test_mempart</div>
<div class="ttc" id="aiav__utils_8h_html_a1841fd1a462d245d8c73dce55e2f45da"><div class="ttname"><a href="../../../driver/d6/d56/iav__utils_8h.html#a1841fd1a462d245d8c73dce55e2f45da">KB</a></div><div class="ttdeci">#define KB</div></div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="perf_function"></a>
4. Others: Debug Performance</h1>
<p >This chapter demonstrates options related to digital signal processor (DSP) performance. These options can aid the device in achieving improved performance under specific conditions.</p>
<h2><a class="anchor" id="example1_perf_function"></a>
Example 19: Enable Optimal DSP Performance Mode</h2>
<p >This feature improves CV5x DSP performance as a debug option; it is used only for multiple-video input (VIN) / multiple-channel scenarios, and is not applicable for single-channel cases. Extra DSP resources may be required to support this option.</p>
<dl class="section note"><dt>Note</dt><dd>The following are three items for channel configuration that must be the same across all channels. <a class="anchor" id="table_channel_item"></a>
<table class="doxtable">
<caption>Table 5-1. Channel Configurations.</caption>
<tr>
<th>Item </th><th><b>Description</b> </th></tr>
<tr>
<td>rotate_cw </td><td>Enable 90-degree clockwise rotation. </td></tr>
<tr>
<td>expo_num </td><td>Specify the digital overlap high dynamic range (DOL-HDR) exposure frame number. </td></tr>
<tr>
<td>vcap_mode_flags </td><td>Fixed Value: 0x00, advanced ISO mode. This is the mode for lowest latency from VIN to video output (VOUT). </td></tr>
</table>
</dd></dl>
<p>Use the option <code>--debug-perf-opt-enable</code> to enable optimal DSP performance mode. The example below encodes 20 streams from four channels. </p><div class="fragment"><div class="line">  board# init.sh --na; modprobe imx274_mipi vinc_id=0x40b8</div>
<div class="line">  board# test_aaa_service -a&amp;</div>
<div class="line">  board# test_encode --debug-perf-opt-enable 1 --resource-cfg cv5_four_chan_2xhdr_20stream_dsp_opt_perf_mode.lua --enc-mode 0</div>
<div class="line">  (message printed)</div>
<div class="line">  &gt;&gt;&gt; AAA prepare done.</div>
<div class="line">  init 3A done</div>
<div class="line">  loop start now</div>
<div class="line">  [Amage] launch_amage_server!!!</div>
<div class="line">  &gt;&gt;&gt; Amage server start done.</div>
<div class="line">  &gt;&gt;&gt; AAA start done.</div>
<div class="line">  enable preview done</div>
<div class="line">  board# test_encode -S 0 -h 2160x3840 -b 0</div>
<div class="line">  board# test_encode -S 1 -h 608x800 -b 1</div>
<div class="line">  board# test_encode -S 2 -h 2160x3840 --frame-factor 1/30 -b 0</div>
<div class="line">  board# test_encode -S 3 -h 1088x1920 -b 2</div>
<div class="line">  board# test_encode -S 4 -m 720x1280 -b 3</div>
<div class="line">  board# test_encode -S 5 -h 2160x3840 -b 4</div>
<div class="line">  board# test_encode -S 6 -h 608x800 -b 5</div>
<div class="line">  board# test_encode -S 7 -h 2160x3840 --frame-factor 1/30 -b 4</div>
<div class="line">  board# test_encode -S 8 -h 1088x1920 -b 6</div>
<div class="line">  board# test_encode -S 9 -m 720x1280 -b 7</div>
<div class="line">  board# test_encode -S 10 -h 2160x3840 -b 8</div>
<div class="line">  board# test_encode -S 11 -h 608x800 -b 9</div>
<div class="line">  board# test_encode -S 12 -h 2160x3840 --frame-factor 1/30 -b 8</div>
<div class="line">  board# test_encode -S 13 -h 1088x1920 -b 10</div>
<div class="line">  board# test_encode -S 14 -m 720x1280 -b 11</div>
<div class="line">  board# test_encode -S 15 -h 2160x3840 -b 12</div>
<div class="line">  board# test_encode -S 16 -h 608x800 -b 13</div>
<div class="line">  board# test_encode -S 17 -h 2160x3840 --frame-factor 1/30 -b 12</div>
<div class="line">  board# test_encode -S 18 -h 1088x1920 -b 14</div>
<div class="line">  board# test_encode -S 19 -m 720x1280 -b 15</div>
<div class="line">  board# test_encode --start-multi 0~19</div>
<div class="line">Start encoding <span class="keywordflow">for</span> stream 0xfffff successfully</div>
</div><!-- fragment --><p >For details, refer to <a href="../../script/cv5_four_chan_2xhdr_20stream_dsp_opt_perf_mode.lua" target="_blank"><b>cv5_four_chan_2xhdr_20stream_dsp_opt_perf_mode.lua</b></a>.</p>
<h2><a class="anchor" id="example1_hevc_mode"></a>
Example 20: Set HEVC Encode Mode</h2>
<p >This feature supports two high-efficiency video coding (HEVC) encode modes, 0: default, 1: good quality. The default is 0. Use <code>--debug-hevc-enc-mode</code> option to specify the HEVC encode mode. </p><div class="fragment"><div class="line">board# init.sh --na; modprobe imx274_mipi vinc_id=8 bus_id=3  <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# init.sh --na; modprobe imx274_mipi vinc_id=8)      <span class="comment">// For CV72</span></div>
<div class="line">board# test_aaa_service -a &amp;</div>
<div class="line">board# test_encode --debug-hevc-enc-mode 1 --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua        <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# test_encode --debug-hevc-enc-mode 1 --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua)  <span class="comment">// For CV72</span></div>
<div class="line">board# test_encode -S 0 -H 1920x1080 -<a class="code hl_variableRef" href="../../../library/d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a> 0 -e</div>
<div class="line">1920x1080 resolution is 1920x1080</div>
<div class="line">Start encoding <span class="keywordflow">for</span> stream 0x1 successfully</div>
<div class="ttc" id="acJSON_8h_html_a1a175e87536301df98c805ac0636ad7c"><div class="ttname"><a href="../../../library/d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a></div><div class="ttdeci">const cJSON *const b</div></div>
</div><!-- fragment --><h2><a class="anchor" id="example_aaa_overlay"></a>
Example 21: AAA Statistics Display on Stream</h2>
<p >AAA statistics can be displayed on stream in real-time, on-screen display (OSD) of the per-frame shows AAA statistics of this frame, including shutter and gain, so the user can debug the image quality via this feature. The picture below shows the AAA statistics overlay.</p>
<div class="image">
<img src="../../AAA_statis_debug_overlay.png" alt=""/>
<div class="caption">
Figure 4-1. AAA Statistics Display on Stream.</div></div>
<p> Here is an example of how to use it. </p><div class="fragment"><div class="line">(terminal 1)</div>
<div class="line">board# init.sh --na; modprobe imx274_mipi vinc_id=8 bus_id=3  <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# init.sh --na; modprobe imx274_mipi vinc_id=8)      <span class="comment">// For CV72</span></div>
<div class="line">board# test_aaa_service -a -s&amp;</div>
<div class="line">board# test_encode --resource-cfg /usr/local/bin/scripts/cv5_vin0_4k_linear.lua  --vout-cfg /usr/local/bin/scripts/vout_hdmi.lua</div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_4k_linear.lua --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua)  <span class="comment">// For CV72</span></div>
<div class="line">board# test_encode -A -<a class="code hl_variableRef" href="../../../library/d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a> 0 -h 3840x2160 -e</div>
<div class="line">board# rtsp_server &amp;</div>
<div class="line">(terminal 2)</div>
<div class="line">board# test_textinsert --aaa-display</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
