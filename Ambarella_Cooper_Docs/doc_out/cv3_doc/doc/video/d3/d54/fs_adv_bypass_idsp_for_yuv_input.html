<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Video: ADVANCED - Bypass IDSP for YUV Input</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Video"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-ambarella.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Ambarella.png"/></td>
  <td id="projectalign">
   <div id="projectname">Video<span id="projectnumber">&#160;Cooper_1.6.0 (CV72 &amp; CV3) @ 2024.07.10 14:12:44</span>
   </div>
   <div id="projectbrief">placeholder</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.html','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d3/d54/fs_adv_bypass_idsp_for_yuv_input.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">ADVANCED - Bypass IDSP for YUV Input </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="section_bypass_idsp_for_yuv_input"></a>
1. Bypass IDSP for YUV Input</h1>
<p >This feature is designed to support encoding directly from YUV, so that the YUV sensor bypasses the image digital signal processor (IDSP). The user configures the YUV sensor to output YUV data rather than RAW data. Bypassing the IDSP in order to encode from YUV is supported in these cases. Encoding from YUV directly conserves IDSP performance for the real video input (VIN).</p>
<h2><a class="anchor" id="example_bypass_idsp_for_yuv_input"></a>
Example 1: IDSP Bypass Configurations</h2>
<p >Bypassing the IDSP means that the encoder will query data from the YUV buffer, requiring the channel to work in "VIN-only" mode.</p>
<p >Both options <code>vcap_mode_flags = 0x7f</code> and <code>idsp_bypass_enable = 1</code> in the channel configuration will set up the "VIN-only" mode pipeline for the IDSP bypass channel.</p>
<p >With VIN-only mode, only one buffer can be set for the channel. Typically, it's the main buffer. The configuration example below shows that video source (VSRC) 0 is used for the YUV input source and is bound to channel 0.</p>
<div class="fragment"><div class="line">vsrc_0 = {</div>
<div class="line">    vsrc_id = 0,</div>
<div class="line">    mode = <span class="stringliteral">&quot;0&quot;</span>,</div>
<div class="line">    <a class="code hl_variable" href="../../d4/daa/vin__init_8c.html#a9586a0cc85ebac1f283fc9f2d94c82e2">hdr_mode</a> = <span class="stringliteral">&quot;linear&quot;</span>, -- options: <span class="stringliteral">&quot;linear&quot;</span>, <span class="stringliteral">&quot;2x&quot;</span> or <span class="stringliteral">&quot;3x&quot;</span></div>
<div class="line">    fps = 15,</div>
<div class="line">    <a class="code hl_variable" href="../../d4/daa/vin__init_8c.html#ad1e28a1a66a25529b0b61b9ca4e66d44">bits</a>= 0,</div>
<div class="line">}</div>
<div class="line">chan_0 = {</div>
<div class="line">    <span class="keywordtype">id</span>= 1,</div>
<div class="line">    vsrc = vsrc_0,</div>
<div class="line">    vcap_mode_flags = 0x7f,</div>
<div class="line">    idsp_bypass_enable = 1,</div>
<div class="line">    .......</div>
<div class="line">    <a class="code hl_function" href="../../db/d1a/test__vout__cfg_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> = {</div>
<div class="line">        max_output = {0, 0},</div>
<div class="line">        input = {0, 0, 0, 0},</div>
<div class="line">        output = {0, 0, 1920, 1536},</div>
<div class="line">    },</div>
<div class="line">}</div>
<div class="line">_resource_config_ = {</div>
<div class="line">    canvas = {</div>
<div class="line">        {</div>
<div class="line">           type = <span class="stringliteral">&quot;encode&quot;</span>,</div>
<div class="line">           <a class="code hl_variable" href="../../d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> = {<span class="stringliteral">&quot;chan_0.main&quot;</span>,},</div>
<div class="line">        },</div>
<div class="line">    }</div>
<div class="ttc" id="atest__vout__cfg_8c_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="../../db/d1a/test__vout__cfg_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> test_vout_cfg.c:85</div></div>
<div class="ttc" id="avin__init_8c_html_a07a87b2e6ed927503e2f95f119c9fc23"><div class="ttname"><a href="../../d4/daa/vin__init_8c.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a></div><div class="ttdeci">int source</div><div class="ttdef"><b>Definition:</b> vin_init.c:57</div></div>
<div class="ttc" id="avin__init_8c_html_a9586a0cc85ebac1f283fc9f2d94c82e2"><div class="ttname"><a href="../../d4/daa/vin__init_8c.html#a9586a0cc85ebac1f283fc9f2d94c82e2">hdr_mode</a></div><div class="ttdeci">int hdr_mode</div><div class="ttdef"><b>Definition:</b> vin_init.c:61</div></div>
<div class="ttc" id="avin__init_8c_html_ad1e28a1a66a25529b0b61b9ca4e66d44"><div class="ttname"><a href="../../d4/daa/vin__init_8c.html#ad1e28a1a66a25529b0b61b9ca4e66d44">bits</a></div><div class="ttdeci">int bits</div><div class="ttdef"><b>Definition:</b> vin_init.c:63</div></div>
</div><!-- fragment --><p >Different YUV sensors may have different installation methods. For IDSP bypass channel, a restriction of encoding is here it needs to specify stream's GOP length to 1. The example below demonstrates using the X3J sensor as the YUV input with the following commands:</p>
<div class="fragment"><div class="line">board# init.sh --na</div>
<div class="line">board# modprobe max96712 <span class="keywordtype">id</span>=0x1 vinc_id=0 port_mode=1 mfp4_clk=1 poc_pwr_gpio=0 sen_rst_gpio=5 fsync_gpio=8 hsync_gpio=-1 gmsl_mode=3</div>
<div class="line">board# modprobe ambds_brg addr=0x10 mipi=1 yuv_mode=1 w=1920 h=1536 <a class="code hl_variable" href="../../d4/daa/vin__init_8c.html#ad1e28a1a66a25529b0b61b9ca4e66d44">bits</a>=8 yuv_pix_order=0 brg_id=0x1 fps=17066667 slave=1 clk=25000000</div>
<div class="line">board# test_aaa_service -a &amp;</div>
<div class="line">board# test_encode --resource-cfg encode_from_yuv.lua --chan-vcap-mode-enable 1</div>
<div class="line">board# test_encode -S0 -H 1920x1536 -<a class="code hl_variableRef" href="../../../library/d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a> 0 -N 1 -e</div>
<div class="ttc" id="acJSON_8h_html_a1a175e87536301df98c805ac0636ad7c"><div class="ttname"><a href="../../../library/d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a></div><div class="ttdeci">const cJSON *const b</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
