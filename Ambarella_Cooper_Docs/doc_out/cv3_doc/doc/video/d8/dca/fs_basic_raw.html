<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Video: BASIC - Raw</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Video"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-ambarella.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Ambarella.png"/></td>
  <td id="projectalign">
   <div id="projectname">Video<span id="projectnumber">&#160;Cooper_1.6.0 (CV72 &amp; CV3) @ 2024.07.10 14:12:44</span>
   </div>
   <div id="projectbrief">placeholder</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.html','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d8/dca/fs_basic_raw.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">BASIC - Raw </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="section_raw_features"></a>
1. Raw Features</h1>
<p >CV5x chips process raw data from VINs in the unit of channel, and support compressed / uncompressed and unpacking / uncompressed and packing raw data.</p>
<h2><a class="anchor" id="VIN_raw_size"></a>
1.1 Raw Size</h2>
<p >1 compressed raw (VIN is 1080p) </p><pre class="fragment"> data size = ROUND_UP((1920 x 27 / 32), 64) x 1080 = 1664 x 1080 = 1797120
</pre><p> 2 uncompressed and unpacking raw (VIN is 1080p) </p><pre class="fragment"> data size = ROUND_UP((1920 x 2), 64) x 1080 = 3840 x 1080 = 4147200
</pre><p> 3 uncompressed and packing raw (VIN is 1080p@12bit) </p><pre class="fragment"> data size = ROUND_UP((1920 x 12 / 16 * 2), 64) x 1080 = 2884 x 1080 = 3114720
</pre> <h2><a class="anchor" id="raw_buffer_manunal_feed"></a>
1.2 Raw Buffer Manual Feed</h2>
<p >Raw buffer is generated and reported to Arm by DSP, and is allocated and maintained using two different methods. In addition, it can be configured through "raw_manual_feed" and "raw_feed_frame_num" item of channel cfg in the Lua script.</p>
<ul>
<li>
<b>Raw buffer Auto-Generation Mode</b> </li>
<li>
<b>Raw buffer Manual-Feed Mode</b> </li>
</ul>
<p >In raw buffer auto-generation mode, DSP allocates and maintains the raw buffer. Each time DSP captures raw data, then it is automatically reported to Arm. In auto-generation mode, DSP will guarantee frame rate.<br  />
</p>
<p >In raw buffer manual-feed mode, frame queue is fully driven and controlled by user application. Each time a user application requests a raw buffer, it will trigger IAV driver feeds an empty buffer address to DSP. DSP fills raw data into the buffers, and then reports back to Arm.<br  />
</p>
<p >See also: <a class="el" href="../../db/de4/fs_basic_pyramid.html#pyramid_feed_mode">1.4 Pyramid Feed Mode</a></p>
<h2><a class="anchor" id="raw_slice_capture"></a>
1.3 Raw slice</h2>
<p >Raw slice buffer can be configured through <code>raw_slice_num</code> and <code>raw_slice_cached_items</code> item of channel config in the Lua script.</p>
<p >When this feature is enabled, DSP will slice RAW data vertically and evenly, so that IDSP can process the slice of RAW data one by one. Once the slice data is ready, DSP will report the slice data to ARM, and user application can capture the slice data of RAW.</p>
<p >For some special cases with large resolution, DSP will need more time to process one frame. If the RAW data can be sliced, users will obtain the RAW data processed by DSP earlier.</p>
<p >Currently, Cooper SDK has supported the different slice numbers, such as 2 / 4 / 6 / 8.</p>
<hr  />
<h1><a class="anchor" id="lua_raw_configuration"></a>
2. Raw Configuration</h1>
<p >Users can configure the VIN raw via Lua script. Here are the parameters for raw.<br  />
</p>
<a class="anchor" id="table_VIN_raw_lua"></a>
<table class="doxtable">
<caption></caption>
<tr>
<th>Item </th><th><div style="width:240px"><b>Parameter</b></div> </th><th>Description </th></tr>
<tr>
<td>mode </td><td>a x b </td><td>Specify the VIN resolution. </td></tr>
<tr>
<td><a class="anchor" id="anchor_bits"></a>bits </td><td>8: 8bits <br  />
 10: 10bits <br  />
 12: 12bits <br  />
 14: 14bits <br  />
 16: 16bits <br  />
 0: Default bits </td><td>Specify the VIN bits. </td></tr>
<tr>
<td><a class="anchor" id="anchor_raw_capture"></a>raw_capture </td><td>0: Raw compressed <br  />
 1: Raw uncompressed </td><td>Enable raw uncompressed. </td></tr>
<tr>
<td><a class="anchor" id="anchor_packing_mode_enable"></a>packing_mode_enable </td><td>0: Raw packing disabled <br  />
 1: Raw packing enabled </td><td>Enable Raw packing, only valid when raw_capture = 1. </td></tr>
</table>
<p ><b>An Example for VIN Raw Lua Configuration</b><br  />
</p>
<div class="fragment"><div class="line">vsrc_0 = {</div>
<div class="line">   vsrc_id = 0,</div>
<div class="line">   mode = <span class="stringliteral">&quot;1920x1080&quot;</span>,       -- VIN <a class="code hl_variableRef" href="../../../library/d1/d82/cJSON_8h.html#a788db922597cf2fb6389e278f822e59f">raw</a> resolution: 1920 <a class="code hl_variableRef" href="../../../driver/df/dc0/group__IAV.html#gaf80df1bdae91e5f76236e6ed1110825d">x</a> 1080</div>
<div class="line">   <a class="code hl_variable" href="../../d4/daa/vin__init_8c.html#a9586a0cc85ebac1f283fc9f2d94c82e2">hdr_mode</a> = <span class="stringliteral">&quot;linear&quot;</span>,</div>
<div class="line">   fps = 30,</div>
<div class="line">   <a class="code hl_variable" href="../../d4/daa/vin__init_8c.html#ad1e28a1a66a25529b0b61b9ca4e66d44">bits</a>= 12,       -- VIN <a class="code hl_variableRef" href="../../../library/d1/d82/cJSON_8h.html#a788db922597cf2fb6389e278f822e59f">raw</a> <a class="code hl_variable" href="../../d4/daa/vin__init_8c.html#ad1e28a1a66a25529b0b61b9ca4e66d44">bits</a>: 12 <a class="code hl_variable" href="../../d4/daa/vin__init_8c.html#ad1e28a1a66a25529b0b61b9ca4e66d44">bits</a></div>
<div class="line">},</div>
<div class="line"> </div>
<div class="line">chan_0 = {</div>
<div class="line">   ...</div>
<div class="line">   raw_capture = 1,     -- <a class="code hl_variableRef" href="../../../library/d1/d82/cJSON_8h.html#a788db922597cf2fb6389e278f822e59f">raw</a> uncompressed</div>
<div class="line">   packing_mode_enable = 1, -- <a class="code hl_variableRef" href="../../../library/d1/d82/cJSON_8h.html#a788db922597cf2fb6389e278f822e59f">raw</a> packing</div>
<div class="line">   ...</div>
<div class="line">},</div>
<div class="ttc" id="acJSON_8h_html_a788db922597cf2fb6389e278f822e59f"><div class="ttname"><a href="../../../library/d1/d82/cJSON_8h.html#a788db922597cf2fb6389e278f822e59f">raw</a></div><div class="ttdeci">const char *const const char *const raw</div></div>
<div class="ttc" id="agroup__IAV_html_gaf80df1bdae91e5f76236e6ed1110825d"><div class="ttname"><a href="../../../driver/df/dc0/group__IAV.html#gaf80df1bdae91e5f76236e6ed1110825d">x</a></div><div class="ttdeci">u32 x</div></div>
<div class="ttc" id="avin__init_8c_html_a9586a0cc85ebac1f283fc9f2d94c82e2"><div class="ttname"><a href="../../d4/daa/vin__init_8c.html#a9586a0cc85ebac1f283fc9f2d94c82e2">hdr_mode</a></div><div class="ttdeci">int hdr_mode</div><div class="ttdef"><b>Definition:</b> vin_init.c:61</div></div>
<div class="ttc" id="avin__init_8c_html_ad1e28a1a66a25529b0b61b9ca4e66d44"><div class="ttname"><a href="../../d4/daa/vin__init_8c.html#ad1e28a1a66a25529b0b61b9ca4e66d44">bits</a></div><div class="ttdeci">int bits</div><div class="ttdef"><b>Definition:</b> vin_init.c:63</div></div>
</div><!-- fragment --><p ><br  />
</p>
<hr  />
<h1><a class="anchor" id="section_raw_example"></a>
3. Raw Examples</h1>
<p >Here is an example for uncompressed raw buffer manual feed. Specify "raw_capture = 1", "raw_manual_feed = 1" and "raw_feed_frame_num = 8" in lua </p><div class="fragment"><div class="line">board# init.sh --na;modprobe imx274_mipi vinc_id=8 bus_id=3     // For CV5 or CV52</div>
<div class="line">(Or board# init.sh --na;modprobe imx274_mipi vinc_id=8)         // For CV72</div>
<div class="line">board# test_aaa_service -a &amp;</div>
<div class="line">board# vi /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua         // For CV5 or CV52</div>
<div class="line">(Or board# vi /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua)   // For CV72</div>
<div class="line">...</div>
<div class="line">chan_0 = {</div>
<div class="line">    ...</div>
<div class="line">    raw_capture = 1,</div>
<div class="line">    raw_manual_feed = 1,</div>
<div class="line">    raw_feed_frame_num = 8,</div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua        // For CV5 or CV52</div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua)  // For CV72</div>
<div class="line">board# test_manual_feed -r 0 -R 1</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
