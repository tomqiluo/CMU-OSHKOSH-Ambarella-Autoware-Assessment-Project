<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Video: BASIC - Source Buffer</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Video"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-ambarella.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Ambarella.png"/></td>
  <td id="projectalign">
   <div id="projectname">Video<span id="projectnumber">&#160;Cooper_1.6.0 (CV72 &amp; CV3) @ 2024.07.10 14:12:44</span>
   </div>
   <div id="projectbrief">placeholder</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.html','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d0/ded/fs_basic_source_buffer.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">BASIC - Source Buffer </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="source_buffer_features"></a>
1. Source Buffer Features</h1>
<p >Cooper family chips process raw data from VINs in the unit of <b>"Channel"</b>. For each channel, digital signal processor (DSP) generates different source buffers, puts them in different canvases, and then sends it to the encoder or video output (VOUT). The source buffers can be placed in the same canvas, and then be encoded or used for preview.</p>
<p >From the <b>"Channel"</b> perspective of view, video frames captured from a RGB type sensor or YUV device are first generated inside the DSP as source buffer, and then data from the source are flushed to dynamic random access memory (DRAM) to generate the <a class="el" href="../../d6/d71/fs_basic_canvas.html">Canvas</a>, after that canvas data will be processed by the encoder.</p>
<p >Basically, the canvas stores the YUV data for encoding. The encoder continuously fetches the video data (in the canvas) and performs the encoding procedure sequentially. With this design, the encoding streams can include different FoVs simultaneously. Source buffers from different channels provide the raw video data to encoders or the video output. The five source buffers for each channel on the platform are denoted as the main, second,third, fourth, and fifth source buffers in the upper layer.</p>
<dl class="section note"><dt>Note</dt><dd>The sixth source buffer can be enabled when Pyramid buffers are disabled.</dd></dl>
<div class="image">
<img src="../../source_buffer_layout.png" alt=""/>
<div class="caption">
Figure 1-1. Source Buffer Layout.</div></div>
<h2><a class="anchor" id="main_buffer_dptz"></a>
1.1 Main Buffer: Digital Pan / Tilt / Zoom (DPTZ)</h2>
<p >The main buffer is cropped and scaled from the video input (VIN) buffer.<br  />
</p>
<div class="image">
<img src="../../main_buffer_generation.png" alt=""/>
<div class="caption">
Figure 1-2. Digital Pan / Tilt / Zoom for Main Buffer.</div></div>
<dl class="section user"><dt>Scalability</dt><dd></dd></dl>
<p>The scalability of the main buffer re-sampler is (1/4X - 8X]. For example, if the VIN resolution is 2592x1944 and the main capture window is the same as the VIN resolution, the minimum width of the main buffer is 2592/4=648. The main buffer size cannot be set to a 640x480 resolution when the VIN is 2592x1944. If this occurs, Ambarella recommends using other source buffers. If the VIN is 1080p, the minimum width of the main buffer is 1920/4 = 480. Main buffer size can be bigger than the VIN size, and if it is a crop and upscale buffer from VIN, the maximum width can go up to 8x original cropped size.</p>
<dl class="section note"><dt>Note</dt><dd>Limitations for main buffer's DPTZ.<ul>
<li>Main buffer's size is only configurable in <a class="elRef" href="../../../driver/df/d3f/page_drv_iav_doc.html#iav_state_model">Idle</a> state.</li>
<li>Main buffer's crop window can be changed in <a class="elRef" href="../../../driver/df/d3f/page_drv_iav_doc.html#iav_state_model">Idle, Preview, Encoding</a> state.</li>
</ul>
</dd></dl>
<h2><a class="anchor" id="sub_buffer_dptz"></a>
1.2 Sub-Buffer: Digital Pan / Tilt / Zoom</h2>
<p >The following diagram shows that the second, third, fourth, fifth and seventh source buffers are cropped or scaled from the main source buffer. As the main buffer changes its field of view (FoV), the FoV of the second, third, fourth, fifth, and seventh buffers are changed accordingly.</p>
<div class="image">
<img src="../../sub_source_buffer_generation.png" alt=""/>
<div class="caption">
Figure 1-3. Digital Pan / Tilt / Zoom for Sub-Buffer.</div></div>
<h2><a class="anchor" id="section_buffer_type"></a>
1.3 Buffer Type</h2>
<p >The source buffer has the following three types, <b>Off</b>, <b>Preview</b>, and <b>Encode</b>.</p>
<ul>
<li><b>Off</b> <br  />
 The hardware buffer is shut down. It is not accessable.</li>
<li><b>Preview</b> <br  />
 The hardware buffer is enabled. The content in the buffer is for "Preview" purpose.</li>
<li><b>Encode</b> <br  />
 The hardware buffer is enabled. The content in the buffer is for "Encode" purpose.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Source buffers' type has the following limitations.<ul>
<li>Buffer type is configurable only in the <a class="elRef" href="../../../driver/df/d3f/page_drv_iav_doc.html#iav_state_model">Idle State</a>.</li>
<li>Main buffer's type should always be "Encode".</li>
</ul>
</dd></dl>
<dl class="section user"><dt>A General Control Flow</dt><dd></dd></dl>
<p>If users want to change buffers' type, put the image audio video (IAV) driver into "Idle State" first. Users can change the buffer size in "Preview" state. Setting the buffer's size to 0x0 will put it into standby mode, which means that the DSP hardward of the source buffer is enabled, but no "DPTZ" will be applied from the source buffer's input to output, and no data copy will occur from the source buffer to its' canvas. The following picture illustrates the process of buffer type and size configuration.</p>
<div class="image">
<img src="../../buffer_type_size_config.png" alt=""/>
<div class="caption">
Figure 1-4. Buffer Type and Size Configuration Flow.</div></div>
<p ><a class="el" href="../../d0/ded/fs_basic_source_buffer.html#example_buffer_type_resolution">Try this example</a>.</p>
<h2><a class="anchor" id="section_buffer_capability"></a>
1.4 Buffer Capability</h2>
<p >This section provides a description of the buffer capability, including buffer input, scalability, encoding support, and more.</p>
<h3><a class="anchor" id="main_source_buffer"></a>
1.4.1 Main Source Buffer</h3>
<a class="anchor" id="table_main_buffer"></a>
<table class="doxtable">
<caption>Table 1-1. Main Buffer.</caption>
<tr>
<th>Feature </th><th><div style="width:650px"><b>Description</b></div> </th></tr>
<tr>
<td>Resolution </td><td>See <a class="el" href="../../d0/ded/fs_basic_source_buffer.html#section_buffer_resolution">Maximum Buffer Resolution</a> </td></tr>
<tr>
<td>Buffer Type </td><td><ul>
<li>
Encoding </li>
<li>
Off </li>
</ul>
</td></tr>
<tr>
<td>Input Window </td><td><ul>
<li>
The main capture window is cropped from the video input (VIN). </li>
<li>
The main capture window cannot exceed the VIN size. </li>
</ul>
</td></tr>
<tr>
<td>Scalability </td><td><ul>
<li>
Scale ratio range: 1/4x &lt; ratio &lt; 8x </li>
</ul>
</td></tr>
<tr>
<td>Alignment </td><td><ul>
<li>
Width must be a multiple of 32. </li>
<li>
Height must be a multiple of 8. </li>
</ul>
</td></tr>
<tr>
<td>Encoding </td><td><ul>
<li>
H.264 </li>
<li>
H.265 </li>
<li>
MJPEG </li>
</ul>
</td></tr>
<tr>
<td>YUV Dumping </td><td>Yes </td></tr>
<tr>
<td>ME0/ME1 Dumping </td><td><ul>
<li>
ME0 is configurable as 1/8X of main buffer resolution both in width and height directions. </li>
</ul>
</td></tr>
</table>
<h3><a class="anchor" id="second_source_buffer"></a>
1.4.2 Second Source Buffer</h3>
<a class="anchor" id="table_second_buffer"></a>
<table class="doxtable">
<caption>Table 1-2. Second Source Buffer.</caption>
<tr>
<th>Feature </th><th><div style="width:650px"><b>Description</b></div> </th></tr>
<tr>
<td>Resolution </td><td>See <a class="el" href="../../d0/ded/fs_basic_source_buffer.html#section_buffer_resolution">Maximum Buffer Resolution</a> </td></tr>
<tr>
<td>Buffer Type </td><td><ul>
<li>
Encoding </li>
<li>
Off </li>
</ul>
</td></tr>
<tr>
<td>Input Window </td><td><ul>
<li>
The input window is cropped from the main source buffer. </li>
<li>
The input window size cannot exceed the main buffer size. </li>
</ul>
</td></tr>
<tr>
<td>Scalability </td><td><ul>
<li>
Scale ratio range: 1/16x &lt; ratio &lt;= 1x </li>
</ul>
</td></tr>
<tr>
<td>Alignment </td><td><ul>
<li>
Width must be a multiple of 16. </li>
<li>
Height must be a multiple of 8. </li>
</ul>
</td></tr>
<tr>
<td>Encoding </td><td><ul>
<li>
H.264 </li>
<li>
H.265 </li>
<li>
MJPEG </li>
</ul>
</td></tr>
<tr>
<td>YUV Dumping </td><td>Yes </td></tr>
<tr>
<td>ME0/ME1 Dumping </td><td>Yes </td></tr>
</table>
<h3><a class="anchor" id="third_source_buffer"></a>
1.4.3 Third Source Buffer</h3>
<a class="anchor" id="table_third_buffer"></a>
<table class="doxtable">
<caption>Table 1-3. Third Source Buffer.</caption>
<tr>
<th>Feature </th><th><div style="width:650px"><b>Description</b></div> </th></tr>
<tr>
<td>Resolution </td><td>See <a class="el" href="../../d0/ded/fs_basic_source_buffer.html#section_buffer_resolution">Maximum Buffer Resolution</a> </td></tr>
<tr>
<td>Buffer Type </td><td><ul>
<li>
Encoding </li>
<li>
Preview </li>
<li>
Off </li>
</ul>
</td></tr>
<tr>
<td>Input Window </td><td><ul>
<li>
The input window is cropped from the main source buffer. </li>
<li>
The input window size cannot exceed the main buffer size. </li>
</ul>
</td></tr>
<tr>
<td>Scalability </td><td><ul>
<li>
Scale ratio range: 1/8x &lt; ratio &lt; 8x </li>
</ul>
</td></tr>
<tr>
<td>Alignment </td><td><ul>
<li>
Width must be a multiple of 16. </li>
<li>
Height must be a multiple of 8. </li>
</ul>
</td></tr>
<tr>
<td>Encoding </td><td><ul>
<li>
H.264 </li>
<li>
H.265 </li>
<li>
MJPEG </li>
</ul>
</td></tr>
<tr>
<td>YUV Dumping </td><td>Yes </td></tr>
<tr>
<td>ME0/ME1 Dumping </td><td>Yes </td></tr>
</table>
<h3><a class="anchor" id="fourth_source_buffer"></a>
1.4.4 Fourth Source Buffer</h3>
<a class="anchor" id="table_fourth_buffer"></a>
<table class="doxtable">
<caption>Table 1-4. Fourth Source Buffer.</caption>
<tr>
<th>Feature </th><th><div style="width:650px"><b>Description</b></div> </th></tr>
<tr>
<td>Resolution </td><td>See <a class="el" href="../../d0/ded/fs_basic_source_buffer.html#section_buffer_resolution">Maximum Buffer Resolution</a> </td></tr>
<tr>
<td>Buffer Type </td><td><ul>
<li>
Encoding </li>
<li>
Preview </li>
<li>
Off </li>
</ul>
</td></tr>
<tr>
<td>Input Window </td><td><ul>
<li>
The input window is cropped from the main source buffer. </li>
<li>
The input window size cannot exceed the main buffer size. </li>
</ul>
</td></tr>
<tr>
<td>Scalability </td><td><ul>
<li>
Scale ratio range: 1/16x &lt; ratio &lt; 8x </li>
</ul>
</td></tr>
<tr>
<td>Alignment </td><td><ul>
<li>
Width must be a multiple of 16. </li>
<li>
Height must be a multiple of 8. </li>
</ul>
</td></tr>
<tr>
<td>Encoding </td><td><ul>
<li>
H.264 </li>
<li>
H.265 </li>
<li>
MJPEG </li>
</ul>
</td></tr>
<tr>
<td>YUV Dumping </td><td>Yes </td></tr>
<tr>
<td>ME0/ME1 Dumping </td><td>Yes </td></tr>
</table>
<h3><a class="anchor" id="fifth_source_buffer"></a>
1.4.5 Fifth Source Buffer</h3>
<a class="anchor" id="table_fifth_buffer"></a>
<table class="doxtable">
<caption>Table 1-5. Fifth Source Buffer.</caption>
<tr>
<th>Feature </th><th><div style="width:650px"><b>Description</b></div> </th></tr>
<tr>
<td>Resolution </td><td>See <a class="el" href="../../d0/ded/fs_basic_source_buffer.html#section_buffer_resolution">Maximum Buffer Resolution</a> </td></tr>
<tr>
<td>Buffer Type </td><td><ul>
<li>
Encoding </li>
<li>
Preview </li>
<li>
Off </li>
</ul>
</td></tr>
<tr>
<td>Input Window </td><td><ul>
<li>
The input window is cropped from the main source buffer. </li>
<li>
The input window size cannot exceed the main buffer size. </li>
</ul>
</td></tr>
<tr>
<td>Scalability </td><td><ul>
<li>
Scale ratio range: 1/8x &lt; ratio &lt; 8x </li>
</ul>
</td></tr>
<tr>
<td>Alignment </td><td><ul>
<li>
Width must be a multiple of 16. </li>
<li>
Height must be a multiple of 8. </li>
</ul>
</td></tr>
<tr>
<td>Encoding </td><td><ul>
<li>
H.264 </li>
<li>
H.265 </li>
<li>
MJPEG </li>
</ul>
</td></tr>
<tr>
<td>YUV Dumping </td><td>Yes </td></tr>
<tr>
<td>ME0/ME1 Dumping </td><td>Yes </td></tr>
</table>
<h3><a class="anchor" id="sixth_source_buffer"></a>
1.4.6 Sixth Source Buffer</h3>
<p >The sixth buffer is multiplexed with pyramid. It is available only when the pyramid is disabled.</p>
<p >Refer to Sixth Buffer Usage for more details on the sixth buffer case.</p>
<a class="anchor" id="table_sixth_buffer"></a>
<table class="doxtable">
<caption>Table 1-6. Sixth Source Buffer.</caption>
<tr>
<th>Feature </th><th><div style="width:650px"><b>Description</b></div> </th></tr>
<tr>
<td>Resolution </td><td>3840 x 2160 </td></tr>
<tr>
<td>Buffer Type </td><td><ul>
<li>
Encoding </li>
<li>
Preview </li>
<li>
Off </li>
</ul>
</td></tr>
<tr>
<td>Input Window </td><td><ul>
<li>
The input window is cropped from the main source buffer. </li>
<li>
The input window size cannot exceed the main buffer size. </li>
</ul>
</td></tr>
<tr>
<td>Scalability </td><td><ul>
<li>
Scale ratio range: 1/8x &lt; ratio &lt;= 1x </li>
</ul>
</td></tr>
<tr>
<td>Alignment </td><td><ul>
<li>
Width must be a multiple of 16. </li>
<li>
Height must be a multiple of 8. </li>
</ul>
</td></tr>
<tr>
<td>Encoding </td><td><ul>
<li>
H.264 </li>
<li>
H.265 </li>
<li>
MJPEG </li>
</ul>
</td></tr>
<tr>
<td>YUV Dumping </td><td>Yes </td></tr>
<tr>
<td>ME0/ME1 Dumping </td><td>Yes </td></tr>
</table>
<h2><a class="anchor" id="section_buffer_resolution"></a>
1.5 Maximum Buffer Resolution</h2>
<p >The maximum size of each source buffer is limited by hardware. In order to accelerate the processing of image data, the cache memory internal image digital signal processor（IDSP） was used, which is called line buffer. Line buffer is capable of holding a single line of image data. So the resolution of source buffer is limited by the line buffer width. Each source buffer has an independent line buffer. That means the resolution limitation for each source buffer is different. The following table provides a description of width limitation for each line buffer.</p>
<a class="anchor" id="table_line_buffer_width"></a>
<table class="doxtable">
<caption>Table 1-7. Line Buffer Width Limitation.</caption>
<tr>
<th>Source Buffer </th><th><div style="width:400px"><b>Width</b></div> </th></tr>
<tr>
<td>Main Buffer </td><td align="center">2048 </td></tr>
<tr>
<td>Second Buffer </td><td align="center">1408 (CV5 / CV52 / CV3) <br  />
 2048 (CV72) </td></tr>
<tr>
<td>Third Buffer </td><td align="center">2048 </td></tr>
<tr>
<td>Fourth Buffer </td><td align="center">2048 </td></tr>
<tr>
<td>Fifth Buffer </td><td align="center">2048 </td></tr>
</table>
<p >However, IDSP supports multi-tile to enable the higher resolution. The following figure shows an example for multi-tile. In this case, the line cache width is 1408. The total tile for the source buffer is 3. So the maximum width for the source buffer is 4224.</p>
<div class="image">
<img src="../../multi_tile_buffer.png" alt=""/>
<div class="caption">
Figure 1-5. Buffer with Multi-Tile.</div></div>
<p >The quantity of tile is determinied by the resolution of main buffer. The maximum resolution of source buffer is divided into 3 intervals according to the width of main buffer, (0, 2048], (2048, 3840] and (3840, 8192]. The sub-sections below show detailed resolution limitation for each source buffer in 4k and 8k case.</p>
<h3><a class="anchor" id="buffer_resolution_4k"></a>
1.5.1 Buffer Resolution in 4K Case</h3>
<p >In the 4Kp case, the kernel configuration and buffer / encoding specifications are as follows.</p>
<ul>
<li>For SDK 3.0 Amba build: <div class="fragment"><div class="line">build $ make menuconfig</div>
<div class="line">       [*] Ambarella Linux Configuration  ---&gt;</div>
<div class="line">        [*] Ambarella Private Drivers Configuration  ---&gt;</div>
<div class="line">          [*] Build Ambarella <span class="keyword">private</span> IAV module  ---&gt;</div>
<div class="line">            [4096] Max VIN <a class="code hl_variableRef" href="../../../driver/df/dc0/group__IAV.html#ga85db88ffee2944ecd35c616393976289">width</a> in pixel</div>
<div class="line">            [4096] Max VIN <a class="code hl_variableRef" href="../../../driver/df/dc0/group__IAV.html#gadd40f8a56ae8cc650f92a3aa4d2bac99">height</a></div>
<div class="ttc" id="agroup__IAV_html_ga85db88ffee2944ecd35c616393976289"><div class="ttname"><a href="../../../driver/df/dc0/group__IAV.html#ga85db88ffee2944ecd35c616393976289">width</a></div><div class="ttdeci">u32 width</div></div>
<div class="ttc" id="agroup__IAV_html_gadd40f8a56ae8cc650f92a3aa4d2bac99"><div class="ttname"><a href="../../../driver/df/dc0/group__IAV.html#gadd40f8a56ae8cc650f92a3aa4d2bac99">height</a></div><div class="ttdeci">u32 height</div></div>
</div><!-- fragment --></li>
<li>For Cooper SDK Amba build: <div class="fragment"><div class="line">build$ make menuconfig</div>
<div class="line">       drv_modules  ---&gt;</div>
<div class="line">           <span class="keyword">private</span>  ---&gt;</div>
<div class="line">              -*- ambvideo-header (drv_modules/<span class="keyword">private</span>/video/dsp_v6)  ---&gt;</div>
<div class="line">                   [4096] Max VIN <a class="code hl_variableRef" href="../../../driver/df/dc0/group__IAV.html#ga85db88ffee2944ecd35c616393976289">width</a> in pixel</div>
<div class="line">                   [4096] Max VIN <a class="code hl_variableRef" href="../../../driver/df/dc0/group__IAV.html#gadd40f8a56ae8cc650f92a3aa4d2bac99">height</a></div>
</div><!-- fragment --></li>
<li>For Cooper SDK Yocto build: <div class="fragment"><div class="line">build$ make menuconfig</div>
<div class="line">       meta-ambabsp  ---&gt;</div>
<div class="line">           recipes-video  ---&gt;</div>
<div class="line">              -*- ambvideo-header (meta-ambabsp/recipes-video/ambvideo-header)  ---&gt;</div>
<div class="line">                   [4096] Max VIN <a class="code hl_variableRef" href="../../../driver/df/dc0/group__IAV.html#ga85db88ffee2944ecd35c616393976289">width</a> in pixel</div>
<div class="line">                   [4096] Max VIN <a class="code hl_variableRef" href="../../../driver/df/dc0/group__IAV.html#gadd40f8a56ae8cc650f92a3aa4d2bac99">height</a></div>
</div><!-- fragment --></li>
</ul>
<a class="anchor" id="table_max_buf_resolution"></a>
<table class="doxtable">
<caption>Table 1-8. Maximum Buffer Resolution.</caption>
<tr>
<th rowspan="2">Source Buffer </th><th colspan="3">Max Width </th><th rowspan="2">Max Height </th></tr>
<tr>
<th>Main Buffer Width <br  />
 (0, 2048] </th><th>Main Buffer Width <br  />
 (2048, 3840] </th><th>Main Buffer Width <br  />
 (3840, 8192] </th></tr>
<tr>
<td>Main Buffer </td><td colspan="3" align="center">8192 </td><td rowspan="5" align="center">8192 </td></tr>
<tr>
<td>Second Buffer </td><td align="center">1408 </td><td align="center">2816 </td><td align="center">4224 </td></tr>
<tr>
<td>Third Buffer </td><td align="center">2048 </td><td align="center">8192 </td><td align="center">8192 </td></tr>
<tr>
<td>Fourth Buffer </td><td align="center">2048 </td><td align="center">8192 </td><td align="center">8192 </td></tr>
<tr>
<td>Fifth Buffer </td><td align="center">2048 </td><td align="center">4096 </td><td align="center">4096 </td></tr>
</table>
<p >When users try to allocate the DSP resources for source buffer, the IAV driver checks the resource limitation according to the structure G_buffer_limit. For more details, refer to <em> check_zoom_limit() </em>, which is located in:</p>
<p ><em> <code>$SDK_ROOT_DIR/ambarella/kernel/drv_modules/private/video/dsp_v6/iav/iav_enc_limit.c</code> </em></p>
<hr  />
<h1><a class="anchor" id="lua_source_buffer_configuration"></a>
2. Source Buffer Configuration</h1>
<p >Every source buffer output window can be arranged in the <a class="el" href="../../d6/d71/fs_basic_canvas.html#canvas_layout">1.1 Flexible Canvas Layout</a>. The application must use the following rules for the buffer layout design.</p>
<a class="anchor" id="table_source_buffer_lua"></a>
<table class="doxtable">
<caption></caption>
<tr>
<th>Item </th><th><div style="width:230px"><b>Parameter</b></div> </th><th>Description </th></tr>
<tr>
<td><a class="anchor" id="anchor_buffer_max_output"></a>max_output </td><td>{width, height} </td><td>The maximum resolution of the source buffer. DSP will allocate enough resouces inside the DSP for the source buffer according to this value. </td></tr>
<tr>
<td><a class="anchor" id="anchor_buffer_input"></a>input </td><td>{offset_x, offset_y, width, height} </td><td>The input window of each source buffer. Main Buffer input window is cropped from VIN (vsrc), and Sub-Buffers' input windows are cropped from Main Buffer output window. </td></tr>
<tr>
<td><a class="anchor" id="anchor_buffer_output"></a>output </td><td>{offset_x, offset_y, width, height} </td><td>The output window of each source buffer in canvas. The output offset is in the canvas coordinate. "width, height" is used to specify the resolution of the source buffer. Source buffer's domain should not cross the canvas's border.<br  />
 Also, output can be set to '{0, 0, 0, 0}'. This means the source buffer is in standby mode. No "DPTZ" will be applied from the source buffer's input to output, and no data copy will occur from the source buffer to its' canvas. Later, users can apply none-zero value to resume the buffer from the standby mode. </td></tr>
</table>
<p >Please put DSP into the IDLE state before configuring the properties of the main buffer. The main source buffer crops or scales to the sub source buffers (second/third/fourth/fifth/sixth). When the main buffer size is updated, all sub buffers are affected.<br  />
 The size of the sub-buffer can be configured when there is no stream encoding from it. Changing the sub-buffer size does not affect the other sub-buffers.</p>
<dl class="section user"><dt>Lua Configuration Overview for Source Buffer</dt><dd></dd></dl>
<p>Each channel has a set of source buffers. Users can configure the source buffer according to the requirements of their projects. The following is a overview for the buffer configuration.</p>
<div class="fragment"><div class="line">chan_0 = {</div>
<div class="line">     … … …</div>
<div class="line">  <a class="code hl_function" href="../../db/d1a/test__vout__cfg_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> = {</div>
<div class="line">     max_output = {1920, 0},</div>
<div class="line">     input      = {0, 0, 1920, 1080},</div>
<div class="line">     output     = {960, 0, 960, 1080},</div>
<div class="line">  },</div>
<div class="line">  second = {</div>
<div class="line">     … … …</div>
<div class="line">  },</div>
<div class="line">  third = {</div>
<div class="line">     … … …</div>
<div class="line">  },</div>
<div class="line">  fourth = {</div>
<div class="line">     … … …</div>
<div class="line">  },</div>
<div class="line">  fifth = {</div>
<div class="line">     … … …</div>
<div class="line">  },</div>
<div class="line">  sixth = {</div>
<div class="line">     … … …</div>
<div class="line">  },</div>
<div class="line">}</div>
<div class="ttc" id="atest__vout__cfg_8c_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="../../db/d1a/test__vout__cfg_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> test_vout_cfg.c:85</div></div>
</div><!-- fragment --><dl class="section user"><dt>Only enable "Main" &amp; "Third" Buffer</dt><dd></dd></dl>
<p>In the following example, only "Main" and "Third" buffer are enabled. Other buffers are in the <a class="el" href="../../d0/ded/fs_basic_source_buffer.html#section_buffer_type">Off</a> state.</p>
<div class="fragment"><div class="line">chan_0 = {</div>
<div class="line">    … … …</div>
<div class="line">    <a class="code hl_function" href="../../db/d1a/test__vout__cfg_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> = {</div>
<div class="line">      max_output = {1920, 0},</div>
<div class="line">      input     = {0, 0, 1920, 1080},</div>
<div class="line">      output    = {960, 0, 960, 1080},</div>
<div class="line">    },</div>
<div class="line">    third = {</div>
<div class="line">      max_output = {1920, 0},</div>
<div class="line">      input     = {0, 0, 960, 1080},</div>
<div class="line">      output    = {960, 0, 960, 1080},</div>
<div class="line">   },</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section user"><dt>Enable Raw Buffer Manual Feed</dt><dd></dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The source buffers combined into the same canvas must be in the same type of canvas, either preview or encode.</li>
<li>The source buffers combined into the same canvas must be with the same buffer ID, such as all buffers are Third buffers.</li>
<li>The source buffer output size and offset should not exceed the canvas resolution.</li>
<li>The source buffer output size can be 0x0 to act as a turning off source buffer. When the output size is 0x0, the buffer type is better to set as off.</li>
<li>The source buffer output size can be different for the channels.</li>
<li>The source buffer output region can be overlapped with other source buffer output regions in the canvas layout to act as a PIP effect.</li>
<li>The source buffer type must be the same for all channels.</li>
</ul>
</dd></dl>
<p>See <a class="el" href="../../d8/dab/fs_adv_lua.html">Configure with Lua Script</a>.</p>
<p ><br  />
</p>
<h1><a class="anchor" id="section_source_buffer_example"></a>
3. Source Buffer Examples</h1>
<h2><a class="anchor" id="example_source_buffer_preview"></a>
Example 1: Preview from Third Buffer with HDMI 480i</h2>
<p >In this example, the input sensor is IMX274 with MIPI interface. The system resource is configured with a Lua script. <a class="anchor" id="system_resource_1080_linear"></a>following is an overview of the system resource for example 1.</p>
<div class="image">
<img src="../../system_resource_1080_linear.png" alt=""/>
<div class="caption">
Figure 3-1. System Resource.</div></div>
<p >In this case, canvas 2 was configured for "Preview" purpose. The video data in canvas 2 is copied from the Third buffer. Finally, canvas 2 will be sent to VOUT_1 for preview. See <a class="el" href="../../d6/d71/fs_basic_canvas.html">BASIC - Canvas</a>.<br  />
 Test steps are as follows.<br  />
 Modification of vout_hdmi.lua file for 480i: </p><div class="fragment"><div class="line">vout_2 = {</div>
<div class="line">     status = <span class="stringliteral">&quot;on&quot;</span>,</div>
<div class="line">     mode = <span class="stringliteral">&quot;480i&quot;</span>,</div>
<div class="line">     input_yuv422 = <span class="stringliteral">&quot;yes&quot;</span>,</div>
<div class="line">     video_output_window = {0, 0, 720, 480},</div>
<div class="line">     ...</div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line">board# init.sh --na;modprobe imx274_mipi vinc_id=8 bus_id=3        <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# init.sh --na;modprobe imx274_mipi vinc_id=8 bus_id=3)   <span class="comment">// For CV72</span></div>
<div class="line">board# test_aaa_service -a&amp;</div>
<div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua         <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua)   <span class="comment">// For CV72</span></div>
</div><!-- fragment --><h2><a class="anchor" id="example_main_encode"></a>
Example 2: Encode from Main Buffer with Resolution 1080p</h2>
<p >In order to encode a stream, users are required to put the IAV driver into "Preview" state first (See <a class="elRef" href="../../../driver/df/d3f/page_drv_iav_doc.html#iav_state_model">IAV Driver State Model</a>).</p>
<p >If users did not enter preview mode before, enter the preview with the following command.</p>
<div class="fragment"><div class="line">board# init.sh --na;modprobe imx274_mipi vinc_id=8 bus_id=3        <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# init.sh --na;modprobe imx274_mipi vinc_id=8 bus_id=3)   <span class="comment">// For CV72</span></div>
<div class="line">board# test_aaa_service -a&amp;</div>
<div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua         <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua)   <span class="comment">// For CV72</span></div>
</div><!-- fragment --><p >Then start encoding a stream with the following command.</p>
<div class="fragment"><div class="line">board# test_encode -A -h 1080p -<a class="code hl_variableRef" href="../../../library/d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a> 0 -e</div>
<div class="line">board# rtsp_server &amp;</div>
<div class="ttc" id="acJSON_8h_html_a1a175e87536301df98c805ac0636ad7c"><div class="ttname"><a href="../../../library/d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a></div><div class="ttdeci">const cJSON *const b</div></div>
</div><!-- fragment --><p >Finally users can view the bitstream through VLC media player. The real-time streaming protocol (RTSP) network URL is as follows.<br  />
</p>
<p ><em> rtsp://10.0.0.2/stream1 </em>.</p>
<p >In this example, system resources are the same as <a class="el" href="../../d0/ded/fs_basic_source_buffer.html#example_source_buffer_preview">Example 1</a>. As well as stream A is enabled with resolution 1080p. Users can specify the input canvas with the "-b" option for each stream. Here stream A is input from the canvas 0, and the source buffer of canvas 0 is main buffer. See <a class="el" href="../../d0/ded/fs_basic_source_buffer.html#system_resource_1080_linear">System Resource</a></p>
<h2><a class="anchor" id="example_dptz"></a>
Example 3: Digital Pan / Tilt / Zoom</h2>
<p >First, initialize the EVK board to load the essential drivers and microcode, and start 3A statistic if the following command was not executed previously.</p>
<div class="fragment"><div class="line">board# init.sh --na;modprobe imx274_mipi vinc_id=8 bus_id=3        // For CV5 or CV52</div>
<div class="line">(Or board# init.sh --na;modprobe imx274_mipi vinc_id=8)            // For CV72</div>
<div class="line">board# test_aaa_service -a&amp;</div>
</div><!-- fragment --><p >Set up the size of the buffer and enable capture raw data.</p>
<div class="fragment"><div class="line">board# test_encode -i 1920x1080 -f 30 --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua\</div>
<div class="line">                   --raw-capture 1\</div>
<div class="line">                   -X --bsize 1920x1080 --bmaxsize 1080p\</div>
<div class="line">                   -Y --bsize   720x480 --bmaxsize 480p\</div>
<div class="line">                   -J --bsize   720x480 --bmaxsize 480p</div>
</div><!-- fragment --><p >Apply DPTZ on the main buffer and the sub-buffer.</p>
<div class="fragment"><div class="line">board# test_dptz -X -s 1152x648 -o 500x200</div>
<div class="line">board# test_dptz -Y -s  720x480 -o   0x200</div>
<div class="line">board# test_dptz -J -s 1440x960 -o 400x100</div>
</div><!-- fragment --><p >Capture data from each buffer.</p>
<div class="fragment"><div class="line">board# test_yuvcap -i 8 -R -f vin8          # capture data from VIN8 buffer</div>
<div class="line">board# test_yuvcap -b 0 -Y -f 1.yuv -F 1    # capture data from main buffer</div>
<div class="line">board# test_yuvcap -b 1 -Y -f 1.yuv -F 1    # capture data from second buffer</div>
<div class="line">board# test_yuvcap -b 2 -Y -f 1.yuv -F 1    # capture data from third buffer</div>
</div><!-- fragment --><div class="image">
<img src="../../example_dptz.png" alt=""/>
<div class="caption">
Figure 3-2. Digital Pan / Tilt / Zoom.</div></div>
<p >In addition, the following case is for applying DPTZ automatically.</p>
<div class="fragment"><div class="line">board# test_dptz -X -d 2 -m -300~300 -n -200~200 -p  # auto pan/tilt in specified range</div>
<div class="line">board# test_dptz -X -r                               # auto zoom 1x ~ 8x</div>
</div><!-- fragment --><h2><a class="anchor" id="example_buffer_type_resolution"></a>
Example 4: Configure Buffer Type and Resolution</h2>
<p >Initialize the board and start 3A.</p>
<div class="fragment"><div class="line">board# init.sh --na; modprobe imx274_mipi vinc_id=8 bus_id=3</div>
<div class="line">board# test_aaa_service -a&amp;</div>
</div><!-- fragment --><p >Configure the buffer type and resolution. VIN resolution is 3840x2160. Main buffer's size is 4k. By default, it will get the full field of view from VIN. Users cannot change the type of main buffer. It should always be "Encode".</p>
<p >Third buffer is enabled for "Preview". Fourth buffer is enabled for "Encode". The resolution of fifth buffer is set to 0x0, which means it is set to standby mode. Second buffer and fourth buffer are disabled.</p>
<div class="fragment"><div class="line">board# test_encode -i 3840x2160 -f 30 --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua\</div>
<div class="line">                   -X              --bsize 3840x2160 --bmaxsize 3840x2160\</div>
<div class="line">                   -J --btype prev --bsize 1920x1080 --bmaxsize 1080p\</div>
<div class="line">                   -L --btype enc  --bsize       0x0 --bmaxsize 1080p\</div>
<div class="line">                   -Y --btype off\</div>
<div class="line">                   -K --btype off</div>
</div><!-- fragment --><p >Once the above command returned successfully. The IAV driver is put into the "Preview" state. Users cannot change the buffer type during "Preview" state. However, the buffer size is still configurable.</p>
<div class="fragment"><div class="line">board# test_encode -J --bsize 720x480 -L --bsize 720x480</div>
</div><!-- fragment --><p >Then, enter "Idle" re-configure buffer type. Put IAV driver into "Preview" once again. In the following command, second buffer and fifth buffer are enabled, and configured as "Encode" type.</p>
<div class="fragment"><div class="line">board# test_encode -i 3840x2160 -f 30 --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua\</div>
<div class="line">                   -X              --bsize 1920x1080 --bmaxsize 3840x2160\</div>
<div class="line">                   -Y --btype enc  --bsize   720x480 --bmaxsize  480p\</div>
<div class="line">                   -J --btype prev --bsize   720x480 --bmaxsize  480p\</div>
<div class="line">                   -K --btype enc  --bsize   720x480 --bmaxsize  480p\</div>
<div class="line">                   -L --btype enc  --bsize   720x480 --bmaxsize  480p</div>
</div><!-- fragment --><h2><a class="anchor" id="example_aspect_ratio"></a>
Example 5: Source Buffer Aspect Ratio</h2>
<p >The main buffer sets the FoV equal to the VIN window when no digital PTZ is applied. The second / third / fourth / fifth / seventh buffer is cropped or scaled from the main buffer. Thus, all buffers use identical full FoV and VIN window by default.</p>
<dl class="section user"><dt>Keep the Entire Field of View with Scale</dt><dd></dd></dl>
<p>Configure the main buffer with resolution 1080p. The second buffer is generated from the main buffer without cropping. Therefore, second buffer achieves the full FoV.</p>
<div class="fragment"><div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua\        <span class="comment">// For CV5 or CV52 </span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua\</div>
<div class="line">                   -X --bsize 1080p --bmaxsize 1080p\</div>
<div class="line">                   -Y --bsize 480p</div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua\   <span class="comment">// For CV72</span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua\</div>
<div class="line">                   -X --bsize 1080p --bmaxsize 1080p\</div>
<div class="line">                   -Y --bsize 480p)</div>
<div class="line">board# test_encode -A -h 1080p -<a class="code hl_variableRef" href="../../../library/d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a> 0 -e\</div>
<div class="line">                   -B -h  480p -<a class="code hl_variableRef" href="../../../library/d1/d82/cJSON_8h.html#a1a175e87536301df98c805ac0636ad7c">b</a> 1 -e</div>
</div><!-- fragment --><p >In this case, the aspect ratio of main buffer is 16:9 (1080p), and the aspect ratio of second buffer is 3:2 (480p). Therefore, an scaler was applied from main buffer to second buffer. It seems there are some distortions in the second buffer.</p>
<p ><a class="anchor" id="anchor_image_aspect"></a></p><div class="image">
<img src="../../buffer_aspect_ratio.png" alt=""/>
<div class="caption">
Figure 3-3. a) Main Buffer; b) Keep Full FoV; c) Keep Aspect Ratio.</div></div>
<p >Users can print the configuration of the source buffer using the following command.</p>
<div class="fragment"><div class="line">board# test_encode --show-resource-cfg</div>
<div class="line"> </div>
<div class="line">...</div>
<div class="line">chan_0 = {</div>
<div class="line">    <span class="keywordtype">id</span> = 0,</div>
<div class="line">    vsrc = vsrc_0,</div>
<div class="line">...</div>
<div class="line">    <a class="code hl_function" href="../../db/d1a/test__vout__cfg_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> = {</div>
<div class="line">        max_output = {1920, 0},</div>
<div class="line">        input    = {0, 0, 1920, 1080},</div>
<div class="line">        output   = {0, 0, 1920, 1080},</div>
<div class="line">    },</div>
<div class="line">    second = {</div>
<div class="line">        max_output = {720, 0},</div>
<div class="line">        input    = {0, 0, 1920, 1080},</div>
<div class="line">        output   = {0, 0, 720, 480},</div>
<div class="line">    },</div>
<div class="line">    third = {</div>
<div class="line">        max_output = {1920, 0},</div>
<div class="line">        input    = {0, 0, 1920, 1080},</div>
<div class="line">        output   = {0, 0, 1920, 1080},</div>
<div class="line">    },</div>
<div class="line">    fourth = {</div>
<div class="line">        max_output = {1280, 0},</div>
<div class="line">        input    = {0, 0, 1920, 1080},</div>
<div class="line">        output   = {0, 0, 1920, 1080},</div>
<div class="line">    },</div>
<div class="line">    fifth = {</div>
<div class="line">        max_output = {1920, 0},</div>
<div class="line">        input    = {0, 0, 1920, 1080},</div>
<div class="line">        output   = {0, 0, 1280, 720},</div>
<div class="line">    },</div>
<div class="line">    sixth = {</div>
<div class="line">        max_output = {0, 0},</div>
<div class="line">        input    = {0, 0, 0, 0},</div>
<div class="line">        output   = {0, 0, 0, 0},</div>
<div class="line">    },</div>
<div class="line">...</div>
<div class="line">}</div>
<div class="line">...</div>
</div><!-- fragment --><dl class="section user"><dt>Keeping Aspect Ratio</dt><dd></dd></dl>
<p>Users can use the input window of the sub source buffer to maintain the aspect ratio but sacrifice field of view.</p>
<p >In this case, The size of main buffer is 1080p (16:9) and the second buffer is 480p (3:2). To keep the aspect ratio for 480p, the input window size for second buffer should be 1620x1080 (3:2).</p>
<div class="fragment"><div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua\        <span class="comment">// For CV5 or CV52</span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua\</div>
<div class="line">                   -X --bsize 1080p --bmaxsize 1080p\</div>
<div class="line">                   -Y --bsize 480p --binsize 1620x1080</div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua\   <span class="comment">// For CV72</span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua\</div>
<div class="line">                   -X --bsize 1080p --bmaxsize 1080p\</div>
<div class="line">                   -Y --bsize 480p --binsize 1620x1080)</div>
<div class="line">board# test_encode -A -h 1080p -b 0 -e\</div>
<div class="line">                   -B -h 480p -b 1 -e</div>
</div><!-- fragment --><p >See <a class="el" href="../../d0/ded/fs_basic_source_buffer.html#anchor_image_aspect">Picture: c) Keep Aspect Ratio</a> for result.</p>
<p >Another case, main buffer 1080p (16:9) and second buffer VGA (4:3).</p>
<div class="fragment"><div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua\        <span class="comment">// For CV5 or CV52</span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua\</div>
<div class="line">                   -X --bsize 1080p --bmaxsize 1080p\</div>
<div class="line">                   -Y --bsize vga --binsize 1440x1080</div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua\   <span class="comment">// For CV72</span></div>
<div class="line">                   --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua\</div>
<div class="line">                   -X --bsize 1080p --bmaxsize 1080p\</div>
<div class="line">                   -Y --bsize vga --binsize 1440x1080)</div>
<div class="line">board# test_encode -A -h 1080p -b 0 -e\</div>
<div class="line">                   -B -h   vga -b 1 -e</div>
</div><!-- fragment --><dl class="section user"><dt>Customized Aspect Ratio</dt><dd></dd></dl>
<p>Set customized aspect ratio with 3/2 and start streaming.</p>
<div class="fragment"><div class="line">board# init.sh --na;modprobe imx274_mipi vinc_id=8 bus_id=3     <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# init.sh --na;modprobe imx274_mipi vinc_id=8)         <span class="comment">// For CV72</span></div>
<div class="line">board# test_aaa_service -a &amp;</div>
<div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_1080p_linear.lua --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua         <span class="comment">// For CV5 or CV52</span></div>
<div class="line">(Or board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv72_vin0_1080p_linear.lua --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua)   <span class="comment">// For CV72</span></div>
<div class="line">board# test_encode -A --sar 3/2</div>
<div class="line">board# test_encode -A -h 1080p -e</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
