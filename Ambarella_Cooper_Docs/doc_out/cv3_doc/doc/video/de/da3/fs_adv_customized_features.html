<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Video: ADVANCED - Customized Features</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Video"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-ambarella.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Ambarella.png"/></td>
  <td id="projectalign">
   <div id="projectname">Video<span id="projectnumber">&#160;Cooper_1.6.0 (CV72 &amp; CV3) @ 2024.07.10 14:12:44</span>
   </div>
   <div id="projectbrief">placeholder</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.html','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('de/da3/fs_adv_customized_features.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">ADVANCED - Customized Features </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="capture_extra_raw"></a>
1. Capture Extra Raw Data</h1>
<p >This chapter illustrates the feature of capturing extra raw data which are usually embedded in the top or bottom lines of the sensor raw data. The extra raw data is typically customized as sensor manufactured through mobile industry processor interface (MIPI®) embedded lines.</p>
<h2><a class="anchor" id="extra_raw_data"></a>
1.1 Extra Raw Data</h2>
<p >When the user application performs Video content analysis (VCA) or 3A (AE / AWB / AF) control, the application may refer to the customized raw information, which is embedded in the top or bottom lines of the sensor raw data. The customized raw data is usually in a format specified by sensor manufacturer through MIPI embedded lines. CV5x supports capturing this customized raw data from mobile industry processor interface (MIPI®) embedded lines, and attaching the data to corresponding canvas / pyramid buffers or to 3A statistic data.</p>
<p >For CV5x, there is dedicated hardware support to capture the customized raw data. Different from previous platforms, CV5x is not required to to enforce uncompressed raw format to enable this feature. This can save significant dynamic random access memory (DRAM) bandwidth for raw buffer transfer. Users can specify compressed or packing raw data format, when extra raw data is enabled.</p>
<h2><a class="anchor" id="extra_raw_configuration"></a>
1.2 Extra Raw Data Capture Configuration</h2>
<p >Users can configure the extra raw data via the command line. Below are the parameters for extra raw data capture.</p>
<a class="anchor" id="table_extra_raw_data"></a>
<table class="doxtable">
<caption>Table 1-1. Extra Raw Data.</caption>
<tr>
<th>Item </th><th><div style="width:240px"><b>Parameter</b></div> </th><th>Description </th></tr>
<tr>
<td>&ndash;custom-extra-raw-vinc </td><td>vinc id &gt;= 0 </td><td>Specify the target video input (VIN) controller ID. </td></tr>
<tr>
<td>&ndash;custom-extra-raw-enable </td><td>0: disable <br  />
 1: enable </td><td>Enable / disable the function of capture extra raw data function for specified VIN controllers. </td></tr>
<tr>
<td>&ndash;custom-extra-raw-top </td><td>[0, 8] </td><td>Specify the top lines of sensor raw data, which will be captured as extra raw data. </td></tr>
<tr>
<td>&ndash;custom-extra-raw-bottom </td><td>[0, 8] </td><td>Specify the bottom lines of sensor raw data, which will be captured as extra raw data. </td></tr>
</table>
<h2><a class="anchor" id="extra_raw_example"></a>
1.3 Examples of Capturing Extra Raw Data</h2>
<p >For the “Capture Extra Raw Data” feature, users are required to allocate a memory partition in the continuous memory allocator (CMA) pool. By default, the “IAV_PART_EXTRA_RAW” partition size is 0. Users can allocate a CMA memory partition for “Capture Extra Raw Data” via memuconfig. Users can calculate the total extra raw buffer size with the following fomula. </p><dl class="section user"><dt>Extra raw buffer size = pitch * (bottom lines + top lines)</dt><dd>For Cooper SDK Amba build: <div class="fragment"><div class="line">build$ make menuconfig</div>
<div class="line">       -&gt; drv_modules</div>
<div class="line">          -&gt; platform</div>
<div class="line">             -*- ambvideo-header (drv_modules/<span class="keyword">private</span>/video/dsp_v6)</div>
<div class="line">                 (0x400000) IAV Extra Raw Buffer Size</div>
</div><!-- fragment --> For Cooper SDK Yocto build: <div class="fragment"><div class="line">build$ make menuconfig</div>
<div class="line">       Main menu</div>
<div class="line">         -&gt; meta-ambabsp</div>
<div class="line">           -&gt; recipes-video</div>
<div class="line">             -&gt; ambvideo-header (meta-ambabsp/recipes-video/ambvideo-header)</div>
<div class="line">                (0x400000) IAV Extra Raw Buffer Size</div>
</div><!-- fragment --></dd></dl>
<p>The following example demonstrates how to enable the capture extra raw data function on CV5x platform and how to attach it to a canvas buffer. </p><div class="fragment"><div class="line">board# init.sh --na; modprobe imx586_mipi vinc_id=0 bus_id=5 pdaf=1</div>
<div class="line">board# test_aaa_service -a&amp;</div>
<div class="line">board# test_encode --resource-cfg /usr/share/ambarella/lua_scripts/cv5_vin0_8k_linear.lua \</div>
<div class="line">       --vout-cfg /usr/share/ambarella/lua_scripts/vout_hdmi.lua --custom-extra-raw-vinc 0 \</div>
<div class="line">       --custom-extra-raw-top 2 --custom-extra-raw-bottom 0 --custom-extra-raw-enable 1</div>
<div class="line">board# test_yuvcap -b0 -Y -f main --tcp -q</div>
<div class="line">Canvas0 : Frame0, the first value of line0 = 0x55555500</div>
<div class="line">Canvas0 : Frame0, the first value of line1 = 0xbeefdead</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
